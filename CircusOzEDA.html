
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Circus Oz Analysis</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="DAQA Workshop" href="DAQA%20Workshop.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-R8Q003ZY5N"></script>
<script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('js', new Date());
                    gtag('config', 'G-R8Q003ZY5N');
                </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/ACDElogo.png" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   About
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Data infrastructure and integration
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="ivy_placeholder.html">
   <em>
    Coming soon…
   </em>
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Data analysis
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="RmdTest.html">
   DAAO Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Archies.html">
   Archibald Prize
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="TLC%20Workshop.html">
   TLC Workshop
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="DAQA%20Workshop.html">
   DAQA Workshop
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Circus Oz Analysis
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/CircusOzEDA.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FCircusOzEDA.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/CircusOzEDA.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-packages-and-pre-process-data">
   Import packages and pre-process data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#event-participation-by-demi-decade">
   Event participation by demi-decade
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#event-participation-by-year">
   Event participation by year
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#event-participation-by-month">
   Event participation by month
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#event-participation-by-month-year">
   Event participation by month-year
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gender-summary">
   Gender summary
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#participation-by-time">
     Participation by time
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#person-summary">
   Person summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#roles">
   Roles
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-many-roles-on-average">
     How many roles on average?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#association-rule-mining">
     Association Rule Mining
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#role-changes-over-time">
     Role changes over time
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#male-and-female-proportion-by-role-over-time">
     Male and female proportion by role over time
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#association-rule-mining-cont">
     Association Rule Mining (cont.)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#network-graphs">
   Network graphs
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Circus Oz Analysis</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-packages-and-pre-process-data">
   Import packages and pre-process data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#event-participation-by-demi-decade">
   Event participation by demi-decade
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#event-participation-by-year">
   Event participation by year
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#event-participation-by-month">
   Event participation by month
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#event-participation-by-month-year">
   Event participation by month-year
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gender-summary">
   Gender summary
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#participation-by-time">
     Participation by time
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#person-summary">
   Person summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#roles">
   Roles
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-many-roles-on-average">
     How many roles on average?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#association-rule-mining">
     Association Rule Mining
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#role-changes-over-time">
     Role changes over time
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#male-and-female-proportion-by-role-over-time">
     Male and female proportion by role over time
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#association-rule-mining-cont">
     Association Rule Mining (cont.)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#network-graphs">
   Network graphs
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="section" id="circus-oz-analysis">
<h1>Circus Oz Analysis<a class="headerlink" href="#circus-oz-analysis" title="Permalink to this headline">¶</a></h1>
<p>This is an exploratory data analysis of collected data from Circus Oz. The main focus will be around gender, roles and temporal relationships.</p>
<p>The data consists of…</p>
<ul class="simple">
<li><p>event records with attached dates</p></li>
<li><p>person records for each event</p></li>
<li><p>each person record contains data on gender and role type</p></li>
</ul>
<div class="section" id="import-packages-and-pre-process-data">
<h2>Import packages and pre-process data<a class="headerlink" href="#import-packages-and-pre-process-data" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># for data mgmt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="c1"># for plotting</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># for network graphs</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">from</span> <span class="nn">pyvis</span> <span class="kn">import</span> <span class="n">network</span> <span class="k">as</span> <span class="n">net</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">IFrame</span>

<span class="c1"># for statistical processes</span>
<span class="kn">from</span> <span class="nn">mlxtend.preprocessing</span> <span class="kn">import</span> <span class="n">TransactionEncoder</span>
<span class="kn">from</span> <span class="nn">mlxtend.frequent_patterns</span> <span class="kn">import</span> <span class="n">apriori</span><span class="p">,</span> <span class="n">association_rules</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">pareto</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;data/23 Nov_Circus Oz_MasterList-RoleCategories_1978-2009_Clean.xlsx&#39;</span><span class="p">)</span>

<span class="c1"># remove redundant rows</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;PERSON.NUMBER&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>

<span class="c1"># assign event number to each related person</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span><span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;EVENT.NUMBER&#39;</span><span class="p">]):</span> 
        <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">row_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="n">row_dict</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;EVENT.NUMBER&quot;</span><span class="p">:</span><span class="s2">&quot;(TBC)_VENUE.TYPE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
        
<span class="c1"># create separate events dataset</span>
<span class="n">events_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s2">&quot;EVENT.NUMBER&quot;</span><span class="p">:</span><span class="s2">&quot;(TBC)_VENUE.TYPE&quot;</span><span class="p">]</span>\
              <span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>\
              <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="event-participation-by-demi-decade">
<h2>Event participation by demi-decade<a class="headerlink" href="#event-participation-by-demi-decade" title="Permalink to this headline">¶</a></h2>
<p>We use a bar chart to highlight the participation rates across time. Participation rate being the number of people involved in an event in a time period. Data has been collected between 1977 to 2022, however we focus only on data between <strong>1977 to 2009</strong> as this period holds the richest records.</p>
<p>Data has been aggregated into five-year bins. The figure shows a steady incline over the first 20 years, peaking in the 1995-1999 period, and gradually declining.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;DATE.FROM.(General)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">))</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Year_decade&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">year</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span> 
                            <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">])]</span>

<span class="n">df_noinjuries</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Role.Category.Concatinate&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;Injured&#39;</span><span class="p">]</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">df_noinjuries</span><span class="p">[</span><span class="s1">&#39;Year_decade&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>\
<span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Year_decade&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;75-79&#39;</span><span class="p">,</span> <span class="s1">&#39;80-84&#39;</span><span class="p">,</span><span class="s1">&#39;85-89&#39;</span><span class="p">,</span> <span class="s1">&#39;90-94&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;95-99&#39;</span><span class="p">,</span> <span class="s1">&#39;00-04&#39;</span><span class="p">,</span><span class="s1">&#39;05-09&#39;</span><span class="p">])</span>

<span class="c1"># adjust legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/CircusOzEDA_4_0.png" src="_images/CircusOzEDA_4_0.png" />
</div>
</div>
</div>
<div class="section" id="event-participation-by-year">
<h2>Event participation by year<a class="headerlink" href="#event-participation-by-year" title="Permalink to this headline">¶</a></h2>
<p>To get a more granular view of the data, we plot the time as individual years. The highest peak is 1998 with 772 records. We provide the top 5 years with the highest number of participants below.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Year</p></th>
<th class="text-align:right head"><p>Participants</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>1998</p></td>
<td class="text-align:right"><p>772</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>1995</p></td>
<td class="text-align:right"><p>753</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>1996</p></td>
<td class="text-align:right"><p>726</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>1993</p></td>
<td class="text-align:right"><p>714</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>2001</p></td>
<td class="text-align:right"><p>608</p></td>
</tr>
</tbody>
</table>
<p>Interesting to note that there was no data for the year 1981.</p>
<p>In the figure below, we also include injured persons recorded for each event. We see a peak in 1993 of 108. This is quite significant as the median is 6 injuries per year (mean = 15).</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df_noinjuries</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span>\
    <span class="n">value_counts</span><span class="p">()</span><span class="o">.</span>\
    <span class="n">reset_index</span><span class="p">()</span><span class="o">.</span>\
    <span class="n">append</span><span class="p">({</span><span class="s1">&#39;index&#39;</span><span class="p">:</span><span class="mi">1981</span><span class="p">,</span><span class="s1">&#39;Year&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">},</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span>\
    <span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">)</span><span class="o">.</span>\
    <span class="n">head</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span>\
    <span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Participated&#39;</span><span class="p">)</span>

<span class="n">df_injuries</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Role.Category.Concatinate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Injured&#39;</span><span class="p">,</span><span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>

<span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_injuries</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span>\
    <span class="n">value_counts</span><span class="p">()</span><span class="o">.</span>\
    <span class="n">reset_index</span><span class="p">(),</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1977</span><span class="p">,</span> <span class="mi">2010</span><span class="p">))}),</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span><span class="o">.</span>\
    <span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span>\
    <span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">)</span><span class="o">.</span>\
    <span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Injured&#39;</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="c1"># adjust legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/CircusOzEDA_6_0.png" src="_images/CircusOzEDA_6_0.png" />
</div>
</div>
</div>
<div class="section" id="event-participation-by-month">
<h2>Event participation by month<a class="headerlink" href="#event-participation-by-month" title="Permalink to this headline">¶</a></h2>
<p>The bar chart shows the participation rate over the entire dataset for each month. The data suggests that events with highest participation rates occur in Autumn. October is the month with the lowest frequency.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;DATE.FROM.(General)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%B&#39;</span><span class="p">))</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;month_number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;DATE.FROM.(General)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%m&#39;</span><span class="p">))</span>
<span class="n">ordered_months</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Month&#39;</span><span class="p">,</span><span class="s1">&#39;month_number&#39;</span><span class="p">]]</span>\
<span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>\
<span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;month_number&#39;</span><span class="p">)[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span>\
<span class="o">.</span><span class="n">unique</span><span class="p">()</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">],</span><span class="n">categories</span><span class="o">=</span><span class="n">ordered_months</span><span class="p">,</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">df_noinjuries</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Role.Category.Concatinate&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;Injured&#39;</span><span class="p">]</span>

<span class="n">df_noinjuries</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;barh&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/CircusOzEDA_8_0.png" src="_images/CircusOzEDA_8_0.png" />
</div>
</div>
</div>
<div class="section" id="event-participation-by-month-year">
<h2>Event participation by month-year<a class="headerlink" href="#event-participation-by-month-year" title="Permalink to this headline">¶</a></h2>
<p>The bar chart shows the top ten months (within their respective year) with the highest participation rates. March 1998 has the highest participation among all month-years (272 participants). For reference the mean participation rate for monthly data is 54 participants.</p>
<p>In March 1998, there were six events all under the title, Circus Oz (Mike and Dan’s Show).</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_noinjuries</span><span class="p">[[</span><span class="s1">&#39;Month&#39;</span><span class="p">,</span><span class="s1">&#39;Year&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;barh&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/CircusOzEDA_10_0.png" src="_images/CircusOzEDA_10_0.png" />
</div>
</div>
</div>
<div class="section" id="gender-summary">
<h2>Gender summary<a class="headerlink" href="#gender-summary" title="Permalink to this headline">¶</a></h2>
<p>We use a series of donut charts to explore how gender has been recorded. The first donut chart highlights the distribution of raw gender records and the second donut chart shows the proportion of only <code class="docutils literal notranslate"><span class="pre">Female</span></code> and <code class="docutils literal notranslate"><span class="pre">Male</span></code> records. There are five different categories according to the raw data. We have provided a frequency table below with the raw counts.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Gender</p></th>
<th class="text-align:right head"><p>Frequency</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>M</p></td>
<td class="text-align:right"><p>4586</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>F</p></td>
<td class="text-align:right"><p>4937</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>U</p></td>
<td class="text-align:right"><p>32</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>0</p></td>
<td class="text-align:right"><p>2443</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>NaN</p></td>
<td class="text-align:right"><p>12</p></td>
</tr>
</tbody>
</table>
<p>According to the raw data, <code class="docutils literal notranslate"><span class="pre">Female</span></code> occurs the most (40.4%), followed by <code class="docutils literal notranslate"><span class="pre">Male</span></code> (38.6%) and <code class="docutils literal notranslate"><span class="pre">0</span></code> (20.6%).<code class="docutils literal notranslate"><span class="pre">0</span></code> represents unverified records. In AusStage, these <code class="docutils literal notranslate"><span class="pre">0</span></code> records have been entered as <code class="docutils literal notranslate"><span class="pre">Male</span></code>, however <code class="docutils literal notranslate"><span class="pre">Male</span></code> is the default when entering people records into AusStage. For this reason, <code class="docutils literal notranslate"><span class="pre">Female</span></code> and <code class="docutils literal notranslate"><span class="pre">Male</span></code> are only used when they can be verified through a secondary source.</p>
<p>The third donut chart shows what the proportion would look like if we assumed <code class="docutils literal notranslate"><span class="pre">0</span></code> to be <code class="docutils literal notranslate"><span class="pre">Male</span></code>. The balance between <code class="docutils literal notranslate"><span class="pre">Male</span></code> and <code class="docutils literal notranslate"><span class="pre">Female</span></code> shifts.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Gender Proportion</span>
<span class="n">df_gender</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">Counter</span><span class="p">(</span><span class="n">df_noinjuries</span><span class="p">[</span><span class="s2">&quot;Gender&quot;</span><span class="p">]))</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span>
                              <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Gender&quot;</span><span class="p">,</span><span class="s2">&quot;Frequency&quot;</span><span class="p">])</span>
<span class="c1"># print(df_gender)</span>

<span class="c1"># explosion</span>
<span class="n">explode</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
  
<span class="c1"># Pie Chart</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">df_gender</span><span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Male&#39;</span><span class="p">,</span><span class="s1">&#39;Female&#39;</span><span class="p">,</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;Missing&#39;</span><span class="p">],</span>
        <span class="n">autopct</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">pctdistance</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span>
        <span class="n">explode</span><span class="o">=</span><span class="n">explode</span><span class="p">)</span>
  
<span class="c1"># draw circle</span>
<span class="n">centre_circle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mf">0.70</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
  
<span class="c1"># Adding Circle in Pie chart</span>
<span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">centre_circle</span><span class="p">)</span>
  
<span class="c1"># Adding Title of chart</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Gender proportion (with missing and unknown cases)&#39;</span><span class="p">)</span>
  
<span class="c1"># Displaying Chart</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># without null</span>
<span class="c1"># explosion</span>
<span class="n">explode</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
  
<span class="c1"># Pie Chart</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">df_gender</span><span class="p">[</span><span class="n">df_gender</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">])][</span><span class="s1">&#39;Frequency&#39;</span><span class="p">],</span> 
        <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Male&#39;</span><span class="p">,</span><span class="s1">&#39;Female&#39;</span><span class="p">],</span>
        <span class="n">autopct</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">pctdistance</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span>
        <span class="n">explode</span><span class="o">=</span><span class="n">explode</span><span class="p">)</span>

<span class="c1"># draw circle</span>
<span class="n">centre_circle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mf">0.70</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
  
<span class="c1"># Adding Circle in Pie chart</span>
<span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">centre_circle</span><span class="p">)</span>
  
<span class="c1"># Adding Title of chart</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Gender proportion&#39;</span><span class="p">)</span>
  
<span class="c1"># Displaying Chart</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1"># Pie Chart</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">df_gender</span><span class="p">[</span><span class="n">df_gender</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">])]</span>\
        <span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;M&#39;</span><span class="p">})</span>\
        <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Gender&#39;</span><span class="p">)</span>\
        <span class="o">.</span><span class="n">sum</span><span class="p">()</span>\
        <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
        <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Gender&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">],</span> 
        <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Male&#39;</span><span class="p">,</span><span class="s1">&#39;Female&#39;</span><span class="p">],</span>
        <span class="n">autopct</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">pctdistance</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span>
        <span class="n">explode</span><span class="o">=</span><span class="n">explode</span><span class="p">)</span>

<span class="c1"># draw circle</span>
<span class="n">centre_circle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mf">0.70</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
  
<span class="c1"># Adding Circle in Pie chart</span>
<span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">centre_circle</span><span class="p">)</span>
  
<span class="c1"># Adding Title of chart</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Gender proportion (assuming 0 is Male)&#39;</span><span class="p">)</span>
  
<span class="c1"># Displaying Chart</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/CircusOzEDA_12_0.png" src="_images/CircusOzEDA_12_0.png" />
<img alt="_images/CircusOzEDA_12_1.png" src="_images/CircusOzEDA_12_1.png" />
<img alt="_images/CircusOzEDA_12_2.png" src="_images/CircusOzEDA_12_2.png" />
</div>
</div>
<div class="section" id="participation-by-time">
<h3>Participation by time<a class="headerlink" href="#participation-by-time" title="Permalink to this headline">¶</a></h3>
<p>The visualisations below show the participation rates across time for <code class="docutils literal notranslate"><span class="pre">Male</span></code>, <code class="docutils literal notranslate"><span class="pre">Female</span></code> and <code class="docutils literal notranslate"><span class="pre">0</span></code>. The clustered bar chart shows that the majority of unverified persons lie within the 95-99 period. Furthermore, <code class="docutils literal notranslate"><span class="pre">Female</span></code> leads partipication across most periods.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bymf</span><span class="o">=</span> <span class="n">df_noinjuries</span><span class="p">[(</span><span class="n">df_noinjuries</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_noinjuries</span><span class="o">.</span><span class="n">Year_decade</span> <span class="o">&lt;</span> <span class="mi">2010</span><span class="p">)]</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">bymf</span><span class="p">[</span><span class="s1">&#39;Year_decade&#39;</span><span class="p">],</span> 
            <span class="n">bymf</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">])</span>\
<span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Participation per demi-decade, Male, Female and 0&#39;</span><span class="p">,</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;75-79&#39;</span><span class="p">,</span> <span class="s1">&#39;80-84&#39;</span><span class="p">,</span><span class="s1">&#39;85-89&#39;</span><span class="p">,</span> <span class="s1">&#39;90-94&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;95-99&#39;</span><span class="p">,</span> <span class="s1">&#39;00-04&#39;</span><span class="p">,</span><span class="s1">&#39;05-09&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/CircusOzEDA_14_0.png" src="_images/CircusOzEDA_14_0.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">bymf</span><span class="p">[</span><span class="n">bymf</span><span class="o">.</span><span class="n">Gender</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;Year&#39;</span><span class="p">],</span> 
                 <span class="n">bymf</span><span class="p">[</span><span class="n">bymf</span><span class="o">.</span><span class="n">Gender</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;Gender&#39;</span><span class="p">])</span>\
<span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">])</span>

<span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">bymf</span><span class="p">[</span><span class="n">bymf</span><span class="o">.</span><span class="n">Gender</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;Year&#39;</span><span class="p">],</span> 
            <span class="n">bymf</span><span class="p">[</span><span class="n">bymf</span><span class="o">.</span><span class="n">Gender</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;Gender&#39;</span><span class="p">])</span>\
<span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tab:red&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Participation per year, Male, Female and 0&#39;</span><span class="p">,</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/CircusOzEDA_15_0.png" src="_images/CircusOzEDA_15_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="person-summary">
<h2>Person summary<a class="headerlink" href="#person-summary" title="Permalink to this headline">¶</a></h2>
<p>We calculate summary statistics of participation rate across all persons and also across gender. These are shown in the table below.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Gender</p></th>
<th class="text-align:left head"><p>Count</p></th>
<th class="text-align:left head"><p>Mean</p></th>
<th class="text-align:left head"><p>Standard Deviation</p></th>
<th class="text-align:left head"><p>Min</p></th>
<th class="text-align:left head"><p>25%</p></th>
<th class="text-align:left head"><p>50% (Median)</p></th>
<th class="text-align:left head"><p>75%</p></th>
<th class="text-align:left head"><p>Max</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>All</p></td>
<td class="text-align:left"><p>721</p></td>
<td class="text-align:left"><p>16.0</p></td>
<td class="text-align:left"><p>35.3</p></td>
<td class="text-align:left"><p>1</p></td>
<td class="text-align:left"><p>1</p></td>
<td class="text-align:left"><p>2</p></td>
<td class="text-align:left"><p>14</p></td>
<td class="text-align:left"><p>378</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>M</p></td>
<td class="text-align:left"><p>126</p></td>
<td class="text-align:left"><p>35.4</p></td>
<td class="text-align:left"><p>57.2</p></td>
<td class="text-align:left"><p>1</p></td>
<td class="text-align:left"><p>4</p></td>
<td class="text-align:left"><p>13</p></td>
<td class="text-align:left"><p>38.5</p></td>
<td class="text-align:left"><p>378</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>F</p></td>
<td class="text-align:left"><p>123</p></td>
<td class="text-align:left"><p>38.0</p></td>
<td class="text-align:left"><p>45.3</p></td>
<td class="text-align:left"><p>1</p></td>
<td class="text-align:left"><p>8</p></td>
<td class="text-align:left"><p>20</p></td>
<td class="text-align:left"><p>53.5</p></td>
<td class="text-align:left"><p>243</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>0</p></td>
<td class="text-align:left"><p>468</p></td>
<td class="text-align:left"><p>5.1</p></td>
<td class="text-align:left"><p>12.6</p></td>
<td class="text-align:left"><p>1</p></td>
<td class="text-align:left"><p>1</p></td>
<td class="text-align:left"><p>1</p></td>
<td class="text-align:left"><p>3</p></td>
<td class="text-align:left"><p>130</p></td>
</tr>
</tbody>
</table>
<p><strong>Some insights from the above</strong>:</p>
<ul class="simple">
<li><p>721 unique persons (excluding injured).</p></li>
<li><p>Mean number of events per person = 16.</p></li>
<li><p>However, median (2) is a better measure of centrality as the data is right skewed.</p></li>
<li><p>75% of the data participate in 14 or less events.
<br><br></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Male</span></code> and <code class="docutils literal notranslate"><span class="pre">Female</span></code> median is a lot larger when we disregard other values in the Gender column.</p>
<ul>
<li><p>This plays into the idea that people with fewer records have less information about them.</p></li>
</ul>
</li>
<li><p>Compared to <code class="docutils literal notranslate"><span class="pre">Male</span></code> (126) and <code class="docutils literal notranslate"><span class="pre">Female</span></code> (123), 0 occurs far more frequently (468).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Female</span></code> median (20) is larger than male (13) and 0 (1).
<br><br></p></li>
<li><p>75% of <code class="docutils literal notranslate"><span class="pre">Male</span></code> perform in less than 39 events.</p></li>
<li><p>75% of <code class="docutils literal notranslate"><span class="pre">Female</span></code> perform in less than 54 events.</p></li>
<li><p>75% of <code class="docutils literal notranslate"><span class="pre">0</span></code> perform in 3 or less events.</p></li>
</ul>
<p>We also provide a histogram with a layered boxplot to highlight the skewness seen in participation rates.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_box</span><span class="p">,</span> <span class="n">ax_hist</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                    <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;height_ratios&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">.15</span><span class="p">,</span> <span class="mf">.85</span><span class="p">)})</span>

<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_noinjuries</span><span class="p">[</span><span class="s1">&#39;PERSON.NUMBER&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_box</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_noinjuries</span><span class="p">[</span><span class="s1">&#39;PERSON.NUMBER&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(),</span> 
             <span class="n">bins</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_hist</span><span class="p">)</span>

<span class="n">ax_box</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">yticks</span><span class="o">=</span><span class="p">[])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax_hist</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax_box</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/CircusOzEDA_17_0.png" src="_images/CircusOzEDA_17_0.png" />
</div>
</div>
<p>Below we list 20 people who have been involved in the most Circus Oz events. We have coloured each bar according to the gender record.</p>
<ul class="simple">
<li><p>Tim Coldwell leads with 378 events followed by Michael Ling with 307 events.</p></li>
<li><p>Both males and females are among the highest</p></li>
<li><p>Only one <code class="docutils literal notranslate"><span class="pre">0</span></code> record, Terry Lycos</p></li>
</ul>
<p>One interesting insight from looking at participation rates is that 99% of all events in the data have links to the top 1% of most active participants (from Tim Coldwell to Mel Fyfe).</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">persons_freq</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df_noinjuries</span><span class="p">[</span><span class="s1">&#39;COMBINED.NAME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>

<span class="n">tab_df</span> <span class="o">=</span> <span class="n">persons_freq</span>\
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
    <span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;index&#39;</span><span class="p">:</span><span class="s1">&#39;Person&#39;</span><span class="p">,</span>
             <span class="s1">&#39;COMBINED.NAME&#39;</span><span class="p">:</span><span class="s1">&#39;Frequency&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>

<span class="c1"># labels = (tab_df[&#39;Frequency&#39;]/persons_freq.shape[0])\</span>
<span class="c1">#         .round(2).astype(&#39;str&#39;) + &#39;%&#39;</span>

<span class="n">labels</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">tab_df</span><span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">)</span>

<span class="n">tab_df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Person&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span><span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                  <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">])</span>

<span class="c1"># add bar labels</span>
<span class="p">[</span><span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span> 
 <span class="k">for</span> <span class="n">container</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">]</span>

<span class="c1"># remove legend and y-axis title</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;People with the highest participation rates, Top 20</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">405</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/CircusOzEDA_19_0.png" src="_images/CircusOzEDA_19_0.png" />
</div>
</div>
<blockquote class="epigraph">
<div><p>99% of all events in the data have links to the top 1% of most active participants.</p>
</div></blockquote>
</div>
<div class="section" id="roles">
<h2>Roles<a class="headerlink" href="#roles" title="Permalink to this headline">¶</a></h2>
<p>We take a deep dive into the recorded roles across the participant data. A person can have many roles within an event.</p>
<p>We first review the distribution across role types by treating each role within an event for a given person as one record. <code class="docutils literal notranslate"><span class="pre">Performer</span></code> has the most records making up 37% of the data.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Role.Category.Concatinate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Role.Category.Concatinate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;Missing&#39;</span><span class="p">)</span>

<span class="c1"># convert the DataFrame to a list of transactions</span>
<span class="n">transactions</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Role.Category.Concatinate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
<span class="n">transactions_m</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> 
                  <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Gender</span><span class="o">==</span><span class="s1">&#39;M&#39;</span><span class="p">][</span><span class="s1">&#39;Role.Category.Concatinate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
<span class="n">transactions_f</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> 
                  <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Gender</span><span class="o">==</span><span class="s1">&#39;F&#39;</span><span class="p">][</span><span class="s1">&#39;Role.Category.Concatinate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>

<span class="n">roles_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="c1">#printing the counts</span>
<span class="k">for</span> <span class="n">role</span> <span class="ow">in</span> <span class="n">transactions</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">role</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">roles_dict</span><span class="p">:</span> <span class="n">roles_dict</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">roles_dict</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            
<span class="n">role_count</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">roles_dict</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> 
                          <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">])</span>
<span class="n">toproles</span> <span class="o">=</span> <span class="n">role_count</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">labels</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">toproles</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; (&#39;</span> \
         <span class="o">+</span> <span class="p">(</span><span class="n">toproles</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">toproles</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>\
         <span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;%)&#39;</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">toproles</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Role&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span><span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># add bar labels</span>
<span class="p">[</span><span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span> 
 <span class="k">for</span> <span class="n">container</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">]</span>

<span class="c1"># remove legend and y-axis title</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Proportion of role occurrences&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6000</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/CircusOzEDA_22_0.png" src="_images/CircusOzEDA_22_0.png" />
</div>
</div>
<div class="section" id="how-many-roles-on-average">
<h3>How many roles on average?<a class="headerlink" href="#how-many-roles-on-average" title="Permalink to this headline">¶</a></h3>
<p>We explore whether certain roles on average (median) tend to be pairs or not. The visualisaiton below highlights the median number of roles given a role type. This bar chart suggests that most of time people tend to do one role only during an event.</p>
<p>We also tested averaged differences for data filtered on <code class="docutils literal notranslate"><span class="pre">Males</span></code> and <code class="docutils literal notranslate"><span class="pre">Females</span></code>, and found only one difference. Our findings are summarised below.</p>
<ul class="simple">
<li><p>On average, female <code class="docutils literal notranslate"><span class="pre">Musician</span></code> tend to have one extra role, while majority of male musicians are solely <code class="docutils literal notranslate"><span class="pre">Musician</span></code>.</p></li>
<li><p>50% of female <code class="docutils literal notranslate"><span class="pre">Musician</span></code> are also listed as being a <code class="docutils literal notranslate"><span class="pre">Performer</span></code>.</p></li>
<li><p>15% of female <code class="docutils literal notranslate"><span class="pre">Musician</span></code> are also listed as being a <code class="docutils literal notranslate"><span class="pre">KeyCreative</span></code>.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">roles_unique</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">transactions</span><span class="p">:</span>
    <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ele</span><span class="p">)</span>
    <span class="n">roles_unique</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
<span class="n">roles_averages</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">roles_unique</span><span class="p">))):</span>
    <span class="n">number_roles</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">_</span> <span class="o">=</span> <span class="p">[</span><span class="n">number_roles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">transactions</span> <span class="k">if</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="n">roles_averages</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">number_roles</span><span class="p">)</span><span class="o">.</span><span class="n">median</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
<span class="n">roles_averages_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">roles_averages</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="n">roles_averages_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">,</span><span class="s1">&#39;Avg. no of Roles&#39;</span><span class="p">]</span>
<span class="n">roles_averages_df</span> <span class="o">=</span> <span class="n">roles_averages_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Role&#39;</span><span class="p">)</span>
<span class="n">roles_averages_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Role&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;barh&#39;</span><span class="p">)</span>

<span class="c1"># adjust legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># check for differences between Male and Female subsets</span>
<span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">roles_unique</span><span class="p">))):</span>
    <span class="n">number_roles_m</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">number_roles_f</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">_</span> <span class="o">=</span> <span class="p">[</span><span class="n">number_roles_m</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">transactions_m</span> <span class="k">if</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="n">_</span> <span class="o">=</span> <span class="p">[</span><span class="n">number_roles_f</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">transactions_f</span> <span class="k">if</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">number_roles_m</span><span class="p">)</span><span class="o">.</span><span class="n">median</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">number_roles_f</span><span class="p">)</span><span class="o">.</span><span class="n">median</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># if abs(diff) &gt;= 1: print(y, pd.DataFrame(number_roles_m).median().values[0],</span>
    <span class="c1">#                         pd.DataFrame(number_roles_f).median().values[0])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/CircusOzEDA_24_0.png" src="_images/CircusOzEDA_24_0.png" />
</div>
</div>
<blockquote class="epigraph">
<div><p>On average, female musicians tend to have one extra role, while majority of male musicians are solely a musician.</p>
</div></blockquote>
</div>
<div class="section" id="association-rule-mining">
<h3>Association Rule Mining<a class="headerlink" href="#association-rule-mining" title="Permalink to this headline">¶</a></h3>
<p>Now we assess the occurrences of multiple roles happening together. We adopt association rule mining as it can help us answer questions such as what’s the likelihood of a <code class="docutils literal notranslate"><span class="pre">Perfomer</span></code> also being a <code class="docutils literal notranslate"><span class="pre">Musician</span></code>. This becomes more interesting as we drill down across gender and time.</p>
<p>We start by generating association rules for the data in its entirety.</p>
<ul class="simple">
<li><p>69% of people who are KeyCreatives and Musicians tend to also be Performers</p></li>
<li><p>41% of people who are Musicians tend to also be Performers</p></li>
<li><p>26% of people who are KeyCreatives and Performers tend to also be Musicians</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">te</span> <span class="o">=</span> <span class="n">TransactionEncoder</span><span class="p">()</span>
<span class="n">te_array</span> <span class="o">=</span> <span class="n">te</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">transactions</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">transactions</span><span class="p">)</span>
<span class="n">te_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">te_array</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">te</span><span class="o">.</span><span class="n">columns_</span><span class="p">)</span>
<span class="n">frequent_itemsets_ap</span> <span class="o">=</span> <span class="n">apriori</span><span class="p">(</span><span class="n">te_df</span><span class="p">,</span> <span class="n">min_support</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">use_colnames</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">rules_ap</span> <span class="o">=</span> <span class="n">association_rules</span><span class="p">(</span><span class="n">frequent_itemsets_ap</span><span class="p">,</span> 
                             <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;lift&quot;</span><span class="p">,</span> 
                             <span class="n">min_threshold</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># rules_ap[rules_ap.lift &gt;= 1].sort_values(&#39;confidence&#39;, ascending = False).head(10)</span>
<span class="n">rules_ap</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;confidence&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>\
<span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;lift&#39;</span><span class="p">,</span><span class="s1">&#39;leverage&#39;</span><span class="p">,</span><span class="s1">&#39;conviction&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#.head(10)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>antecedents</th>
      <th>consequents</th>
      <th>antecedent support</th>
      <th>consequent support</th>
      <th>support</th>
      <th>confidence</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>(KeyCreative, Musician)</td>
      <td>(Performer)</td>
      <td>0.007494</td>
      <td>0.393256</td>
      <td>0.005162</td>
      <td>0.688889</td>
    </tr>
    <tr>
      <th>1</th>
      <td>(Musician)</td>
      <td>(Performer)</td>
      <td>0.073439</td>
      <td>0.393256</td>
      <td>0.030475</td>
      <td>0.414966</td>
    </tr>
    <tr>
      <th>2</th>
      <td>(KeyCreative, Performer)</td>
      <td>(Musician)</td>
      <td>0.019567</td>
      <td>0.073439</td>
      <td>0.005162</td>
      <td>0.263830</td>
    </tr>
    <tr>
      <th>0</th>
      <td>(Performer)</td>
      <td>(Musician)</td>
      <td>0.393256</td>
      <td>0.073439</td>
      <td>0.030475</td>
      <td>0.077493</td>
    </tr>
    <tr>
      <th>5</th>
      <td>(Musician)</td>
      <td>(KeyCreative, Performer)</td>
      <td>0.073439</td>
      <td>0.019567</td>
      <td>0.005162</td>
      <td>0.070295</td>
    </tr>
    <tr>
      <th>4</th>
      <td>(Performer)</td>
      <td>(KeyCreative, Musician)</td>
      <td>0.393256</td>
      <td>0.007494</td>
      <td>0.005162</td>
      <td>0.013127</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p><strong>Antecedents</strong>: Antecedents are the items or conditions that are present in a given itemset (i.e., roles) in an association rule. They are also known as the “left-hand side” or “premise” of the rule.</p></li>
<li><p><strong>Consequents</strong>: Consequents are the items or conditions that are predicted to occur in a given itemset based on the presence of the antecedents in the association rule. They are also known as the “right-hand side” or “conclusion” of the rule.</p></li>
<li><p><strong>Antecedent support</strong>: Antecedent support is the percentage of itemsets in the dataset that contain the antecedents of an association rule.</p></li>
<li><p><strong>Consequent support</strong>: Consequent support is the percentage of itemsets in the dataset that contain the consequents of an association rule.</p></li>
<li><p><strong>Support</strong>: Support is a measure of how frequently an association rule occurs in the dataset. It is calculated as the percentage of itemsets that contain both the antecedents and the consequents of the rule.</p></li>
<li><p><strong>Confidence</strong>: Confidence is a measure of how strongly the presence of the antecedents in an itemset predicts the presence of the consequents. It is calculated as the percentage of itemsets that contain the antecedents and the consequents, divided by the percentage of itemsets that contain the antecedents.</p></li>
</ul>
</div>
<p>Next we generate association rules for <code class="docutils literal notranslate"><span class="pre">Male</span></code> data and <code class="docutils literal notranslate"><span class="pre">Female</span></code> data, and compare the confidence of the rules to highlight any significant differences. Below are rules with a difference larger than 5%.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Males</span></code> who are <code class="docutils literal notranslate"><span class="pre">KeyCreatives</span></code> tend to also be <code class="docutils literal notranslate"><span class="pre">Performers</span></code> 6% more than <code class="docutils literal notranslate"><span class="pre">Females</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Females</span></code> who are <code class="docutils literal notranslate"><span class="pre">Musicians</span></code> tend to also be <code class="docutils literal notranslate"><span class="pre">Performers</span></code> 5% more than <code class="docutils literal notranslate"><span class="pre">Males</span></code>.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">te</span> <span class="o">=</span> <span class="n">TransactionEncoder</span><span class="p">()</span>
<span class="n">te_array</span> <span class="o">=</span> <span class="n">te</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">transactions_m</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">transactions_m</span><span class="p">)</span>
<span class="n">te_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">te_array</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">te</span><span class="o">.</span><span class="n">columns_</span><span class="p">)</span>
<span class="n">frequent_itemsets_ap</span> <span class="o">=</span> <span class="n">apriori</span><span class="p">(</span><span class="n">te_df</span><span class="p">,</span> <span class="n">min_support</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">use_colnames</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">rules_ap_m</span> <span class="o">=</span> <span class="n">association_rules</span><span class="p">(</span><span class="n">frequent_itemsets_ap</span><span class="p">,</span> 
                             <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;confidence&quot;</span><span class="p">,</span> 
                             <span class="n">min_threshold</span><span class="o">=</span><span class="mf">0.005</span><span class="p">)</span>

<span class="n">te</span> <span class="o">=</span> <span class="n">TransactionEncoder</span><span class="p">()</span>
<span class="n">te_array</span> <span class="o">=</span> <span class="n">te</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">transactions_f</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">transactions_f</span><span class="p">)</span>
<span class="n">te_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">te_array</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">te</span><span class="o">.</span><span class="n">columns_</span><span class="p">)</span>
<span class="n">frequent_itemsets_ap</span> <span class="o">=</span> <span class="n">apriori</span><span class="p">(</span><span class="n">te_df</span><span class="p">,</span> <span class="n">min_support</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">use_colnames</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">rules_ap_f</span> <span class="o">=</span> <span class="n">association_rules</span><span class="p">(</span><span class="n">frequent_itemsets_ap</span><span class="p">,</span> 
                             <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;confidence&quot;</span><span class="p">,</span> 
                             <span class="n">min_threshold</span><span class="o">=</span><span class="mf">0.005</span><span class="p">)</span>


<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.float_format&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>

<span class="n">supports</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">rules_ap_m</span><span class="p">,</span> <span class="n">rules_ap_f</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;antecedents&#39;</span><span class="p">,</span><span class="s1">&#39;consequents&#39;</span><span class="p">])</span>
<span class="n">supports</span> <span class="o">=</span> <span class="n">supports</span><span class="p">[[</span><span class="s1">&#39;antecedents&#39;</span><span class="p">,</span><span class="s1">&#39;consequents&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;support_x&#39;</span><span class="p">,</span><span class="s1">&#39;support_y&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;confidence_x&#39;</span><span class="p">,</span><span class="s1">&#39;confidence_y&#39;</span><span class="p">]]</span>
<span class="n">supports</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;antecedents&#39;</span><span class="p">,</span><span class="s1">&#39;consequents&#39;</span><span class="p">,</span> <span class="s1">&#39;support_M&#39;</span><span class="p">,</span><span class="s1">&#39;support_F&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;confidence_M&#39;</span><span class="p">,</span><span class="s1">&#39;confidence_F&#39;</span><span class="p">]</span>         
<span class="n">supports</span><span class="p">[</span><span class="s1">&#39;diff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">supports</span><span class="p">[</span><span class="s1">&#39;confidence_M&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">supports</span><span class="p">[</span><span class="s1">&#39;confidence_F&#39;</span><span class="p">]</span>
<span class="n">supports</span><span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">supports</span><span class="p">[</span><span class="s1">&#39;diff&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>antecedents</th>
      <th>consequents</th>
      <th>support_M</th>
      <th>support_F</th>
      <th>confidence_M</th>
      <th>confidence_F</th>
      <th>diff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>(KeyCreative)</td>
      <td>(Performer)</td>
      <td>0.031</td>
      <td>0.019</td>
      <td>0.149</td>
      <td>0.091</td>
      <td>0.057</td>
    </tr>
    <tr>
      <th>5</th>
      <td>(Musician)</td>
      <td>(Performer)</td>
      <td>0.046</td>
      <td>0.027</td>
      <td>0.445</td>
      <td>0.498</td>
      <td>-0.053</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="role-changes-over-time">
<h3>Role changes over time<a class="headerlink" href="#role-changes-over-time" title="Permalink to this headline">¶</a></h3>
<p>We visualise role types over time excluding Missing, Unknown and Injured categories. Across each five-year period, <code class="docutils literal notranslate"><span class="pre">Performer</span></code> is the role type with the highest frequency, followed by <code class="docutils literal notranslate"><span class="pre">KeyCreative</span></code> and <code class="docutils literal notranslate"><span class="pre">Crew</span></code>. All role types follow a similiar trajectory, with the exception of <code class="docutils literal notranslate"><span class="pre">Musician</span></code>.</p>
<p>The second visulisation uses proportion instead of frequency - this allows for a more balanced view for each respective five-year period. It tells a slightly different story in which the <code class="docutils literal notranslate"><span class="pre">Performer</span></code> role is proportionally decreasing.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># remove injuries and missing data</span>
<span class="n">df_noinjuries</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Role.Category.Concatinate&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;Injured&#39;</span><span class="p">]</span>

<span class="n">df_noinjuries</span><span class="p">[</span><span class="s2">&quot;Role.Category.Concatinate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_noinjuries</span><span class="p">[</span><span class="s2">&quot;Role.Category.Concatinate&quot;</span><span class="p">]</span>\
    <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;Injured&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>\
    <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;Unknown&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>\
    <span class="o">.</span><span class="n">str</span>\
    <span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    
<span class="n">df_noinjuries</span> <span class="o">=</span> <span class="n">df_noinjuries</span><span class="p">[</span><span class="o">~</span><span class="n">df_noinjuries</span><span class="p">[</span><span class="s2">&quot;Role.Category.Concatinate&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;Missing&quot;</span><span class="p">,</span> <span class="s2">&quot;Unknown&quot;</span><span class="p">])]</span>

<span class="n">toproles_decade</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="c1">### 1975</span>
<span class="n">data_70s</span> <span class="o">=</span> <span class="n">df_noinjuries</span><span class="p">[</span><span class="n">df_noinjuries</span><span class="p">[</span><span class="s1">&#39;Year_decade&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1975</span><span class="p">]</span>

<span class="c1"># convert the DataFrame to a list of transactions</span>
<span class="n">transactions</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data_70s</span><span class="p">[</span><span class="s1">&#39;Role.Category.Concatinate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>

<span class="n">roles_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="c1">#printing the counts</span>
<span class="k">for</span> <span class="n">role</span> <span class="ow">in</span> <span class="n">transactions</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">role</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">roles_dict</span><span class="p">:</span> <span class="n">roles_dict</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">roles_dict</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            
<span class="n">role_count</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">roles_dict</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> 
                          <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">])</span>
<span class="n">toproles_70s</span> <span class="o">=</span> <span class="n">role_count</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Decade&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1975</span>
<span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Proportion&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">toproles_decade</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">toproles_decade</span><span class="p">,</span><span class="n">toproles_70s</span><span class="p">])</span>

<span class="c1">### 1980</span>
<span class="n">data_70s</span> <span class="o">=</span> <span class="n">df_noinjuries</span><span class="p">[</span><span class="n">df_noinjuries</span><span class="p">[</span><span class="s1">&#39;Year_decade&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1980</span><span class="p">]</span>

<span class="c1"># convert the DataFrame to a list of transactions</span>
<span class="n">transactions</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data_70s</span><span class="p">[</span><span class="s1">&#39;Role.Category.Concatinate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>

<span class="n">roles_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="c1">#printing the counts</span>
<span class="k">for</span> <span class="n">role</span> <span class="ow">in</span> <span class="n">transactions</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">role</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">roles_dict</span><span class="p">:</span> <span class="n">roles_dict</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">roles_dict</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            
<span class="n">role_count</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">roles_dict</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> 
                          <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">])</span>
<span class="n">toproles_70s</span> <span class="o">=</span> <span class="n">role_count</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Decade&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1980</span>
<span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Proportion&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">toproles_decade</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">toproles_decade</span><span class="p">,</span><span class="n">toproles_70s</span><span class="p">])</span>

<span class="c1">### 1985</span>
<span class="n">data_70s</span> <span class="o">=</span> <span class="n">df_noinjuries</span><span class="p">[</span><span class="n">df_noinjuries</span><span class="p">[</span><span class="s1">&#39;Year_decade&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1985</span><span class="p">]</span>

<span class="c1"># convert the DataFrame to a list of transactions</span>
<span class="n">transactions</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data_70s</span><span class="p">[</span><span class="s1">&#39;Role.Category.Concatinate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>

<span class="n">roles_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="c1">#printing the counts</span>
<span class="k">for</span> <span class="n">role</span> <span class="ow">in</span> <span class="n">transactions</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">role</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">roles_dict</span><span class="p">:</span> <span class="n">roles_dict</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">roles_dict</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            
<span class="n">role_count</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">roles_dict</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> 
                          <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">])</span>
<span class="n">toproles_70s</span> <span class="o">=</span> <span class="n">role_count</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Decade&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1985</span>
<span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Proportion&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">toproles_decade</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">toproles_decade</span><span class="p">,</span><span class="n">toproles_70s</span><span class="p">])</span>

<span class="c1">### 1990</span>
<span class="n">data_70s</span> <span class="o">=</span> <span class="n">df_noinjuries</span><span class="p">[</span><span class="n">df_noinjuries</span><span class="p">[</span><span class="s1">&#39;Year_decade&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1990</span><span class="p">]</span>

<span class="c1"># convert the DataFrame to a list of transactions</span>
<span class="n">transactions</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data_70s</span><span class="p">[</span><span class="s1">&#39;Role.Category.Concatinate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>

<span class="n">roles_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="c1">#printing the counts</span>
<span class="k">for</span> <span class="n">role</span> <span class="ow">in</span> <span class="n">transactions</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">role</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">roles_dict</span><span class="p">:</span> <span class="n">roles_dict</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">roles_dict</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            
<span class="n">role_count</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">roles_dict</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> 
                          <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">])</span>
<span class="n">toproles_70s</span> <span class="o">=</span> <span class="n">role_count</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Decade&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1990</span>
<span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Proportion&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">toproles_decade</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">toproles_decade</span><span class="p">,</span><span class="n">toproles_70s</span><span class="p">])</span>

<span class="c1">### 1995</span>
<span class="n">data_70s</span> <span class="o">=</span> <span class="n">df_noinjuries</span><span class="p">[</span><span class="n">df_noinjuries</span><span class="p">[</span><span class="s1">&#39;Year_decade&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1995</span><span class="p">]</span>

<span class="c1"># convert the DataFrame to a list of transactions</span>
<span class="n">transactions</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data_70s</span><span class="p">[</span><span class="s1">&#39;Role.Category.Concatinate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>

<span class="n">roles_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="c1">#printing the counts</span>
<span class="k">for</span> <span class="n">role</span> <span class="ow">in</span> <span class="n">transactions</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">role</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">roles_dict</span><span class="p">:</span> <span class="n">roles_dict</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">roles_dict</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            
<span class="n">role_count</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">roles_dict</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> 
                          <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">])</span>
<span class="n">toproles_70s</span> <span class="o">=</span> <span class="n">role_count</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Decade&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1995</span>
<span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Proportion&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">toproles_decade</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">toproles_decade</span><span class="p">,</span><span class="n">toproles_70s</span><span class="p">])</span>

<span class="c1">### 2000</span>
<span class="n">data_70s</span> <span class="o">=</span> <span class="n">df_noinjuries</span><span class="p">[</span><span class="n">df_noinjuries</span><span class="p">[</span><span class="s1">&#39;Year_decade&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2000</span><span class="p">]</span>

<span class="c1"># convert the DataFrame to a list of transactions</span>
<span class="n">transactions</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data_70s</span><span class="p">[</span><span class="s1">&#39;Role.Category.Concatinate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>

<span class="n">roles_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="c1">#printing the counts</span>
<span class="k">for</span> <span class="n">role</span> <span class="ow">in</span> <span class="n">transactions</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">role</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">roles_dict</span><span class="p">:</span> <span class="n">roles_dict</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">roles_dict</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            
<span class="n">role_count</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">roles_dict</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> 
                          <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">])</span>
<span class="n">toproles_70s</span> <span class="o">=</span> <span class="n">role_count</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Decade&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2000</span>
<span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Proportion&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">toproles_decade</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">toproles_decade</span><span class="p">,</span><span class="n">toproles_70s</span><span class="p">])</span>

<span class="c1">### 2005</span>
<span class="n">data_70s</span> <span class="o">=</span> <span class="n">df_noinjuries</span><span class="p">[</span><span class="n">df_noinjuries</span><span class="p">[</span><span class="s1">&#39;Year_decade&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2005</span><span class="p">]</span>

<span class="c1"># convert the DataFrame to a list of transactions</span>
<span class="n">transactions</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data_70s</span><span class="p">[</span><span class="s1">&#39;Role.Category.Concatinate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>

<span class="n">roles_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="c1">#printing the counts</span>
<span class="k">for</span> <span class="n">role</span> <span class="ow">in</span> <span class="n">transactions</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">role</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">roles_dict</span><span class="p">:</span> <span class="n">roles_dict</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">roles_dict</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            
<span class="n">role_count</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">roles_dict</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> 
                          <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">])</span>
<span class="n">toproles_70s</span> <span class="o">=</span> <span class="n">role_count</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Decade&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2005</span>
<span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Proportion&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">toproles_decade</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">toproles_decade</span><span class="p">,</span><span class="n">toproles_70s</span><span class="p">])</span>


<span class="c1">### 2010</span>
<span class="n">data_70s</span> <span class="o">=</span> <span class="n">df_noinjuries</span><span class="p">[</span><span class="n">df_noinjuries</span><span class="p">[</span><span class="s1">&#39;Year_decade&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2010</span><span class="p">]</span>

<span class="c1"># convert the DataFrame to a list of transactions</span>
<span class="n">transactions</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data_70s</span><span class="p">[</span><span class="s1">&#39;Role.Category.Concatinate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>

<span class="n">roles_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="c1">#printing the counts</span>
<span class="k">for</span> <span class="n">role</span> <span class="ow">in</span> <span class="n">transactions</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">role</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">roles_dict</span><span class="p">:</span> <span class="n">roles_dict</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">roles_dict</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            
<span class="n">role_count</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">roles_dict</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> 
                          <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">])</span>
<span class="n">toproles_70s</span> <span class="o">=</span> <span class="n">role_count</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Decade&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2005</span>
<span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Proportion&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">toproles_70s</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">toproles_decade</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">toproles_decade</span><span class="p">,</span><span class="n">toproles_70s</span><span class="p">])</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">toproles_decade</span><span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">toproles_decade</span><span class="p">[</span><span class="n">toproles_decade</span><span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">]</span><span class="o">==</span> <span class="n">x</span><span class="p">][</span><span class="s1">&#39;Decade&#39;</span><span class="p">],</span>
             <span class="n">toproles_decade</span><span class="p">[</span><span class="n">toproles_decade</span><span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">]</span><span class="o">==</span> <span class="n">x</span><span class="p">][</span><span class="s1">&#39;Count&#39;</span><span class="p">],</span> 
             <span class="n">label</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Role participation by demi-decade&#39;</span><span class="p">,</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1975</span><span class="p">,</span> <span class="mi">2010</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;75-79&#39;</span><span class="p">,</span> <span class="s1">&#39;80-84&#39;</span><span class="p">,</span><span class="s1">&#39;85-89&#39;</span><span class="p">,</span> <span class="s1">&#39;90-94&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;95-99&#39;</span><span class="p">,</span> <span class="s1">&#39;00-04&#39;</span><span class="p">,</span><span class="s1">&#39;05-09&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/CircusOzEDA_32_0.png" src="_images/CircusOzEDA_32_0.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">toproles_decade</span><span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">toproles_decade</span><span class="p">[</span><span class="n">toproles_decade</span><span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">]</span><span class="o">==</span> <span class="n">x</span><span class="p">][</span><span class="s1">&#39;Decade&#39;</span><span class="p">],</span>
             <span class="n">toproles_decade</span><span class="p">[</span><span class="n">toproles_decade</span><span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">]</span><span class="o">==</span> <span class="n">x</span><span class="p">][</span><span class="s1">&#39;Proportion&#39;</span><span class="p">],</span> 
             <span class="n">label</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Role participation proportion by demi-decade&#39;</span><span class="p">,</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1975</span><span class="p">,</span> <span class="mi">2010</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;75-79&#39;</span><span class="p">,</span> <span class="s1">&#39;80-84&#39;</span><span class="p">,</span><span class="s1">&#39;85-89&#39;</span><span class="p">,</span> <span class="s1">&#39;90-94&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;95-99&#39;</span><span class="p">,</span> <span class="s1">&#39;00-04&#39;</span><span class="p">,</span><span class="s1">&#39;05-09&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/CircusOzEDA_33_0.png" src="_images/CircusOzEDA_33_0.png" />
</div>
</div>
</div>
<div class="section" id="male-and-female-proportion-by-role-over-time">
<h3>Male and female proportion by role over time<a class="headerlink" href="#male-and-female-proportion-by-role-over-time" title="Permalink to this headline">¶</a></h3>
<p>We isolate the data for each role and assess the data with respect to <code class="docutils literal notranslate"><span class="pre">Males</span></code> and <code class="docutils literal notranslate"><span class="pre">Females</span></code>. This is repeated using proportions. Main findings are listed below.</p>
<ul class="simple">
<li><p>There have been more female <code class="docutils literal notranslate"><span class="pre">KeyCreatives</span></code> over time, with the exception of 95-99 and 05-09.</p></li>
<li><p>Post-1995 more males have worked as <code class="docutils literal notranslate"><span class="pre">Crew</span></code> members.</p></li>
<li><p>There have been more male <code class="docutils literal notranslate"><span class="pre">Musicians</span></code> over time, with the exception of 85-89 and 05-09.</p></li>
<li><p>There have been more male <code class="docutils literal notranslate"><span class="pre">Performers</span></code> over time.</p></li>
<li><p>There have been more females working in <code class="docutils literal notranslate"><span class="pre">Administration</span></code> over time. Interesting to see no <code class="docutils literal notranslate"><span class="pre">Administration</span></code> records prior to 1980.</p></li>
<li><p>There have been more females working as a <code class="docutils literal notranslate"><span class="pre">Subsidiary</span></code>, however data is only recorded between 1990 and 2004.
<br><br></p></li>
<li><p>In 00-04 period, there appears to be very little proportion of Female Musicians.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">toproles_decade_gender</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">supports_decade</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_noinjuries</span><span class="p">[</span><span class="s1">&#39;Year_decade&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span> 
    <span class="c1">### 1975</span>
    <span class="n">data_70s</span> <span class="o">=</span> <span class="n">df_noinjuries</span><span class="p">[</span><span class="n">df_noinjuries</span><span class="p">[</span><span class="s1">&#39;Year_decade&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">x</span><span class="p">]</span>

    <span class="c1"># convert the DataFrame to a list of transactions</span>
    <span class="n">transactions_m</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> 
                      <span class="n">data_70s</span><span class="p">[(</span><span class="n">data_70s</span><span class="o">.</span><span class="n">Gender</span><span class="o">==</span><span class="s1">&#39;M&#39;</span><span class="p">)][</span><span class="s1">&#39;Role.Category.Concatinate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
    <span class="n">transactions_f</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> 
                      <span class="n">data_70s</span><span class="p">[</span><span class="n">data_70s</span><span class="o">.</span><span class="n">Gender</span><span class="o">==</span><span class="s1">&#39;F&#39;</span><span class="p">][</span><span class="s1">&#39;Role.Category.Concatinate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
    <span class="n">roles_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="c1">#printing the counts</span>
    <span class="k">for</span> <span class="n">role</span> <span class="ow">in</span> <span class="n">transactions_m</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">role</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">roles_dict</span><span class="p">:</span> <span class="n">roles_dict</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">roles_dict</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">role_count</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">roles_dict</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> 
                              <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">])</span>
    <span class="n">toproles_70s_m</span> <span class="o">=</span> <span class="n">role_count</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">toproles_70s_m</span><span class="p">[</span><span class="s1">&#39;Decade&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
    <span class="c1"># toproles_70s_m[&#39;Gender&#39;] = &#39;Male&#39;</span>

    <span class="n">roles_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    
    <span class="c1">#printing the counts</span>
    <span class="k">for</span> <span class="n">role</span> <span class="ow">in</span> <span class="n">transactions_f</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">role</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">roles_dict</span><span class="p">:</span> <span class="n">roles_dict</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">roles_dict</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">role_count</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">roles_dict</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> 
                              <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">])</span>
    <span class="n">toproles_70s_f</span> <span class="o">=</span> <span class="n">role_count</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">toproles_70s_f</span><span class="p">[</span><span class="s1">&#39;Decade&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
    <span class="c1"># toproles_70s_f[&#39;Gender&#39;] = &#39;Female&#39;</span>
    
    <span class="n">toproles_70s_mf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">toproles_70s_m</span><span class="p">,</span> <span class="n">toproles_70s_f</span><span class="p">[[</span><span class="s1">&#39;Role&#39;</span><span class="p">,</span><span class="s1">&#39;Decade&#39;</span><span class="p">,</span><span class="s1">&#39;Count&#39;</span><span class="p">]],</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">,</span><span class="s1">&#39;Decade&#39;</span><span class="p">])</span>
    <span class="n">toproles_70s_mf</span><span class="p">[</span><span class="s1">&#39;count_sum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">toproles_70s_mf</span><span class="p">[</span><span class="s1">&#39;Count_x&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">toproles_70s_mf</span><span class="p">[</span><span class="s1">&#39;Count_y&#39;</span><span class="p">]</span>
    <span class="n">toproles_70s_mf</span><span class="p">[</span><span class="s1">&#39;Proportion_x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">toproles_70s_mf</span><span class="p">[</span><span class="s1">&#39;Count_x&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">toproles_70s_mf</span><span class="p">[</span><span class="s1">&#39;count_sum&#39;</span><span class="p">]</span>
    <span class="n">toproles_70s_mf</span><span class="p">[</span><span class="s1">&#39;Proportion_y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">toproles_70s_mf</span><span class="p">[</span><span class="s1">&#39;Count_y&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">toproles_70s_mf</span><span class="p">[</span><span class="s1">&#39;count_sum&#39;</span><span class="p">]</span>
    <span class="n">toproles_decade_gender</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">toproles_decade_gender</span><span class="p">,</span><span class="n">toproles_70s_mf</span><span class="p">])</span>
    
    <span class="n">te</span> <span class="o">=</span> <span class="n">TransactionEncoder</span><span class="p">()</span>
    <span class="n">te_array</span> <span class="o">=</span> <span class="n">te</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">transactions_m</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">transactions_m</span><span class="p">)</span>
    <span class="n">te_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">te_array</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">te</span><span class="o">.</span><span class="n">columns_</span><span class="p">)</span>
    <span class="n">frequent_itemsets_ap</span> <span class="o">=</span> <span class="n">apriori</span><span class="p">(</span><span class="n">te_df</span><span class="p">,</span> <span class="n">min_support</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">use_colnames</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">rules_ap_m</span> <span class="o">=</span> <span class="n">association_rules</span><span class="p">(</span><span class="n">frequent_itemsets_ap</span><span class="p">,</span> 
                                 <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;confidence&quot;</span><span class="p">,</span> 
                                 <span class="n">min_threshold</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>

    <span class="n">te</span> <span class="o">=</span> <span class="n">TransactionEncoder</span><span class="p">()</span>
    <span class="n">te_array</span> <span class="o">=</span> <span class="n">te</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">transactions_f</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">transactions_f</span><span class="p">)</span>
    <span class="n">te_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">te_array</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">te</span><span class="o">.</span><span class="n">columns_</span><span class="p">)</span>
    <span class="n">frequent_itemsets_ap</span> <span class="o">=</span> <span class="n">apriori</span><span class="p">(</span><span class="n">te_df</span><span class="p">,</span> <span class="n">min_support</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">use_colnames</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">rules_ap_f</span> <span class="o">=</span> <span class="n">association_rules</span><span class="p">(</span><span class="n">frequent_itemsets_ap</span><span class="p">,</span> 
                                 <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;confidence&quot;</span><span class="p">,</span> 
                                 <span class="n">min_threshold</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>

    <span class="n">supports</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">rules_ap_m</span><span class="p">,</span> <span class="n">rules_ap_f</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;antecedents&#39;</span><span class="p">,</span><span class="s1">&#39;consequents&#39;</span><span class="p">])</span>
    <span class="n">supports</span><span class="p">[</span><span class="s1">&#39;Decade&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
    <span class="n">supports_decade</span> <span class="o">=</span> <span class="n">supports_decade</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">supports</span><span class="p">)</span>

<span class="n">toproles_decade_gender</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">,</span><span class="s1">&#39;Count_m&#39;</span><span class="p">,</span><span class="s1">&#39;Decade&#39;</span><span class="p">,</span><span class="s1">&#39;Count_f&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;count_sum&#39;</span><span class="p">,</span><span class="s1">&#39;Proportion_m&#39;</span><span class="p">,</span><span class="s1">&#39;Proportion_f&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">toproles_decade_gender</span><span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">toproles_decade_gender</span><span class="p">[</span><span class="n">toproles_decade_gender</span><span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;Decade&#39;</span><span class="p">],</span>
             <span class="n">toproles_decade_gender</span><span class="p">[</span><span class="n">toproles_decade_gender</span><span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;Count_f&#39;</span><span class="p">],</span> 
             <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Females&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">toproles_decade_gender</span><span class="p">[</span><span class="n">toproles_decade_gender</span><span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;Decade&#39;</span><span class="p">],</span>
             <span class="n">toproles_decade_gender</span><span class="p">[</span><span class="n">toproles_decade_gender</span><span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;Count_m&#39;</span><span class="p">],</span> 
             <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Males&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1"> count by demi-decade, Males and Females&#39;</span><span class="p">,</span> <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1975</span><span class="p">,</span> <span class="mi">2010</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;75-79&#39;</span><span class="p">,</span> <span class="s1">&#39;80-84&#39;</span><span class="p">,</span><span class="s1">&#39;85-89&#39;</span><span class="p">,</span> <span class="s1">&#39;90-94&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;95-99&#39;</span><span class="p">,</span> <span class="s1">&#39;00-04&#39;</span><span class="p">,</span><span class="s1">&#39;05-09&#39;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/CircusOzEDA_35_0.png" src="_images/CircusOzEDA_35_0.png" />
<img alt="_images/CircusOzEDA_35_1.png" src="_images/CircusOzEDA_35_1.png" />
<img alt="_images/CircusOzEDA_35_2.png" src="_images/CircusOzEDA_35_2.png" />
<img alt="_images/CircusOzEDA_35_3.png" src="_images/CircusOzEDA_35_3.png" />
<img alt="_images/CircusOzEDA_35_4.png" src="_images/CircusOzEDA_35_4.png" />
<img alt="_images/CircusOzEDA_35_5.png" src="_images/CircusOzEDA_35_5.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">toproles_decade_gender</span><span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">toproles_decade_gender</span><span class="p">[</span><span class="n">toproles_decade_gender</span><span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;Decade&#39;</span><span class="p">],</span>
             <span class="n">toproles_decade_gender</span><span class="p">[</span><span class="n">toproles_decade_gender</span><span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;Proportion_f&#39;</span><span class="p">],</span> 
             <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Females&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">toproles_decade_gender</span><span class="p">[</span><span class="n">toproles_decade_gender</span><span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;Decade&#39;</span><span class="p">],</span>
             <span class="n">toproles_decade_gender</span><span class="p">[</span><span class="n">toproles_decade_gender</span><span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;Proportion_m&#39;</span><span class="p">],</span> 
             <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Males&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1"> count by demi-decade, Males and Females&#39;</span><span class="p">,</span> <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1975</span><span class="p">,</span> <span class="mi">2010</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;75-79&#39;</span><span class="p">,</span> <span class="s1">&#39;80-84&#39;</span><span class="p">,</span><span class="s1">&#39;85-89&#39;</span><span class="p">,</span> <span class="s1">&#39;90-94&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;95-99&#39;</span><span class="p">,</span> <span class="s1">&#39;00-04&#39;</span><span class="p">,</span><span class="s1">&#39;05-09&#39;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/CircusOzEDA_36_0.png" src="_images/CircusOzEDA_36_0.png" />
<img alt="_images/CircusOzEDA_36_1.png" src="_images/CircusOzEDA_36_1.png" />
<img alt="_images/CircusOzEDA_36_2.png" src="_images/CircusOzEDA_36_2.png" />
<img alt="_images/CircusOzEDA_36_3.png" src="_images/CircusOzEDA_36_3.png" />
<img alt="_images/CircusOzEDA_36_4.png" src="_images/CircusOzEDA_36_4.png" />
<img alt="_images/CircusOzEDA_36_5.png" src="_images/CircusOzEDA_36_5.png" />
</div>
</div>
</div>
<div class="section" id="association-rule-mining-cont">
<h3>Association Rule Mining (cont.)<a class="headerlink" href="#association-rule-mining-cont" title="Permalink to this headline">¶</a></h3>
<p>We now review association rules across time and gender. For each generated rule, we calculated the difference of the <strong>confidence</strong> of said rule for <code class="docutils literal notranslate"><span class="pre">Males</span></code> with the <strong>confidence</strong> of the same rule for <code class="docutils literal notranslate"><span class="pre">Females</span></code> for each given five-year period.</p>
<p>Positive differences indicate that the rule occurs more often for <code class="docutils literal notranslate"><span class="pre">Males</span></code> while negative differences indicate that the rule occurs more often for <code class="docutils literal notranslate"><span class="pre">Females</span></code>. We then sorted the differences by its absolute value and inspected the most significant rules visually (see coloured time series plot).</p>
<p>The table below highlights association rule differences of more than 20%. We provide some examples of how one might interpret these rule differences highlighted in the column <code class="docutils literal notranslate"><span class="pre">Male-Female</span> <span class="pre">difference</span></code>.
<br></p>
<ul class="simple">
<li><p>Example (1): <code class="docutils literal notranslate"><span class="pre">Females</span></code> who are <code class="docutils literal notranslate"><span class="pre">Musicians</span></code> (see antecedents) are 35.9% more likely than <code class="docutils literal notranslate"><span class="pre">Males</span></code> to also be a <code class="docutils literal notranslate"><span class="pre">Performer</span></code> (see consequents) in 85-89 period.</p></li>
<li><p>Example (2): <code class="docutils literal notranslate"><span class="pre">Females</span></code> who are <code class="docutils literal notranslate"><span class="pre">Musicians</span></code> are 28.2% more likely than <code class="docutils literal notranslate"><span class="pre">Males</span></code> to also be a <code class="docutils literal notranslate"><span class="pre">KeyCreative</span></code> in 85-89 period.</p></li>
<li><p>Example (3): <code class="docutils literal notranslate"><span class="pre">Males</span></code> who are <code class="docutils literal notranslate"><span class="pre">Subsidiaries</span></code> are 27.9% more likely than <code class="docutils literal notranslate"><span class="pre">Females</span></code> to also be a <code class="docutils literal notranslate"><span class="pre">Performer</span></code> in 00-04 period.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.float_format&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>

<span class="n">supports</span> <span class="o">=</span> <span class="n">supports_decade</span><span class="p">[[</span><span class="s1">&#39;antecedents&#39;</span><span class="p">,</span><span class="s1">&#39;consequents&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;support_x&#39;</span><span class="p">,</span><span class="s1">&#39;support_y&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;confidence_x&#39;</span><span class="p">,</span><span class="s1">&#39;confidence_y&#39;</span><span class="p">,</span><span class="s1">&#39;Decade&#39;</span><span class="p">]]</span>
<span class="n">supports</span><span class="p">[</span><span class="s1">&#39;Male-Female difference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">supports</span><span class="p">[</span><span class="s1">&#39;confidence_x&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">supports</span><span class="p">[</span><span class="s1">&#39;confidence_y&#39;</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">supports</span><span class="p">[</span><span class="s1">&#39;diff_abs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">supports</span><span class="p">[</span><span class="s1">&#39;Male-Female difference&#39;</span><span class="p">])</span>
<span class="n">supports_shrt</span> <span class="o">=</span> <span class="n">supports</span><span class="p">[</span><span class="n">supports</span><span class="p">[</span><span class="s1">&#39;diff_abs&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;diff_abs&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">supports_shrt</span><span class="p">[[</span><span class="s1">&#39;antecedents&#39;</span><span class="p">,</span><span class="s1">&#39;consequents&#39;</span><span class="p">,</span><span class="s1">&#39;Decade&#39;</span><span class="p">,</span><span class="s1">&#39;Male-Female difference&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>antecedents</th>
      <th>consequents</th>
      <th>Decade</th>
      <th>Male-Female difference</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9</th>
      <td>(Musician)</td>
      <td>(Performer)</td>
      <td>1985</td>
      <td>-35.897</td>
    </tr>
    <tr>
      <th>5</th>
      <td>(Musician)</td>
      <td>(KeyCreative)</td>
      <td>1985</td>
      <td>-28.205</td>
    </tr>
    <tr>
      <th>8</th>
      <td>(Subsidiary)</td>
      <td>(Performer)</td>
      <td>2000</td>
      <td>27.871</td>
    </tr>
    <tr>
      <th>1</th>
      <td>(Musician)</td>
      <td>(Performer)</td>
      <td>1975</td>
      <td>26.923</td>
    </tr>
    <tr>
      <th>2</th>
      <td>(KeyCreative)</td>
      <td>(Performer)</td>
      <td>1995</td>
      <td>23.921</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.ticker</span> <span class="k">as</span> <span class="nn">mtick</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">this_pair</span> <span class="o">=</span> <span class="n">supports</span><span class="p">[(</span><span class="n">supports</span><span class="o">.</span><span class="n">antecedents</span> <span class="o">==</span> <span class="nb">frozenset</span><span class="p">({</span><span class="s1">&#39;Musician&#39;</span><span class="p">}))</span> <span class="o">&amp;</span> 
             <span class="p">(</span><span class="n">supports</span><span class="o">.</span><span class="n">consequents</span> <span class="o">==</span> <span class="nb">frozenset</span><span class="p">({</span><span class="s1">&#39;Performer&#39;</span><span class="p">}))]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">this_pair</span><span class="p">[</span><span class="s1">&#39;Decade&#39;</span><span class="p">],</span> <span class="n">this_pair</span><span class="p">[</span><span class="s1">&#39;Male-Female difference&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> 
         <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Musician-Performer&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">this_pair</span> <span class="o">=</span> <span class="n">supports</span><span class="p">[(</span><span class="n">supports</span><span class="o">.</span><span class="n">antecedents</span> <span class="o">==</span> <span class="nb">frozenset</span><span class="p">({</span><span class="s1">&#39;Musician&#39;</span><span class="p">}))</span> <span class="o">&amp;</span> 
             <span class="p">(</span><span class="n">supports</span><span class="o">.</span><span class="n">consequents</span> <span class="o">==</span> <span class="nb">frozenset</span><span class="p">({</span><span class="s1">&#39;KeyCreative&#39;</span><span class="p">}))]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">this_pair</span><span class="p">[</span><span class="s1">&#39;Decade&#39;</span><span class="p">],</span> <span class="n">this_pair</span><span class="p">[</span><span class="s1">&#39;Male-Female difference&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> 
         <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Musician-KeyCreative&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">this_pair</span> <span class="o">=</span> <span class="n">supports</span><span class="p">[(</span><span class="n">supports</span><span class="o">.</span><span class="n">antecedents</span> <span class="o">==</span> <span class="nb">frozenset</span><span class="p">({</span><span class="s1">&#39;Subsidiary&#39;</span><span class="p">}))</span> <span class="o">&amp;</span> 
             <span class="p">(</span><span class="n">supports</span><span class="o">.</span><span class="n">consequents</span> <span class="o">==</span> <span class="nb">frozenset</span><span class="p">({</span><span class="s1">&#39;Performer&#39;</span><span class="p">}))]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">this_pair</span><span class="p">[</span><span class="s1">&#39;Decade&#39;</span><span class="p">],</span> <span class="n">this_pair</span><span class="p">[</span><span class="s1">&#39;Male-Female difference&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> 
         <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Subsidiary-Performer&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">this_pair</span> <span class="o">=</span> <span class="n">supports</span><span class="p">[(</span><span class="n">supports</span><span class="o">.</span><span class="n">antecedents</span> <span class="o">==</span> <span class="nb">frozenset</span><span class="p">({</span><span class="s1">&#39;KeyCreative&#39;</span><span class="p">}))</span> <span class="o">&amp;</span> 
             <span class="p">(</span><span class="n">supports</span><span class="o">.</span><span class="n">consequents</span> <span class="o">==</span> <span class="nb">frozenset</span><span class="p">({</span><span class="s1">&#39;Performer&#39;</span><span class="p">}))]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">this_pair</span><span class="p">[</span><span class="s1">&#39;Decade&#39;</span><span class="p">],</span> <span class="n">this_pair</span><span class="p">[</span><span class="s1">&#39;Male-Female difference&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> 
         <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:purple&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;KeyCreative-Performer&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">this_pair</span> <span class="o">=</span> <span class="n">supports</span><span class="p">[(</span><span class="n">supports</span><span class="o">.</span><span class="n">antecedents</span> <span class="o">==</span> <span class="nb">frozenset</span><span class="p">({</span><span class="s1">&#39;Crew&#39;</span><span class="p">}))</span> <span class="o">&amp;</span> 
             <span class="p">(</span><span class="n">supports</span><span class="o">.</span><span class="n">consequents</span> <span class="o">==</span> <span class="nb">frozenset</span><span class="p">({</span><span class="s1">&#39;KeyCreative&#39;</span><span class="p">}))]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">this_pair</span><span class="p">[</span><span class="s1">&#39;Decade&#39;</span><span class="p">],</span> <span class="n">this_pair</span><span class="p">[</span><span class="s1">&#39;Male-Female difference&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> 
         <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Crew-KeyCreative&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Most significant Male-Female differences for role pairings&#39;</span><span class="p">,</span>
         <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=-</span><span class="mi">20</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=-</span><span class="mi">30</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>


<span class="c1"># adjust legend</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mtick</span><span class="o">.</span><span class="n">PercentFormatter</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1975</span><span class="p">,</span> <span class="mi">2010</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;75-79&#39;</span><span class="p">,</span> <span class="s1">&#39;80-84&#39;</span><span class="p">,</span><span class="s1">&#39;85-89&#39;</span><span class="p">,</span> <span class="s1">&#39;90-94&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;95-99&#39;</span><span class="p">,</span> <span class="s1">&#39;00-04&#39;</span><span class="p">,</span><span class="s1">&#39;05-09&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/CircusOzEDA_39_0.png" src="_images/CircusOzEDA_39_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="network-graphs">
<h2>Network graphs<a class="headerlink" href="#network-graphs" title="Permalink to this headline">¶</a></h2>
<p>Lastly, we developed an interactive tool to assist in drilling down into influential people and roles across any given period of time.</p>
<p><strong>Instructions</strong></p>
<ol class="simple">
<li><p>Choose years to establish the start and end period. These values are inclusive. We also provide the option to include roles listed as <code class="docutils literal notranslate"><span class="pre">Injured</span></code>.</p></li>
<li><p>Press the <code class="docutils literal notranslate"><span class="pre">Generate</span> <span class="pre">network</span> <span class="pre">graph</span></code> button, this will load a network graph along with the top 3 association rules for the selected time period. <em>Note that the network graph will take longer to load if the time period is large i.e., can take up 90 seconds to load for all data.</em></p></li>
<li><p>You can zoom in/out, drag nodes, highlight node neighbours by clicking, hover over nodes for more info and highlight nodes using the filter on the top left. The filter lists all the roles first and then lists each relevant node in order of its participation rate for the given period.</p></li>
<li><p>If you want to make any changes to the time period (or include <code class="docutils literal notranslate"><span class="pre">Injured</span></code>), you will need to press the <code class="docutils literal notranslate"><span class="pre">Generate</span> <span class="pre">network</span> <span class="pre">graph</span></code> button again to generate a new network graph along with corresponding association rules.</p></li>
</ol>
<p><strong>Legend</strong></p>
<ul class="simple">
<li><p>Blue nodes represent <code class="docutils literal notranslate"><span class="pre">Male</span></code> participants.</p></li>
<li><p>Orange nodes represent <code class="docutils literal notranslate"><span class="pre">Female</span></code> participants.</p></li>
<li><p>Red nodes represent <code class="docutils literal notranslate"><span class="pre">0</span></code> participants.</p></li>
<li><p>Green nodes represent roles i.e., <code class="docutils literal notranslate"><span class="pre">Musician</span></code>, <code class="docutils literal notranslate"><span class="pre">Performer</span></code>, etc.</p></li>
<li><p>Edges represent an occurence in the given time period - they are uniformally weighted.</p></li>
<li><p>The size of a participant node corresponds with the number of participated events in the given time period. This frequency can be obtained by hovering over the node.</p></li>
</ul>
<p><em>It should be noted that association rules are only generated if rules are relatively significant - in cases where there are no rules, the output will flag an error.</em></p>
<iframe height="1100" width="800" frameborder="no" src="https://acd-engine.shinyapps.io/CircusOzApp/"> </iframe></div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="DAQA%20Workshop.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">DAQA Workshop</p>
        </div>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Justin Munoz<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>