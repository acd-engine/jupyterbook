
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DAQA: Extended analysis</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystyles.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="DAQA: Preliminary analysis" href="Analysis_DAQA_Part1.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-R8Q003ZY5N"></script>
<script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('js', new Date());
                    gtag('config', 'G-R8Q003ZY5N');
                </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/ACDElogo.png" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="about.html">
   About
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Data infrastructure and integration
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Integration_Introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="Integration_Architecture.html">
   Australian Cultural Data Engine Architecture
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Integration_ACDEA_Overview.html">
     Overview of the Australian Cultural Data Engine Architecture
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Integration_ACDEA_Construction.html">
     Construction Workflow
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Integration_ACDEA_DataReport.html">
     Data Report
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Integration_ACDEA_SpecialConsiderations.html">
     Special Considerations for Data Analysis
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="Integration_DataSources.html">
   Data Sources
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Integration_DataSources_AusStage.html">
     The Australian Live Performance Database
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Integration_DataSources_CircusOz.html">
     The Circus Oz Living Archive collection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Integration_DataSources_DAAO.html">
     Design &amp; Art Australia Online
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Integration_DataSources_DAQA.html">
     Digital Archive of Queensland Architecture
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Integration_DataSources_SummerHayes.html">
     Summerhayes Family Collection
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Integration_Download.html">
   Integrated Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Integration_FutureWorks.html">
   Future Works
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Integration_Miscellaneous.html">
   More Interesting Works and Cultural Data Sources
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Data analysis
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Analysis_Introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Analysis_ArchibaldPrize.html">
   Quantifying success: A journey into the Archibald Prize
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Analysis_CircusOz.html">
   Beyond the Big Top: Exploring career trajectories at Circus Oz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Analysis_DAAO500.html">
   The DAAO 500
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Analysis_DAAOVenues.html">
   Natural language processing with DAAO
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Analysis_DAQA_Part1.html">
   DAQA: Preliminary analysis
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   DAQA: Extended analysis
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/Analysis_DAQA_Part2.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/acd-engine/jupyterbook"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/acd-engine/jupyterbook/issues/new?title=Issue%20on%20page%20%2FAnalysis_DAQA_Part2.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/acd-engine/jupyterbook/master?urlpath=tree/docs/Analysis_DAQA_Part2.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#projects-firms">
   Projects &amp; firms
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#top-five-firms-with-the-longest-timespan-with-successive-names-known-predecessor-firms">
     Top five firms with the longest timespan with successive names/known predecessor firms.
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#projects-by-completion-date">
     Projects by completion date
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#projects-and-firms">
     1940-1980 projects and firms
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#education">
   Education
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#queensland-universities">
     Queensland universities
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#uq">
       UQ
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#bctc">
       BCTC
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#qit">
       QIT
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#qut">
       QUT
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#visual-comparison">
       Visual comparison
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#education-by-period">
     Education by period
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#persons-with-related-works">
   Persons with related works
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#persons-with-related-works-1940-1980">
     Persons with related works (1940-1980)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#women-with-related-works">
     Women with related works
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#typologies">
   Typologies
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#typologies-1940-1980">
     Typologies (1940-1980)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#top-5-architects">
       Top 5 architects
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#top-5-firms">
       Top 5 firms
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#interviews">
   Interviews
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>DAQA: Extended analysis</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#projects-firms">
   Projects &amp; firms
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#top-five-firms-with-the-longest-timespan-with-successive-names-known-predecessor-firms">
     Top five firms with the longest timespan with successive names/known predecessor firms.
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#projects-by-completion-date">
     Projects by completion date
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#projects-and-firms">
     1940-1980 projects and firms
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#education">
   Education
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#queensland-universities">
     Queensland universities
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#uq">
       UQ
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#bctc">
       BCTC
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#qit">
       QIT
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#qut">
       QUT
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#visual-comparison">
       Visual comparison
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#education-by-period">
     Education by period
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#persons-with-related-works">
   Persons with related works
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#persons-with-related-works-1940-1980">
     Persons with related works (1940-1980)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#women-with-related-works">
     Women with related works
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#typologies">
   Typologies
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#typologies-1940-1980">
     Typologies (1940-1980)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#top-5-architects">
       Top 5 architects
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#top-5-firms">
       Top 5 firms
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#interviews">
   Interviews
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="section" id="daqa-extended-analysis">
<h1>DAQA: Extended analysis<a class="headerlink" href="#daqa-extended-analysis" title="Permalink to this headline">¶</a></h1>
<style>
  a {
    color: #1ea5a6 !important;
  }
</style>
<p>This analysis will answer the following questions…</p>
<p><strong>For the whole data set:</strong></p>
<ul class="simple">
<li><p>what % of projects have addresses?</p></li>
<li><p>what % of projects have completion dates?</p></li>
<li><p>what % of projects have associated firms but no architects?</p></li>
<li><p>what % of projects have associated architects but no firms?</p></li>
<li><p>what % of firms have ‘operating years’ recorded</p></li>
</ul>
<p><strong>Number of projects:</strong></p>
<ul class="simple">
<li><p>Before 1940</p></li>
<li><p>Between 1940-1980</p></li>
<li><p>Post 1980</p></li>
<li><p>Undated</p></li>
</ul>
<p><strong>For the 40-80 data set:</strong></p>
<ul class="simple">
<li><p>what % of projects have addresses?</p></li>
<li><p>what % of projects have completion dates?</p></li>
<li><p>what % of projects have associated firms but no architects?</p></li>
<li><p>what % of projects have associated architects but no firms?</p></li>
<li><p>what % of firms have ‘operating years’ recorded</p></li>
</ul>
<p><strong>Analytic questions:</strong></p>
<ul class="simple">
<li><p>UQ vs (BCTC, QIT, QUT) vs the rest for whole data, 1940-1980, and also 1940 to present.</p></li>
<li><p>Repeat ‘how many completed related to a person’. 1940-1980 and the Pareto distribution</p></li>
<li><p>Number completed projects 1940-80</p></li>
<li><p>Number of works by year, most active vs rest 1940-1980</p></li>
<li><p>what % of the different typologies 1940-1980</p></li>
<li><p>Number of works by year by typology</p></li>
<li><p>what % of projects extant/demolished/modified 1940-1980</p></li>
<li><p>average and mean number of employers of the DAQA interviewed architects</p></li>
<li><p>names of Architects associated with the highest number of projects 1940-1980</p></li>
<li><p>names of firms associated with the highest number of projects 1940-1980</p></li>
<li><p>names of top 5 Architects associated with the highest number of each typology 1940-1980</p></li>
<li><p>names of top 5  firms associated with the highest number of projects 1940-1980</p></li>
<li><p>what % of architects who are women associated with projects 1940-1975</p></li>
<li><p>what % of architects who are women associated with projects after 1975</p></li>
<li><p>5 Firms with the longest timespan with the same name.</p></li>
<li><p>5 Firms with the longest timespan with successive names/known predecessor firms.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span><span class="o">,</span> <span class="nn">gzip</span><span class="o">,</span> <span class="nn">io</span><span class="o">,</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">json</span>

<span class="c1"># for data mgmt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span> <span class="nn">ast</span>

<span class="c1"># for plotting</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="n">PercentFormatter</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">to_rgba</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>

<span class="c1"># for hypothesis testing</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2_contingency</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">pareto</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="c1"># provide folder_name which contains uncompressed data i.e., csv and jsonl files</span>
<span class="c1"># only need to change this if you have already downloaded data</span>
<span class="c1"># otherwise data will be fetched from google drive</span>
<span class="k">global</span> <span class="n">folder_name</span>
<span class="n">folder_name</span> <span class="o">=</span> <span class="s1">&#39;data/local&#39;</span>

<span class="k">def</span> <span class="nf">fetch_small_data_from_github</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://raw.githubusercontent.com/acd-engine/jupyterbook/master/data/analysis/</span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">rawdata</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">rawdata</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">check_if_csv_exists_in_folder</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span> <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder_name</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>

<span class="k">def</span> <span class="nf">fetch_data</span><span class="p">(</span><span class="n">filetype</span><span class="o">=</span><span class="s1">&#39;csv&#39;</span><span class="p">,</span> <span class="n">acdedata</span><span class="o">=</span><span class="s1">&#39;organization&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;googledrive&#39;</span><span class="p">):</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;acde_</span><span class="si">{</span><span class="n">acdedata</span><span class="si">}</span><span class="s1">_202305080816.</span><span class="si">{</span><span class="n">filetype</span><span class="si">}</span><span class="s1">&#39;</span>

    <span class="c1"># first check if the data exists in current directory</span>
    <span class="n">data_from_path</span> <span class="o">=</span> <span class="n">check_if_csv_exists_in_folder</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">data_from_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span> <span class="n">data_from_path</span>

    <span class="n">download_url</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">github_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://raw.githubusercontent.com/acd-engine/jupyterbook/master/data/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">.gz&quot;</span>

    <span class="k">if</span> <span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;googledrive&#39;</span><span class="p">:</span>
        <span class="n">urls</span> <span class="o">=</span> <span class="n">fetch_small_data_from_github</span><span class="p">(</span><span class="s1">&#39;acde_data_gdrive_urls.csv&#39;</span><span class="p">)</span>
        <span class="n">sharelink</span> <span class="o">=</span> <span class="n">urls</span><span class="p">[</span><span class="n">urls</span><span class="o">.</span><span class="n">data</span> <span class="o">==</span> <span class="n">acdedata</span><span class="p">][</span><span class="n">filetype</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;https://drive.google.com/u/0/uc?id=</span><span class="si">{</span><span class="n">sharelink</span><span class="si">}</span><span class="s1">&amp;export=download&amp;confirm=yes&#39;</span>

    <span class="k">elif</span> <span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;github&#39;</span><span class="p">:</span> <span class="n">url</span> <span class="o">=</span> <span class="n">github_url</span>
    <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>
    
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">sha</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;oid sha256:&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">size</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;size &#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># Step 1: Create the JSON object</span>
        <span class="n">json_data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;download&quot;</span><span class="p">,</span> <span class="s2">&quot;transfer&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;basic&quot;</span><span class="p">],</span> <span class="s2">&quot;objects&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;oid&quot;</span><span class="p">:</span> <span class="n">sha</span><span class="p">,</span> <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">size</span><span class="p">)}]}</span>

        <span class="c1"># Step 2: Send a POST request to the LFS API</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/acd-engine/jupyterbook.git/info/lfs/objects/batch&quot;</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Accept&quot;</span><span class="p">:</span> <span class="s2">&quot;application/vnd.git-lfs+json&quot;</span><span class="p">,</span><span class="s2">&quot;Content-type&quot;</span><span class="p">:</span> <span class="s2">&quot;application/json&quot;</span><span class="p">}</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">json_data</span><span class="p">))</span>
        <span class="n">response_json</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

        <span class="c1"># Step 3: Extract the download URL from the response</span>
        <span class="n">download_url</span> <span class="o">=</span> <span class="n">response_json</span><span class="p">[</span><span class="s2">&quot;objects&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;actions&quot;</span><span class="p">][</span><span class="s2">&quot;download&quot;</span><span class="p">][</span><span class="s2">&quot;href&quot;</span><span class="p">]</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">if</span> <span class="n">download_url</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">download_url</span><span class="p">)</span>

    <span class="n">decompressed_data</span> <span class="o">=</span> <span class="n">gzip</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
    <span class="n">decompressed_buffer</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">decompressed_data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">filetype</span> <span class="o">==</span> <span class="s1">&#39;csv&#39;</span><span class="p">:</span> <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">decompressed_buffer</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">df</span> <span class="o">=</span> <span class="p">[</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">jl</span><span class="p">)</span> <span class="k">for</span> <span class="n">jl</span> <span class="ow">in</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">decompressed_buffer</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;records&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span> <span class="k">return</span> <span class="kc">None</span> 

<span class="k">def</span> <span class="nf">fetch_all_DAQA_data</span><span class="p">():</span>
    <span class="n">daqa_data_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">entity</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;event&#39;</span><span class="p">,</span> <span class="s1">&#39;organization&#39;</span><span class="p">,</span> <span class="s1">&#39;person&#39;</span><span class="p">,</span> <span class="s1">&#39;place&#39;</span><span class="p">,</span> <span class="s1">&#39;recognition&#39;</span><span class="p">,</span> <span class="s1">&#39;resource&#39;</span><span class="p">,</span> <span class="s1">&#39;work&#39;</span><span class="p">]:</span>
        <span class="n">daqa_this_entity</span> <span class="o">=</span> <span class="n">fetch_data</span><span class="p">(</span><span class="n">acdedata</span><span class="o">=</span><span class="n">entity</span><span class="p">)</span>
        <span class="n">daqa_data_dict</span><span class="p">[</span><span class="n">entity</span><span class="p">]</span> <span class="o">=</span> <span class="n">daqa_this_entity</span><span class="p">[</span><span class="n">daqa_this_entity</span><span class="o">.</span><span class="n">data_source</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;DAQA&#39;</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">daqa_data_dict</span>

<span class="n">df_daqa_dict</span> <span class="o">=</span> <span class="n">fetch_all_DAQA_data</span><span class="p">()</span> <span class="c1"># 1 min if data is already downloaded</span>
<span class="n">daqa_work</span> <span class="o">=</span> <span class="n">df_daqa_dict</span><span class="p">[</span><span class="s1">&#39;work&#39;</span><span class="p">]</span>
<span class="n">daqa_persons</span> <span class="o">=</span> <span class="n">df_daqa_dict</span><span class="p">[</span><span class="s1">&#39;person&#39;</span><span class="p">]</span>
<span class="n">daqa_orgs</span> <span class="o">=</span> <span class="n">df_daqa_dict</span><span class="p">[</span><span class="s1">&#39;organization&#39;</span><span class="p">]</span>
<span class="n">daqa_resources</span> <span class="o">=</span> <span class="n">df_daqa_dict</span><span class="p">[</span><span class="s1">&#39;resource&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="projects-firms">
<h2>Projects &amp; firms<a class="headerlink" href="#projects-firms" title="Permalink to this headline">¶</a></h2>
<p>Below are some statistics about project characteristics and firms in the DAQA dataset. Proportions under the <code class="docutils literal notranslate"><span class="pre">PROJECTS</span></code> subheading are calculated as a percentage of the total number of projects in the dataset. Proportions under the <code class="docutils literal notranslate"><span class="pre">FIRMS</span></code> subheading are calculated as a percentage of the total number of firms in the dataset.</p>
<p>It should be noted that all people related to projects are architects, we found no non-architects in the project records. Also all organisations related to projects are firms, we found no non-firm organisations in the project records.</p>
<ul class="simple">
<li><p>We define a project with an address as one that has a populated <code class="docutils literal notranslate"><span class="pre">address</span></code> field</p></li>
<li><p>We define a project with a geocode date as one that has a populated <code class="docutils literal notranslate"><span class="pre">longitude</span></code> and <code class="docutils literal notranslate"><span class="pre">latitude</span></code> field</p></li>
<li><p>We define a project with a completion date as one that has a populated <code class="docutils literal notranslate"><span class="pre">completion</span> <span class="pre">year</span></code> field</p></li>
<li><p>We define a project with an associated firm as one that has a populated <code class="docutils literal notranslate"><span class="pre">related_organizations</span></code> field</p></li>
<li><p>We define a project with no associated firms as one that has a no populated <code class="docutils literal notranslate"><span class="pre">related</span> <span class="pre">organizations</span></code> field</p></li>
<li><p>We define a project with an associated architect as one that has a populated <code class="docutils literal notranslate"><span class="pre">related_people</span></code> field</p></li>
<li><p>We define a project with no associated architects as one that has no populated <code class="docutils literal notranslate"><span class="pre">related_people</span></code> field</p></li>
<li><p>We define a firm with operating years as an organisation that has a populated <code class="docutils literal notranslate"><span class="pre">operation</span></code> field</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;###################### PROJECTS ######################&#39;</span><span class="p">)</span>

<span class="c1"># load data</span>
<span class="n">daqa_work</span> <span class="o">=</span> <span class="n">df_daqa_dict</span><span class="p">[</span><span class="s1">&#39;work&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: How many projects are recorded in DAQA?&#39;</span><span class="p">)</span>
<span class="n">count_projects</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">daqa_work</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: There are </span><span class="si">{</span><span class="n">count_projects</span><span class="si">}</span><span class="s1"> projects in DAQA.&#39;</span><span class="p">)</span>

<span class="c1"># we define a project with an address as one that has a populated &quot;address&quot; field</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: what </span><span class="si">% o</span><span class="s1">f projects have addresses?&#39;</span><span class="p">)</span>
<span class="n">count_projects_with_address</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">daqa_work</span><span class="p">[</span><span class="n">daqa_work</span><span class="o">.</span><span class="n">coverage_range</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;address&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)])</span>
<span class="n">prop_projects_with_address</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">count_projects_with_address</span> <span class="o">/</span> <span class="n">count_projects</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: </span><span class="si">{</span><span class="n">prop_projects_with_address</span><span class="si">}</span><span class="s1">% (</span><span class="si">{</span><span class="n">count_projects_with_address</span><span class="si">}</span><span class="s1">) of DAQA projects have addresses.&#39;</span><span class="p">)</span>

<span class="c1"># we define a project with a geocode date as one that has a populated &quot;longitude&quot; field</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: what </span><span class="si">% o</span><span class="s1">f projects have geocodes (lat/long)?&#39;</span><span class="p">)</span>
<span class="n">count_projects_with_geocodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">daqa_work</span><span class="p">[</span><span class="n">daqa_work</span><span class="o">.</span><span class="n">coverage_range</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;latitude&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)])</span>
<span class="n">prop_projects_with_geocodes</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">count_projects_with_geocodes</span> <span class="o">/</span> <span class="n">count_projects</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: </span><span class="si">{</span><span class="n">prop_projects_with_geocodes</span><span class="si">}</span><span class="s1">% (</span><span class="si">{</span><span class="n">count_projects_with_geocodes</span><span class="si">}</span><span class="s1">) of DAQA projects have geocodes.&#39;</span><span class="p">)</span>

<span class="c1"># we define a project with a completion date as one that has a populated &quot;completion year&quot; field</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: what </span><span class="si">% o</span><span class="s1">f projects have completion dates?&#39;</span><span class="p">)</span>
<span class="n">count_projects_with_completion_dates</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">daqa_work</span><span class="p">[</span><span class="n">daqa_work</span><span class="o">.</span><span class="n">coverage_range</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;date_end&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)])</span>
<span class="n">prop_projects_with_completion_dates</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">count_projects_with_completion_dates</span> <span class="o">/</span> <span class="n">count_projects</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: </span><span class="si">{</span><span class="n">prop_projects_with_completion_dates</span><span class="si">}</span><span class="s1">% (</span><span class="si">{</span><span class="n">count_projects_with_completion_dates</span><span class="si">}</span><span class="s1">) of DAQA projects have completion dates.&#39;</span><span class="p">)</span>

<span class="c1"># we conduct a sanity check to see if related people in daqa_work are all architects, we find no non-architects</span>
<span class="c1"># # load data</span>
<span class="c1"># daqa_persons = df_daqa_dict[&#39;person&#39;]</span>
<span class="c1"># non_architects = daqa_persons[daqa_persons[&#39;longterm_roles&#39;].str.contains(&#39;non-architect&#39;)][&#39;ori_id&#39;].unique()</span>
<span class="c1"># len(daqa_work[daqa_work.related_people.apply(lambda x: pd.json_normalize(eval(x))[&#39;subject.ori_id&#39;].values[0] in non_architects if isinstance(x, str) else False)])</span>

<span class="c1"># we conduct a sanity check to see if related organisations in daqa_work are all firms, we find no non-firms</span>
<span class="c1"># count_related_organizations_firms = len(daqa_work[daqa_work.related_organizations.apply(lambda x: &quot;firm&quot; in x if isinstance(x, str) else False)])</span>
<span class="c1"># count_related_organizations = len(daqa_work[daqa_work.related_organizations.notnull()])</span>
<span class="c1"># count_related_organizations_firms == count_related_organizations</span>

<span class="c1"># we define a project with an associated firm as one that has a populated &quot;related_organizations&quot; field</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: how many projects have associated firms?&#39;</span><span class="p">)</span>
<span class="n">count_projects_with_firms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">daqa_work</span><span class="p">[</span><span class="n">daqa_work</span><span class="o">.</span><span class="n">related_organizations</span><span class="o">.</span><span class="n">notnull</span><span class="p">()])</span>
<span class="n">prop_projects_with_firms</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">count_projects_with_firms</span> <span class="o">/</span> <span class="n">count_projects</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: </span><span class="si">{</span><span class="n">prop_projects_with_firms</span><span class="si">}</span><span class="s1">% (</span><span class="si">{</span><span class="n">count_projects_with_firms</span><span class="si">}</span><span class="s1">) of DAQA projects have associated firms.&#39;</span><span class="p">)</span>

<span class="c1"># we define a project with no associated architects as one that has no populated &quot;related_people&quot; field</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: what </span><span class="si">% o</span><span class="s1">f projects have associated firms but no architects?&#39;</span><span class="p">)</span>
<span class="n">count_projects_with_firms_no_architects</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">daqa_work</span><span class="p">[(</span><span class="n">daqa_work</span><span class="o">.</span><span class="n">related_organizations</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span> <span class="o">&amp;</span>\
                                                        <span class="p">(</span><span class="n">daqa_work</span><span class="o">.</span><span class="n">related_people</span><span class="o">.</span><span class="n">isnull</span><span class="p">())])</span>
<span class="n">prop_projects_with_firms_no_architects</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">count_projects_with_firms_no_architects</span> <span class="o">/</span> <span class="n">count_projects</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: </span><span class="si">{</span><span class="n">prop_projects_with_firms_no_architects</span><span class="si">}</span><span class="s1">% (</span><span class="si">{</span><span class="n">count_projects_with_firms_no_architects</span><span class="si">}</span><span class="s1">) of DAQA projects have associated firms but no architects.&#39;</span><span class="p">)</span>

<span class="c1"># we define a project with an associated architect as one that has a populated &quot;related_people&quot; field</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: how many projects have associated architects?&#39;</span><span class="p">)</span>
<span class="n">count_projects_with_architects</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">daqa_work</span><span class="p">[</span><span class="n">daqa_work</span><span class="o">.</span><span class="n">related_people</span><span class="o">.</span><span class="n">notnull</span><span class="p">()])</span>
<span class="n">prop_projects_with_architects</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">count_projects_with_architects</span> <span class="o">/</span> <span class="n">count_projects</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: </span><span class="si">{</span><span class="n">prop_projects_with_architects</span><span class="si">}</span><span class="s1">% (</span><span class="si">{</span><span class="n">count_projects_with_architects</span><span class="si">}</span><span class="s1">) of DAQA projects have associated architects.&#39;</span><span class="p">)</span>

<span class="c1"># we define a project with an associated architects as one that has a populated &quot;related people&quot; field</span>
<span class="c1"># and we define a project with no associated firms as one that has a no populated &quot;related organizations&quot; field</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: what </span><span class="si">% o</span><span class="s1">f projects have associated architects but no firms?&#39;</span><span class="p">)</span>
<span class="n">count_projects_with_architects_no_firms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">daqa_work</span><span class="p">[(</span><span class="n">daqa_work</span><span class="o">.</span><span class="n">related_organizations</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span> <span class="o">&amp;</span>\
                                                        <span class="p">(</span><span class="n">daqa_work</span><span class="o">.</span><span class="n">related_people</span><span class="o">.</span><span class="n">notnull</span><span class="p">())])</span>
<span class="n">prop_projects_with_architects_no_firms</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">count_projects_with_architects_no_firms</span> <span class="o">/</span> <span class="n">count_projects</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: </span><span class="si">{</span><span class="n">prop_projects_with_architects_no_firms</span><span class="si">}</span><span class="s1">% (</span><span class="si">{</span><span class="n">count_projects_with_architects_no_firms</span><span class="si">}</span><span class="s1">) of DAQA projects have associated architects but no firms.&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">###################### FIRMS ######################&#39;</span><span class="p">)</span>

<span class="c1"># load data</span>
<span class="n">daqa_orgs</span> <span class="o">=</span> <span class="n">df_daqa_dict</span><span class="p">[</span><span class="s1">&#39;organization&#39;</span><span class="p">]</span>
<span class="n">daqa_firms</span> <span class="o">=</span> <span class="n">daqa_orgs</span><span class="p">[</span><span class="n">daqa_orgs</span><span class="p">[</span><span class="s1">&#39;_class_ori&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;firm&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: How many firms are recorded in DAQA?&#39;</span><span class="p">)</span>
<span class="n">count_firms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">daqa_firms</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: There are </span><span class="si">{</span><span class="n">count_firms</span><span class="si">}</span><span class="s1"> firms in DAQA.&#39;</span><span class="p">)</span>

<span class="c1"># we define an operating firm as an organisation that has a populated &quot;operation&quot; field with a start date</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: what </span><span class="si">% o</span><span class="s1">f firms have ‘operating years’ recorded (just start)?&#39;</span><span class="p">)</span>
<span class="n">count_firms_with_operating_start</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">daqa_firms</span><span class="p">[</span><span class="n">daqa_firms</span><span class="o">.</span><span class="n">operation</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;date_start&quot;</span> <span class="ow">in</span> <span class="n">x</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="kc">False</span><span class="p">)])</span>
<span class="n">prop_firms_with_operating_start</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">count_firms_with_operating_start</span> <span class="o">/</span> <span class="n">count_firms</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: </span><span class="si">{</span><span class="n">prop_firms_with_operating_start</span><span class="si">}</span><span class="s1">% (</span><span class="si">{</span><span class="n">count_firms_with_operating_start</span><span class="si">}</span><span class="s1">) of DAQA firms have operating years recorded.&#39;</span><span class="p">)</span>

<span class="c1"># we define an operating firm as an organisation that has a populated &quot;operation&quot; field with start and end dates</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: what </span><span class="si">% o</span><span class="s1">f firms have ‘operating years’ recorded (start and end)?&#39;</span><span class="p">)</span>
<span class="n">count_firms_with_operating_years</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">daqa_firms</span><span class="p">[</span><span class="n">daqa_firms</span><span class="o">.</span><span class="n">operation</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;date_start&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="s2">&quot;date_end&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="kc">False</span><span class="p">)])</span>
<span class="n">prop_firms_with_operating_years</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">count_firms_with_operating_years</span> <span class="o">/</span> <span class="n">count_firms</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: </span><span class="si">{</span><span class="n">prop_firms_with_operating_years</span><span class="si">}</span><span class="s1">% (</span><span class="si">{</span><span class="n">count_firms_with_operating_years</span><span class="si">}</span><span class="s1">) of DAQA firms have operating years recorded.&#39;</span><span class="p">)</span>

<span class="c1"># top 5 firms - longest timespan </span>
<span class="n">daqa_firms_with_op_yrs</span> <span class="o">=</span> <span class="n">daqa_firms</span><span class="p">[</span><span class="n">daqa_firms</span><span class="o">.</span><span class="n">operation</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;date_start&quot;</span> <span class="ow">in</span> <span class="n">x</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="kc">False</span><span class="p">)]</span>

<span class="c1"># extract the start and end years from the &quot;operation&quot; field</span>
<span class="n">start_dates</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">end_dates</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">daqa_firms_with_op_yrs</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">start_dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;operation&#39;</span><span class="p">]))[</span><span class="s1">&#39;date_start.year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

    <span class="k">try</span><span class="p">:</span> <span class="n">end_dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;operation&#39;</span><span class="p">]))[</span><span class="s1">&#39;date_end.year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="k">except</span><span class="p">:</span> <span class="n">end_dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<span class="n">daqa_firms_with_op_yrs</span><span class="p">[</span><span class="s1">&#39;start_yr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">start_dates</span>
<span class="n">daqa_firms_with_op_yrs</span><span class="p">[</span><span class="s1">&#39;end_yr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">end_dates</span>
<span class="n">daqa_firms_with_op_yrs</span><span class="p">[</span><span class="s1">&#39;diff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">daqa_firms_with_op_yrs</span><span class="p">[</span><span class="s1">&#39;end_yr&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">daqa_firms_with_op_yrs</span><span class="p">[</span><span class="s1">&#39;start_yr&#39;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: What are the top five firms with the longest timespan with the same name? (must have operating start and end years)&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">daqa_firms_with_op_yrs</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)[[</span><span class="s1">&#39;primary_name&#39;</span><span class="p">,</span> <span class="s1">&#39;start_yr&#39;</span><span class="p">,</span> <span class="s1">&#39;end_yr&#39;</span><span class="p">,</span> <span class="s1">&#39;diff&#39;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>###################### PROJECTS ######################

Q: How many projects are recorded in DAQA?
A: There are 2203 projects in DAQA.

Q: what % of projects have addresses?
A: 84.29% (1857) of DAQA projects have addresses.

Q: what % of projects have geocodes (lat/long)?
A: 65.68% (1447) of DAQA projects have geocodes.

Q: what % of projects have completion dates?
A: 60.37% (1330) of DAQA projects have completion dates.

Q: how many projects have associated firms?
A: 58.87% (1297) of DAQA projects have associated firms.

Q: what % of projects have associated firms but no architects?
A: 14.21% (313) of DAQA projects have associated firms but no architects.

Q: how many projects have associated architects?
A: 81.03% (1785) of DAQA projects have associated architects.

Q: what % of projects have associated architects but no firms?
A: 36.36% (801) of DAQA projects have associated architects but no firms.

###################### FIRMS ######################

Q: How many firms are recorded in DAQA?
A: There are 907 firms in DAQA.

Q: what % of firms have ‘operating years’ recorded (just start)?
A: 79.93% (725) of DAQA firms have operating years recorded.

Q: what % of firms have ‘operating years’ recorded (start and end)?
A: 39.69% (360) of DAQA firms have operating years recorded.

Q: What are the top five firms with the longest timespan with the same name? (must have operating start and end years)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>primary_name</th>
      <th>start_yr</th>
      <th>end_yr</th>
      <th>diff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>400</th>
      <td>"Evans Deakin &amp; Company (Engineers &amp; Shipbuild...</td>
      <td>1910</td>
      <td>1980.0</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>771</th>
      <td>"Bates Smart &amp; McCutcheon"</td>
      <td>1926</td>
      <td>1995.0</td>
      <td>69.0</td>
    </tr>
    <tr>
      <th>342</th>
      <td>"Brown and Broad LTD"</td>
      <td>1905</td>
      <td>1967.0</td>
      <td>62.0</td>
    </tr>
    <tr>
      <th>86</th>
      <td>"Queensland Housing Commission"</td>
      <td>1945</td>
      <td>2004.0</td>
      <td>59.0</td>
    </tr>
    <tr>
      <th>341</th>
      <td>"George Brockwell Gill Architect and Agent"</td>
      <td>1889</td>
      <td>1943.0</td>
      <td>54.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="top-five-firms-with-the-longest-timespan-with-successive-names-known-predecessor-firms">
<h3>Top five firms with the longest timespan with successive names/known predecessor firms.<a class="headerlink" href="#top-five-firms-with-the-longest-timespan-with-successive-names-known-predecessor-firms" title="Permalink to this headline">¶</a></h3>
<p>We inspect the top five firms with the longest timespan with successive names/known predecessor firms. We use network graphs to visualise the predecessor/successor relationships between firms. The graphs are interactive, so you can click on the nodes to see the firm names and the years they were active.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">daqa_firms_with_related_orgs</span> <span class="o">=</span> <span class="n">daqa_firms</span><span class="p">[</span><span class="n">daqa_firms</span><span class="o">.</span><span class="n">related_organizations</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span>

<span class="n">related_orgs_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">daqa_firms_with_related_orgs</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">this_row_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ori_id&#39;</span><span class="p">])</span>
    <span class="n">this_org_related</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;related_organizations&#39;</span><span class="p">]))</span>
    <span class="n">related_orgs_df</span> <span class="o">=</span> <span class="n">related_orgs_df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_org_related</span><span class="p">)</span>

<span class="n">related_orgs_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">related_orgs_df</span> <span class="o">=</span> <span class="n">related_orgs_df</span><span class="p">[</span><span class="n">related_orgs_df</span><span class="p">[</span><span class="s1">&#39;predicate.term&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;succeededby&#39;</span><span class="p">,</span> <span class="s1">&#39;PrecededBy&#39;</span><span class="p">,</span><span class="s1">&#39;MergedWith&#39;</span><span class="p">])]</span>
<span class="n">related_orgs_ls</span> <span class="o">=</span> <span class="n">related_orgs_df</span><span class="p">[[</span><span class="s1">&#39;subject.ori_id&#39;</span><span class="p">,</span><span class="s1">&#39;object.ori_id&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">get_connected_nodes</span><span class="p">(</span><span class="n">snapshot</span><span class="p">):</span>
    <span class="n">connected_nodes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">node_list</span> <span class="ow">in</span> <span class="n">snapshot</span><span class="p">:</span>
        <span class="n">connected_node_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">node_list</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">connected_node</span> <span class="ow">in</span> <span class="n">connected_nodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">connected_node</span> <span class="o">&amp;</span> <span class="n">connected_node_set</span><span class="p">:</span>
                <span class="n">connected_node</span> <span class="o">|=</span> <span class="n">connected_node_set</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">connected_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">connected_node_set</span><span class="p">)</span>
    
    <span class="n">connected_node_lists</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">connected_node</span><span class="p">)</span> <span class="k">for</span> <span class="n">connected_node</span> <span class="ow">in</span> <span class="n">connected_nodes</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">connected_node_lists</span>

<span class="n">connected_node_lists</span> <span class="o">=</span> <span class="n">get_connected_nodes</span><span class="p">(</span><span class="n">related_orgs_ls</span><span class="p">)</span>
<span class="n">connected_node_lists</span> <span class="o">=</span> <span class="n">get_connected_nodes</span><span class="p">(</span><span class="n">connected_node_lists</span><span class="p">)</span>
<span class="n">connected_node_lists</span> <span class="o">=</span> <span class="n">get_connected_nodes</span><span class="p">(</span><span class="n">connected_node_lists</span><span class="p">)</span>

<span class="n">first_date</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">last_date</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">nodes</span> <span class="ow">in</span> <span class="n">connected_node_lists</span><span class="p">[</span><span class="mi">0</span><span class="p">:]:</span>
    <span class="n">this_nodes</span> <span class="o">=</span> <span class="n">daqa_firms_with_op_yrs</span><span class="p">[</span><span class="n">daqa_firms_with_op_yrs</span><span class="p">[</span><span class="s1">&#39;ori_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">nodes</span><span class="p">)]</span>
    <span class="n">all_dates</span> <span class="o">=</span> <span class="n">this_nodes</span><span class="p">[</span><span class="s1">&#39;start_yr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
    <span class="n">all_dates</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">this_nodes</span><span class="p">[</span><span class="s1">&#39;start_yr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_dates</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">first_date</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">all_dates</span><span class="p">))</span>
        <span class="n">last_date</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">all_dates</span><span class="p">))</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">first_date</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">last_date</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>


<span class="c1"># dates</span>
<span class="n">dts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">first_date</span><span class="p">,</span> <span class="n">last_date</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>

<span class="c1"># add nodes as column</span>
<span class="n">dts</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;first_date&#39;</span><span class="p">,</span> <span class="s1">&#39;last_date&#39;</span><span class="p">]</span>
<span class="n">dts</span><span class="p">[</span><span class="s1">&#39;nodes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">connected_node_lists</span>
<span class="n">dts</span><span class="p">[</span><span class="s1">&#39;diff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dts</span><span class="p">[</span><span class="s1">&#39;last_date&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">dts</span><span class="p">[</span><span class="s1">&#39;first_date&#39;</span><span class="p">]</span>

<span class="n">display</span><span class="p">(</span><span class="n">dts</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>first_date</th>
      <th>last_date</th>
      <th>nodes</th>
      <th>diff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>61</th>
      <td>1862</td>
      <td>1967</td>
      <td>[4795, 3838, 3846]</td>
      <td>105</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1893</td>
      <td>1995</td>
      <td>[2310, 2446, 2447, 2449, 4628, 2456, 2338, 502...</td>
      <td>102</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1864</td>
      <td>1963</td>
      <td>[5033, 2387, 2356, 2457, 4890, 4891, 4892, 4286]</td>
      <td>99</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1926</td>
      <td>2010</td>
      <td>[4576, 2497, 3868, 2440, 4459, 4460, 2445, 446...</td>
      <td>84</td>
    </tr>
    <tr>
      <th>28</th>
      <td>1938</td>
      <td>2002</td>
      <td>[2336, 4994, 2501, 4511, 2413, 2478, 4527, 363...</td>
      <td>64</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p></br>Firm 1 (105 years)</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">output_graph</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">iteration</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
    <span class="kn">from</span> <span class="nn">pyvis</span> <span class="kn">import</span> <span class="n">network</span> <span class="k">as</span> <span class="n">net</span>

    <span class="n">g</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">Network</span><span class="p">(</span><span class="n">notebook</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                    <span class="n">height</span><span class="o">=</span><span class="s1">&#39;500px&#39;</span><span class="p">,</span>
                    <span class="n">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">,</span>
                    <span class="n">cdn_resources</span> <span class="o">=</span> <span class="s1">&#39;remote&#39;</span><span class="p">,</span> 
                    <span class="n">select_menu</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">related_orgs_df</span><span class="p">[</span><span class="n">related_orgs_df</span><span class="p">[</span><span class="s1">&#39;subject.ori_id&#39;</span><span class="p">]</span>\
                    <span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">dts</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>\
                        <span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">iteration</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">])][[</span><span class="s1">&#39;subject.label&#39;</span><span class="p">,</span><span class="s1">&#39;object.label&#39;</span><span class="p">,</span><span class="s1">&#39;predicate.term&#39;</span><span class="p">]]</span>

    <span class="n">dd</span> <span class="o">=</span> <span class="n">daqa_firms_with_op_yrs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">dd</span><span class="p">[</span><span class="s1">&#39;primary_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dd</span><span class="p">[</span><span class="s1">&#39;primary_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="c1"># Iterate over each row in the dataset</span>
    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">subject</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;subject.label&#39;</span><span class="p">]</span>
        <span class="n">predicate</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;predicate.term&#39;</span><span class="p">]</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;object.label&#39;</span><span class="p">]</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sub_start</span> <span class="o">=</span> <span class="n">dd</span><span class="p">[</span><span class="n">dd</span><span class="p">[</span><span class="s1">&#39;primary_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">subject</span><span class="p">)][</span><span class="s1">&#39;start_yr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">sub_end</span> <span class="o">=</span> <span class="n">dd</span><span class="p">[</span><span class="n">dd</span><span class="p">[</span><span class="s1">&#39;primary_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">subject</span><span class="p">)][</span><span class="s1">&#39;end_yr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">sub_start</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">sub_end</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">obj_start</span> <span class="o">=</span> <span class="n">dd</span><span class="p">[</span><span class="n">dd</span><span class="p">[</span><span class="s1">&#39;primary_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">obj</span><span class="p">)][</span><span class="s1">&#39;start_yr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">obj_end</span> <span class="o">=</span> <span class="n">dd</span><span class="p">[</span><span class="n">dd</span><span class="p">[</span><span class="s1">&#39;primary_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">obj</span><span class="p">)][</span><span class="s1">&#39;end_yr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">obj_start</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">obj_end</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">g</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">subject</span><span class="p">,</span> <span class="n">subject</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">subject</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">Start: </span><span class="si">{</span><span class="n">sub_start</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">End: </span><span class="si">{</span><span class="n">sub_end</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
        <span class="n">g</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">obj</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">Start: </span><span class="si">{</span><span class="n">obj_start</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">End: </span><span class="si">{</span><span class="n">obj_end</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

        <span class="c1"># Add edges to the graph based on the relationship type</span>
        <span class="k">if</span> <span class="n">predicate</span> <span class="o">==</span> <span class="s1">&#39;succeededby&#39;</span><span class="p">:</span>
            <span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">subject</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">predicate</span><span class="p">,</span> <span class="n">arrows</span><span class="o">=</span><span class="s1">&#39;to&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">predicate</span> <span class="o">==</span> <span class="s1">&#39;PrecededBy&#39;</span><span class="p">:</span>
            <span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">subject</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;succeededby&#39;</span><span class="p">,</span> <span class="n">arrows</span><span class="o">=</span><span class="s1">&#39;to&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">predicate</span> <span class="o">==</span> <span class="s1">&#39;MergedWith&#39;</span><span class="p">:</span>
            <span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">subject</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">predicate</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">subject</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">predicate</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

    <span class="n">var_options</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;var_options = {</span>
<span class="s2">                    &quot;nodes&quot;: {&quot;font&quot;: {&quot;size&quot;: 12}},</span>
<span class="s2">                    &quot;interaction&quot;: {&quot;hover&quot;: &quot;True&quot;}}</span>
<span class="s2">                &quot;&quot;&quot;</span>

    <span class="n">g</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">var_options</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">g</span>

<span class="n">display</span><span class="p">(</span><span class="n">daqa_firms_with_op_yrs</span><span class="p">[</span><span class="n">daqa_firms_with_op_yrs</span><span class="p">[</span><span class="s1">&#39;ori_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>\
                       <span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">dts</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>\
                             <span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">])][[</span><span class="s1">&#39;primary_name&#39;</span><span class="p">,</span><span class="s1">&#39;ori_id&#39;</span><span class="p">,</span><span class="s1">&#39;start_yr&#39;</span><span class="p">,</span><span class="s1">&#39;end_yr&#39;</span><span class="p">]]</span>\
                        <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;start_yr&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">output_graph</span><span class="p">(</span><span class="n">related_orgs_df</span><span class="p">[</span><span class="n">related_orgs_df</span><span class="p">[</span><span class="s1">&#39;subject.ori_id&#39;</span><span class="p">]</span>\
                <span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">dts</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>\
                      <span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">])][[</span><span class="s1">&#39;subject.label&#39;</span><span class="p">,</span><span class="s1">&#39;object.label&#39;</span><span class="p">,</span><span class="s1">&#39;predicate.term&#39;</span><span class="p">]],</span> <span class="mi">0</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;networkgraph_0.html&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>primary_name</th>
      <th>ori_id</th>
      <th>start_yr</th>
      <th>end_yr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>934</th>
      <td>"Backhouse &amp; Taylor"</td>
      <td>3838.0</td>
      <td>1862</td>
      <td>1863.0</td>
    </tr>
    <tr>
      <th>936</th>
      <td>"Furnival &amp; Taylor"</td>
      <td>3846.0</td>
      <td>1864</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>442</th>
      <td>"T Taylor"</td>
      <td>4795.0</td>
      <td>1967</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output text_html">
        <iframe
            width="100%"
            height="600px"
            src="networkgraph_0.html"
            frameborder="0"
            allowfullscreen
            
        ></iframe>
        </div></div>
</div>
<p></br>Firm 2 (102 years)</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">daqa_firms_with_op_yrs</span><span class="p">[</span><span class="n">daqa_firms_with_op_yrs</span><span class="p">[</span><span class="s1">&#39;ori_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>\
                       <span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">dts</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>\
                             <span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">])][[</span><span class="s1">&#39;primary_name&#39;</span><span class="p">,</span><span class="s1">&#39;ori_id&#39;</span><span class="p">,</span><span class="s1">&#39;start_yr&#39;</span><span class="p">,</span><span class="s1">&#39;end_yr&#39;</span><span class="p">]]</span>\
                        <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;start_yr&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">output_graph</span><span class="p">(</span><span class="n">related_orgs_df</span><span class="p">[</span><span class="n">related_orgs_df</span><span class="p">[</span><span class="s1">&#39;subject.ori_id&#39;</span><span class="p">]</span>\
                <span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">dts</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>\
                      <span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">])][[</span><span class="s1">&#39;subject.label&#39;</span><span class="p">,</span><span class="s1">&#39;object.label&#39;</span><span class="p">,</span><span class="s1">&#39;predicate.term&#39;</span><span class="p">]],</span> <span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;networkgraph_1.html&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>primary_name</th>
      <th>ori_id</th>
      <th>start_yr</th>
      <th>end_yr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>108</th>
      <td>"C.W. Chambers Architect and Consulting Engineer"</td>
      <td>4415.0</td>
      <td>1893</td>
      <td>1910.0</td>
    </tr>
    <tr>
      <th>109</th>
      <td>"McCredie Bros &amp; Chambers"</td>
      <td>4416.0</td>
      <td>1899</td>
      <td>1892.0</td>
    </tr>
    <tr>
      <th>733</th>
      <td>"H.W. Atkinson &amp; Chas. McLay"</td>
      <td>2338.0</td>
      <td>1907</td>
      <td>1918.0</td>
    </tr>
    <tr>
      <th>892</th>
      <td>"Chambers and Powell"</td>
      <td>2499.0</td>
      <td>1911</td>
      <td>1920.0</td>
    </tr>
    <tr>
      <th>450</th>
      <td>"Arnold Henry Conrad Architect"</td>
      <td>4808.0</td>
      <td>1917</td>
      <td>1917.0</td>
    </tr>
    <tr>
      <th>88</th>
      <td>"Atkinson and Conrad (1918-1927)"</td>
      <td>4316.0</td>
      <td>1918</td>
      <td>1927.0</td>
    </tr>
    <tr>
      <th>850</th>
      <td>"H.W. Atkinson &amp; A.H. Conrad (1918-1927)"</td>
      <td>2456.0</td>
      <td>1918</td>
      <td>1927.0</td>
    </tr>
    <tr>
      <th>708</th>
      <td>"Chambers &amp; Ford"</td>
      <td>2310.0</td>
      <td>1920</td>
      <td>1935.0</td>
    </tr>
    <tr>
      <th>111</th>
      <td>"Powell &amp; Hutton Architects"</td>
      <td>4419.0</td>
      <td>1922</td>
      <td>1924.0</td>
    </tr>
    <tr>
      <th>803</th>
      <td>"Lange Powell Architect"</td>
      <td>2408.0</td>
      <td>1924</td>
      <td>1927.0</td>
    </tr>
    <tr>
      <th>768</th>
      <td>"Atkinson, Powell &amp; Conrad (1927-1931)"</td>
      <td>2373.0</td>
      <td>1927</td>
      <td>1931.0</td>
    </tr>
    <tr>
      <th>749</th>
      <td>"H.W Atkinson &amp; A.H Conrad (1931-1939)"</td>
      <td>2354.0</td>
      <td>1931</td>
      <td>1939.0</td>
    </tr>
    <tr>
      <th>110</th>
      <td>"Lange L Powell &amp; Geo Rae Architects"</td>
      <td>4417.0</td>
      <td>1931</td>
      <td>1933.0</td>
    </tr>
    <tr>
      <th>893</th>
      <td>"Chambers &amp; Hutton"</td>
      <td>2500.0</td>
      <td>1931</td>
      <td>1940.0</td>
    </tr>
    <tr>
      <th>814</th>
      <td>"Lange Powell"</td>
      <td>2419.0</td>
      <td>1933</td>
      <td>1938.0</td>
    </tr>
    <tr>
      <th>868</th>
      <td>"(Lange L.) Powell, Dods &amp; Thorpe (PDT)"</td>
      <td>2475.0</td>
      <td>1938</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>841</th>
      <td>"A.H Conrad &amp; T.B.F Gargett"</td>
      <td>2447.0</td>
      <td>1939</td>
      <td>1965.0</td>
    </tr>
    <tr>
      <th>789</th>
      <td>"Ford, Hutton &amp; Newell"</td>
      <td>2394.0</td>
      <td>1952</td>
      <td>1958.0</td>
    </tr>
    <tr>
      <th>772</th>
      <td>"Lund, Hutton &amp; Newell"</td>
      <td>2377.0</td>
      <td>1959</td>
      <td>1959.0</td>
    </tr>
    <tr>
      <th>881</th>
      <td>"Lund, Hutton, Newell, Black &amp; Paulsen"</td>
      <td>2488.0</td>
      <td>1960</td>
      <td>1964.0</td>
    </tr>
    <tr>
      <th>473</th>
      <td>"Ian Black and Company (Cairns)"</td>
      <td>4852.0</td>
      <td>1964</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>843</th>
      <td>"Conrad Gargett &amp; Partners (1965-1972)"</td>
      <td>2449.0</td>
      <td>1964</td>
      <td>1966.0</td>
    </tr>
    <tr>
      <th>281</th>
      <td>"Lund Hutton Newell Paulsen Pty Ltd"</td>
      <td>4628.0</td>
      <td>1965</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>840</th>
      <td>"Conrad Gargett &amp; Partners (1972-1995)"</td>
      <td>2446.0</td>
      <td>1972</td>
      <td>1995.0</td>
    </tr>
    <tr>
      <th>595</th>
      <td>"Conrad &amp; Gargett"</td>
      <td>5027.0</td>
      <td>1995</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output text_html">
        <iframe
            width="100%"
            height="600px"
            src="networkgraph_1.html"
            frameborder="0"
            allowfullscreen
            
        ></iframe>
        </div></div>
</div>
<p></br>Firm 3 (99 years)</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">daqa_firms_with_op_yrs</span><span class="p">[</span><span class="n">daqa_firms_with_op_yrs</span><span class="p">[</span><span class="s1">&#39;ori_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>\
                       <span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">dts</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>\
                             <span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">])][[</span><span class="s1">&#39;primary_name&#39;</span><span class="p">,</span><span class="s1">&#39;ori_id&#39;</span><span class="p">,</span><span class="s1">&#39;start_yr&#39;</span><span class="p">,</span><span class="s1">&#39;end_yr&#39;</span><span class="p">]]</span>\
                        <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;start_yr&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">output_graph</span><span class="p">(</span><span class="n">related_orgs_df</span><span class="p">[</span><span class="n">related_orgs_df</span><span class="p">[</span><span class="s1">&#39;subject.ori_id&#39;</span><span class="p">]</span>\
                <span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">dts</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>\
                      <span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">])][[</span><span class="s1">&#39;subject.label&#39;</span><span class="p">,</span><span class="s1">&#39;object.label&#39;</span><span class="p">,</span><span class="s1">&#39;predicate.term&#39;</span><span class="p">]],</span> <span class="mi">2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;networkgraph_2.html&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>primary_name</th>
      <th>ori_id</th>
      <th>start_yr</th>
      <th>end_yr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>782</th>
      <td>"John Hall &amp; Son"</td>
      <td>2387.0</td>
      <td>1864</td>
      <td>1896.0</td>
    </tr>
    <tr>
      <th>751</th>
      <td>"Hall &amp; Dods"</td>
      <td>2356.0</td>
      <td>1896</td>
      <td>1916.0</td>
    </tr>
    <tr>
      <th>501</th>
      <td>"HENNESSY AND HENNESSY AND F.R. HALL"</td>
      <td>4890.0</td>
      <td>1916</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>502</th>
      <td>"F.R. HALL AND W. ALAN DEVEREUX"</td>
      <td>4891.0</td>
      <td>1923</td>
      <td>1927.0</td>
    </tr>
    <tr>
      <th>503</th>
      <td>"F R Hall Architect"</td>
      <td>4892.0</td>
      <td>1927</td>
      <td>1930.0</td>
    </tr>
    <tr>
      <th>84</th>
      <td>"F.R Hall and Cook"</td>
      <td>4286.0</td>
      <td>1930</td>
      <td>1939.0</td>
    </tr>
    <tr>
      <th>851</th>
      <td>"Harold M Cook &amp; Walter J E Kerrison"</td>
      <td>2457.0</td>
      <td>1939</td>
      <td>1962.0</td>
    </tr>
    <tr>
      <th>601</th>
      <td>"Cook &amp; Kerrison &amp; Partners"</td>
      <td>5033.0</td>
      <td>1963</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output text_html">
        <iframe
            width="100%"
            height="600px"
            src="networkgraph_2.html"
            frameborder="0"
            allowfullscreen
            
        ></iframe>
        </div></div>
</div>
<p></br>Firm 4 (84 years)</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">daqa_firms_with_op_yrs</span><span class="p">[</span><span class="n">daqa_firms_with_op_yrs</span><span class="p">[</span><span class="s1">&#39;ori_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>\
                       <span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">dts</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>\
                             <span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">])][[</span><span class="s1">&#39;primary_name&#39;</span><span class="p">,</span><span class="s1">&#39;ori_id&#39;</span><span class="p">,</span><span class="s1">&#39;start_yr&#39;</span><span class="p">,</span><span class="s1">&#39;end_yr&#39;</span><span class="p">]]</span>\
                        <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;start_yr&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">output_graph</span><span class="p">(</span><span class="n">related_orgs_df</span><span class="p">[</span><span class="n">related_orgs_df</span><span class="p">[</span><span class="s1">&#39;subject.ori_id&#39;</span><span class="p">]</span>\
                <span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">dts</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>\
                      <span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">])][[</span><span class="s1">&#39;subject.label&#39;</span><span class="p">,</span><span class="s1">&#39;object.label&#39;</span><span class="p">,</span><span class="s1">&#39;predicate.term&#39;</span><span class="p">]],</span> <span class="mi">3</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;networkgraph_3.html&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>primary_name</th>
      <th>ori_id</th>
      <th>start_yr</th>
      <th>end_yr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>908</th>
      <td>"Arthur W. F. Bligh"</td>
      <td>3574.0</td>
      <td>1926</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>940</th>
      <td>"Bligh &amp; Jessup"</td>
      <td>3870.0</td>
      <td>1947</td>
      <td>1952.0</td>
    </tr>
    <tr>
      <th>153</th>
      <td>"Bligh Jessup &amp; Partners"</td>
      <td>4499.0</td>
      <td>1953</td>
      <td>1956.0</td>
    </tr>
    <tr>
      <th>839</th>
      <td>"Bligh Jessup Bretnall &amp; Partners"</td>
      <td>2445.0</td>
      <td>1957</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>229</th>
      <td>"Colin W Jessup"</td>
      <td>4576.0</td>
      <td>1961</td>
      <td>1975.0</td>
    </tr>
    <tr>
      <th>121</th>
      <td>"Callaghan Robinson Architects"</td>
      <td>4459.0</td>
      <td>1972</td>
      <td>1972.0</td>
    </tr>
    <tr>
      <th>122</th>
      <td>"Noel Robinson Architects (&amp; Partners)"</td>
      <td>4460.0</td>
      <td>1973</td>
      <td>1977.0</td>
    </tr>
    <tr>
      <th>123</th>
      <td>"Noel Robinson Built Environments"</td>
      <td>4461.0</td>
      <td>1977</td>
      <td>1986.0</td>
    </tr>
    <tr>
      <th>890</th>
      <td>"Bligh Jessup Robinson"</td>
      <td>2497.0</td>
      <td>1987</td>
      <td>1960.0</td>
    </tr>
    <tr>
      <th>124</th>
      <td>"Bligh Robinson"</td>
      <td>4462.0</td>
      <td>1989</td>
      <td>1990.0</td>
    </tr>
    <tr>
      <th>835</th>
      <td>"Noel Robinson Architects (2)"</td>
      <td>2440.0</td>
      <td>1990</td>
      <td>1999.0</td>
    </tr>
    <tr>
      <th>791</th>
      <td>"Bligh Voller Nield"</td>
      <td>2396.0</td>
      <td>1997</td>
      <td>2009.0</td>
    </tr>
    <tr>
      <th>125</th>
      <td>"Design Inc"</td>
      <td>4463.0</td>
      <td>2000</td>
      <td>2010.0</td>
    </tr>
    <tr>
      <th>938</th>
      <td>"BVN Architecture"</td>
      <td>3868.0</td>
      <td>2009</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>126</th>
      <td>"NRACOLAB"</td>
      <td>4464.0</td>
      <td>2010</td>
      <td>2020.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output text_html">
        <iframe
            width="100%"
            height="600px"
            src="networkgraph_3.html"
            frameborder="0"
            allowfullscreen
            
        ></iframe>
        </div></div>
</div>
<p></br>Firm 5 (64 years)</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">daqa_firms_with_op_yrs</span><span class="p">[</span><span class="n">daqa_firms_with_op_yrs</span><span class="p">[</span><span class="s1">&#39;ori_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>\
                       <span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">dts</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>\
                             <span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">])][[</span><span class="s1">&#39;primary_name&#39;</span><span class="p">,</span><span class="s1">&#39;ori_id&#39;</span><span class="p">,</span><span class="s1">&#39;start_yr&#39;</span><span class="p">,</span><span class="s1">&#39;end_yr&#39;</span><span class="p">]]</span>\
                        <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;start_yr&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">output_graph</span><span class="p">(</span><span class="n">related_orgs_df</span><span class="p">[</span><span class="n">related_orgs_df</span><span class="p">[</span><span class="s1">&#39;subject.ori_id&#39;</span><span class="p">]</span>\
                <span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">dts</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>\
                      <span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">])][[</span><span class="s1">&#39;subject.label&#39;</span><span class="p">,</span><span class="s1">&#39;object.label&#39;</span><span class="p">,</span><span class="s1">&#39;predicate.term&#39;</span><span class="p">]],</span> <span class="mi">4</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;networkgraph_4.html&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>primary_name</th>
      <th>ori_id</th>
      <th>start_yr</th>
      <th>end_yr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>918</th>
      <td>"Job &amp; Collin"</td>
      <td>3636.0</td>
      <td>1938</td>
      <td>1954.0</td>
    </tr>
    <tr>
      <th>871</th>
      <td>"C W T Fulton in Assn with A H Job &amp; J M Collin"</td>
      <td>2478.0</td>
      <td>1954</td>
      <td>1955.0</td>
    </tr>
    <tr>
      <th>826</th>
      <td>"Aubrey H.  Job &amp; R. P.  Froud (Job &amp; Froud)"</td>
      <td>2431.0</td>
      <td>1955</td>
      <td>1976.0</td>
    </tr>
    <tr>
      <th>915</th>
      <td>"C W T Fulton in Assn with J M Collin"</td>
      <td>3633.0</td>
      <td>1955</td>
      <td>1960.0</td>
    </tr>
    <tr>
      <th>165</th>
      <td>"JM Collin  &amp;  CWT Fulton"</td>
      <td>4511.0</td>
      <td>1961</td>
      <td>1966.0</td>
    </tr>
    <tr>
      <th>191</th>
      <td>"J G Gilmour"</td>
      <td>4537.0</td>
      <td>1961</td>
      <td>1966.0</td>
    </tr>
    <tr>
      <th>563</th>
      <td>"G B Boys"</td>
      <td>4994.0</td>
      <td>1961</td>
      <td>1966.0</td>
    </tr>
    <tr>
      <th>894</th>
      <td>"J M Collin &amp; C W T Fulton"</td>
      <td>2501.0</td>
      <td>1961</td>
      <td>1966.0</td>
    </tr>
    <tr>
      <th>808</th>
      <td>"Fulton Collin Boys Gilmour Trotter &amp; Partners"</td>
      <td>2413.0</td>
      <td>1966</td>
      <td>1981.0</td>
    </tr>
    <tr>
      <th>653</th>
      <td>"C W T Fulton"</td>
      <td>5085.0</td>
      <td>1967</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>181</th>
      <td>"RP Froud Architect"</td>
      <td>4527.0</td>
      <td>1974</td>
      <td>1986.0</td>
    </tr>
    <tr>
      <th>916</th>
      <td>"Fulton Gilmour Trotter &amp; Moss"</td>
      <td>3634.0</td>
      <td>1981</td>
      <td>1998.0</td>
    </tr>
    <tr>
      <th>917</th>
      <td>"Fulton Trotter Moss"</td>
      <td>3635.0</td>
      <td>1998</td>
      <td>2002.0</td>
    </tr>
    <tr>
      <th>731</th>
      <td>"Fulton Trotter Architects"</td>
      <td>2336.0</td>
      <td>2002</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output text_html">
        <iframe
            width="100%"
            height="600px"
            src="networkgraph_4.html"
            frameborder="0"
            allowfullscreen
            
        ></iframe>
        </div></div>
</div>
</div>
<div class="section" id="projects-by-completion-date">
<h3>Projects by completion date<a class="headerlink" href="#projects-by-completion-date" title="Permalink to this headline">¶</a></h3>
<p>Below are some temporal statistics about completed projects in the DAQA dataset. We divide the data into four periods: before 1940, between 1940-1980, post 1980, and undated. Proportions are calculated as a percentage of the total number of completed projects in the dataset.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># store all rows with date_start in coverage_range</span>
<span class="n">completion_dates_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Pre-1940&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;1940-80&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Post-1980&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Undated&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
<span class="n">projects_1940_80</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">projects_1940_80_firms_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">firms_with_projects_1940_80</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span><span class="n">row</span> <span class="ow">in</span> <span class="n">daqa_work</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;coverage_range&#39;</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span> 
        <span class="k">if</span> <span class="s2">&quot;date_end&quot;</span> <span class="ow">in</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;coverage_range&#39;</span><span class="p">]:</span>
            <span class="n">comp_yr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;coverage_range&#39;</span><span class="p">])[</span><span class="s1">&#39;date_range&#39;</span><span class="p">])[</span><span class="s1">&#39;date_end.year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1"># add counter for comp_yr to dict</span>
            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">comp_yr</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1940</span><span class="p">:</span> <span class="n">completion_dates_dict</span><span class="p">[</span><span class="s1">&#39;Pre-1940&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="nb">int</span><span class="p">(</span><span class="n">comp_yr</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1940</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">comp_yr</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1980</span><span class="p">:</span> 
                <span class="n">completion_dates_dict</span><span class="p">[</span><span class="s1">&#39;1940-80&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">projects_1940_80</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;_id&#39;</span><span class="p">])</span>

                <span class="c1"># add related firm to list</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;related_organizations&#39;</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">related_firm</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;related_organizations&#39;</span><span class="p">]))[</span><span class="s1">&#39;subject.ori_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">firms_with_projects_1940_80</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">related_firm</span><span class="p">)</span>
                    <span class="n">projects_1940_80_firms_dict</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;_id&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">related_firm</span>

            <span class="k">elif</span> <span class="nb">int</span><span class="p">(</span><span class="n">comp_yr</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1980</span><span class="p">:</span> <span class="n">completion_dates_dict</span><span class="p">[</span><span class="s1">&#39;Post-1980&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">completion_dates_dict</span><span class="p">[</span><span class="s1">&#39;Undated&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c1"># number of projects in DAQA</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">There are </span><span class="si">{}</span><span class="s1"> projects in DAQA.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">count_projects</span><span class="p">))</span>

<span class="c1"># number of pre-1940 projects</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;There are </span><span class="si">{}</span><span class="s1"> (</span><span class="si">{}</span><span class="s1">%) projects with completion dates before 1940.&#39;</span><span class="o">.</span>\
      <span class="nb">format</span><span class="p">(</span><span class="n">completion_dates_dict</span><span class="p">[</span><span class="s1">&#39;Pre-1940&#39;</span><span class="p">],</span> <span class="nb">round</span><span class="p">((</span><span class="n">completion_dates_dict</span><span class="p">[</span><span class="s1">&#39;Pre-1940&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">count_projects</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>

<span class="c1"># number of 1940-1980 projects</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;There are </span><span class="si">{}</span><span class="s1"> (</span><span class="si">{}</span><span class="s1">%) projects with completion dates between 1940 and 1980.&#39;</span><span class="o">.</span>\
      <span class="nb">format</span><span class="p">(</span><span class="n">completion_dates_dict</span><span class="p">[</span><span class="s1">&#39;1940-80&#39;</span><span class="p">],</span> <span class="nb">round</span><span class="p">((</span><span class="n">completion_dates_dict</span><span class="p">[</span><span class="s1">&#39;1940-80&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">count_projects</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>

<span class="c1"># number of post-1980 projects</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;There are </span><span class="si">{}</span><span class="s1"> (</span><span class="si">{}</span><span class="s1">%) projects with completion dates after 1980.&#39;</span><span class="o">.</span>\
      <span class="nb">format</span><span class="p">(</span><span class="n">completion_dates_dict</span><span class="p">[</span><span class="s1">&#39;Post-1980&#39;</span><span class="p">],</span> <span class="nb">round</span><span class="p">((</span><span class="n">completion_dates_dict</span><span class="p">[</span><span class="s1">&#39;Post-1980&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">count_projects</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>

<span class="c1"># number of undated projects</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;There are </span><span class="si">{}</span><span class="s1"> (</span><span class="si">{}</span><span class="s1">%) projects with no completion dates.&#39;</span>\
      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">completion_dates_dict</span><span class="p">[</span><span class="s1">&#39;Undated&#39;</span><span class="p">],</span> <span class="nb">round</span><span class="p">((</span><span class="n">completion_dates_dict</span><span class="p">[</span><span class="s1">&#39;Undated&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">count_projects</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># plot completion_dates_dict as a bar chart</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">completion_dates_dict</span><span class="p">)),</span> <span class="nb">list</span><span class="p">(</span><span class="n">completion_dates_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">completion_dates_dict</span><span class="p">)),</span> <span class="nb">list</span><span class="p">(</span><span class="n">completion_dates_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Completion dates of DAQA projects, n=2203&#39;</span><span class="p">)</span>

<span class="c1"># add labels to bars with propotion in white inside top of bar</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">completion_dates_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mf">0.125</span><span class="p">,</span> <span class="n">v</span> <span class="o">+</span> <span class="mi">20</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">v</span> <span class="o">-</span> <span class="mi">75</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">((</span><span class="n">v</span><span class="o">/</span><span class="n">count_projects</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;%&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># make y axis start at 0</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>There are 2203 projects in DAQA.
There are 465 (21.11%) projects with completion dates before 1940.
There are 608 (27.6%) projects with completion dates between 1940 and 1980.
There are 257 (11.67%) projects with completion dates after 1980.
There are 873 (39.63%) projects with no completion dates.
</pre></div>
</div>
<img alt="_images/Analysis_DAQA_Part2_17_1.png" src="_images/Analysis_DAQA_Part2_17_1.png" />
</div>
</div>
</div>
<div class="section" id="projects-and-firms">
<h3>1940-1980 projects and firms<a class="headerlink" href="#projects-and-firms" title="Permalink to this headline">¶</a></h3>
<p>Below are some statistics about project characteristics and firms in the DAQA dataset of only projected completed between 1940 and 1980. Proportions under the <code class="docutils literal notranslate"><span class="pre">1940-1980</span> <span class="pre">PROJECTS</span></code> subheading are calculated as a percentage of the total number of projects completed between 1940 and 1980 in the dataset. Proportions under the <code class="docutils literal notranslate"><span class="pre">1940-1980</span> <span class="pre">FIRMS</span></code> subheading are calculated as a percentage of the total number of firms related to projects completed between 1940 and 1980 in the dataset.</p>
<ul class="simple">
<li><p>We define an extant project as one that has a populated <code class="docutils literal notranslate"><span class="pre">is_demolished</span></code> field and the value is <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p>We define a demolished project as one that has a populated <code class="docutils literal notranslate"><span class="pre">is_demolished</span></code> field and the value is <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;###################### 1940-1980 PROJECTS ######################&#39;</span><span class="p">)</span>

<span class="c1"># filter data accordingly</span>
<span class="n">daqawork_1940_80</span> <span class="o">=</span> <span class="n">daqa_work</span><span class="p">[</span><span class="n">daqa_work</span><span class="p">[</span><span class="s1">&#39;_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">projects_1940_80</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: How many projects are recorded in DAQA between 1940-1980?&#39;</span><span class="p">)</span>
<span class="n">count_projects</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">daqawork_1940_80</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: There are </span><span class="si">{</span><span class="n">count_projects</span><span class="si">}</span><span class="s1"> projects between 1940-1980.&#39;</span><span class="p">)</span>

<span class="c1"># we define a extant buiulding where &quot;is_demolished&quot; field is False</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: what </span><span class="si">% o</span><span class="s1">f projects completed in 1940-1980 are extant?&#39;</span><span class="p">)</span>
<span class="n">count_projects_extant</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">daqawork_1940_80</span><span class="p">[</span><span class="n">daqawork_1940_80</span><span class="p">[</span><span class="s1">&#39;is_demolished&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">False</span><span class="p">])</span>
<span class="n">prop_projects_extant</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">count_projects_extant</span> <span class="o">/</span> <span class="n">count_projects</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: </span><span class="si">{</span><span class="n">prop_projects_extant</span><span class="si">}</span><span class="s1">% (</span><span class="si">{</span><span class="n">count_projects_extant</span><span class="si">}</span><span class="s1">) of DAQA projects between 1940-1980 are extant.&#39;</span><span class="p">)</span>

<span class="c1"># we define a extant buiulding where &quot;is_demolished&quot; field is True</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: what </span><span class="si">% o</span><span class="s1">f projects completed in 1940-1980 are demolished?&#39;</span><span class="p">)</span>
<span class="n">count_projects_demolished</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">daqawork_1940_80</span><span class="p">[</span><span class="n">daqawork_1940_80</span><span class="p">[</span><span class="s1">&#39;is_demolished&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">])</span>
<span class="n">prop_projects_demolished</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">count_projects_demolished</span> <span class="o">/</span> <span class="n">count_projects</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: </span><span class="si">{</span><span class="n">prop_projects_demolished</span><span class="si">}</span><span class="s1">% (</span><span class="si">{</span><span class="n">count_projects_demolished</span><span class="si">}</span><span class="s1">) of DAQA projects between 1940-1980 are demolished.&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">*It should be noted that there are 5 DAQA projects between 1940-1980 with missing demolished information.&#39;</span><span class="p">)</span>

<span class="c1"># we define a project with an address as one that has a populated &quot;address&quot; field</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: what </span><span class="si">% o</span><span class="s1">f projects between 1940-1980 have addresses?&#39;</span><span class="p">)</span>
<span class="n">count_projects_with_address</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">daqawork_1940_80</span><span class="p">[</span><span class="n">daqawork_1940_80</span><span class="o">.</span><span class="n">coverage_range</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;address&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)])</span>
<span class="n">prop_projects_with_address</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">count_projects_with_address</span> <span class="o">/</span> <span class="n">count_projects</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: </span><span class="si">{</span><span class="n">prop_projects_with_address</span><span class="si">}</span><span class="s1">% (</span><span class="si">{</span><span class="n">count_projects_with_address</span><span class="si">}</span><span class="s1">) of DAQA projects between 1940-1980 have addresses.&#39;</span><span class="p">)</span>

<span class="c1"># we define a project with a geocode date as one that has a populated &quot;longitude&quot; field</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: what </span><span class="si">% o</span><span class="s1">f projects between 1940-1980 have geocodes (lat/long)?&#39;</span><span class="p">)</span>
<span class="n">count_projects_with_geocodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">daqawork_1940_80</span><span class="p">[</span><span class="n">daqawork_1940_80</span><span class="o">.</span><span class="n">coverage_range</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;latitude&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)])</span>
<span class="n">prop_projects_with_geocodes</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">count_projects_with_geocodes</span> <span class="o">/</span> <span class="n">count_projects</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: </span><span class="si">{</span><span class="n">prop_projects_with_geocodes</span><span class="si">}</span><span class="s1">% (</span><span class="si">{</span><span class="n">count_projects_with_geocodes</span><span class="si">}</span><span class="s1">) of DAQA projects between 1940-1980 have geocodes.&#39;</span><span class="p">)</span>

<span class="c1"># we define a project with an associated firm as one that has a populated &quot;related_organizations&quot; field</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: how many projects between 1940-1980 have associated firms?&#39;</span><span class="p">)</span>
<span class="n">daqawork_1940_80_firms</span> <span class="o">=</span> <span class="n">daqawork_1940_80</span><span class="p">[</span><span class="n">daqawork_1940_80</span><span class="o">.</span><span class="n">related_organizations</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span>
<span class="n">count_projects_with_firms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">daqawork_1940_80_firms</span><span class="p">)</span>
<span class="n">prop_projects_with_firms</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">count_projects_with_firms</span> <span class="o">/</span> <span class="n">count_projects</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: </span><span class="si">{</span><span class="n">prop_projects_with_firms</span><span class="si">}</span><span class="s1">% (</span><span class="si">{</span><span class="n">count_projects_with_firms</span><span class="si">}</span><span class="s1">) of DAQA projects between 1940-1980 have associated firms.&#39;</span><span class="p">)</span>

<span class="c1"># we define a project with no associated architects as one that has no populated &quot;related_people&quot; field</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: what </span><span class="si">% o</span><span class="s1">f projects between 1940-1980 have associated firms but no architects?&#39;</span><span class="p">)</span>
<span class="n">count_projects_with_firms_no_architects</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">daqawork_1940_80</span><span class="p">[(</span><span class="n">daqawork_1940_80</span><span class="o">.</span><span class="n">related_organizations</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span> <span class="o">&amp;</span>\
                                                        <span class="p">(</span><span class="n">daqawork_1940_80</span><span class="o">.</span><span class="n">related_people</span><span class="o">.</span><span class="n">isnull</span><span class="p">())])</span>
<span class="n">prop_projects_with_firms_no_architects</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">count_projects_with_firms_no_architects</span> <span class="o">/</span> <span class="n">count_projects</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: </span><span class="si">{</span><span class="n">prop_projects_with_firms_no_architects</span><span class="si">}</span><span class="s1">% (</span><span class="si">{</span><span class="n">count_projects_with_firms_no_architects</span><span class="si">}</span><span class="s1">) of DAQA projects between 1940-1980 have associated firms but no architects.&#39;</span><span class="p">)</span>

<span class="c1"># we define a project with an associated architect as one that has a populated &quot;related_people&quot; field</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: how many projects between 1940-1980 have associated architects?&#39;</span><span class="p">)</span>
<span class="n">count_projects_with_architects</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">daqawork_1940_80</span><span class="p">[</span><span class="n">daqawork_1940_80</span><span class="o">.</span><span class="n">related_people</span><span class="o">.</span><span class="n">notnull</span><span class="p">()])</span>
<span class="n">prop_projects_with_architects</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">count_projects_with_architects</span> <span class="o">/</span> <span class="n">count_projects</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: </span><span class="si">{</span><span class="n">prop_projects_with_architects</span><span class="si">}</span><span class="s1">% (</span><span class="si">{</span><span class="n">count_projects_with_architects</span><span class="si">}</span><span class="s1">) of DAQA projects between 1940-1980 have associated architects.&#39;</span><span class="p">)</span>

<span class="c1"># we define a project with an associated architects as one that has a populated &quot;related people&quot; field</span>
<span class="c1"># and we define a project with no associated firms as one that has a no populated &quot;related organizations&quot; field</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: what </span><span class="si">% o</span><span class="s1">f projects between 1940-1980 have associated architects but no firms?&#39;</span><span class="p">)</span>
<span class="n">count_projects_with_architects_no_firms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">daqawork_1940_80</span><span class="p">[(</span><span class="n">daqawork_1940_80</span><span class="o">.</span><span class="n">related_organizations</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span> <span class="o">&amp;</span>\
                                                        <span class="p">(</span><span class="n">daqawork_1940_80</span><span class="o">.</span><span class="n">related_people</span><span class="o">.</span><span class="n">notnull</span><span class="p">())])</span>
<span class="n">prop_projects_with_architects_no_firms</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">count_projects_with_architects_no_firms</span> <span class="o">/</span> <span class="n">count_projects</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: </span><span class="si">{</span><span class="n">prop_projects_with_architects_no_firms</span><span class="si">}</span><span class="s1">% (</span><span class="si">{</span><span class="n">count_projects_with_architects_no_firms</span><span class="si">}</span><span class="s1">) of DAQA projects between 1940-1980 have associated architects but no firms.&#39;</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">###################### 1940-1980 FIRMS ######################&#39;</span><span class="p">)</span>

<span class="c1"># filter data accordingly</span>
<span class="n">daqafirms_1940_80</span> <span class="o">=</span> <span class="n">daqa_firms</span><span class="p">[</span><span class="n">daqa_firms</span><span class="p">[</span><span class="s1">&#39;ori_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">firms_with_projects_1940_80</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: How many firms are recorded in DAQA between 1940-1980?&#39;</span><span class="p">)</span>
<span class="n">count_firms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">daqafirms_1940_80</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: There are </span><span class="si">{</span><span class="n">count_firms</span><span class="si">}</span><span class="s1"> firms between 1940-1980.&#39;</span><span class="p">)</span>

<span class="c1"># we define an operating firm as an organisation that has a populated &quot;operation&quot; field with a start date</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: what </span><span class="si">% o</span><span class="s1">f firms between 1940-1980 have ‘operating years’ recorded (just start)?&#39;</span><span class="p">)</span>
<span class="n">count_firms_with_operating_start</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">daqafirms_1940_80</span><span class="p">[</span><span class="n">daqafirms_1940_80</span><span class="o">.</span><span class="n">operation</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;date_start&quot;</span> <span class="ow">in</span> <span class="n">x</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="kc">False</span><span class="p">)])</span>
<span class="n">prop_firms_with_operating_start</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">count_firms_with_operating_start</span> <span class="o">/</span> <span class="n">count_firms</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: </span><span class="si">{</span><span class="n">prop_firms_with_operating_start</span><span class="si">}</span><span class="s1">% (</span><span class="si">{</span><span class="n">count_firms_with_operating_start</span><span class="si">}</span><span class="s1">) of DAQA firms between 1940-1980 have operating years recorded (just start).&#39;</span><span class="p">)</span>

<span class="c1"># we define an operating firm as an organisation that has a populated &quot;operation&quot; field with start and end dates</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: what </span><span class="si">% o</span><span class="s1">f firms between 1940-1980 have ‘operating years’ recorded (start and end)?&#39;</span><span class="p">)</span>
<span class="n">count_firms_with_operating_years</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">daqafirms_1940_80</span><span class="p">[</span><span class="n">daqafirms_1940_80</span><span class="o">.</span><span class="n">operation</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;date_start&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="s2">&quot;date_end&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="kc">False</span><span class="p">)])</span>
<span class="n">prop_firms_with_operating_years</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">count_firms_with_operating_years</span> <span class="o">/</span> <span class="n">count_firms</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: </span><span class="si">{</span><span class="n">prop_firms_with_operating_years</span><span class="si">}</span><span class="s1">% (</span><span class="si">{</span><span class="n">count_firms_with_operating_years</span><span class="si">}</span><span class="s1">) of DAQA firms between 1940-1980 have operating years recorded (start and end).&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>###################### 1940-1980 PROJECTS ######################

Q: How many projects are recorded in DAQA between 1940-1980?
A: There are 608 projects between 1940-1980.

Q: what % of projects completed in 1940-1980 are extant?
A: 86.84% (528) of DAQA projects between 1940-1980 are extant.

Q: what % of projects completed in 1940-1980 are demolished?
A: 12.34% (75) of DAQA projects between 1940-1980 are demolished.

*It should be noted that there are 5 DAQA projects between 1940-1980 with missing demolished information.

Q: what % of projects between 1940-1980 have addresses?
A: 96.05% (584) of DAQA projects between 1940-1980 have addresses.

Q: what % of projects between 1940-1980 have geocodes (lat/long)?
A: 85.86% (522) of DAQA projects between 1940-1980 have geocodes.

Q: how many projects between 1940-1980 have associated firms?
A: 78.29% (476) of DAQA projects between 1940-1980 have associated firms.

Q: what % of projects between 1940-1980 have associated firms but no architects?
A: 16.94% (103) of DAQA projects between 1940-1980 have associated firms but no architects.

Q: how many projects between 1940-1980 have associated architects?
A: 82.07% (499) of DAQA projects between 1940-1980 have associated architects.

Q: what % of projects between 1940-1980 have associated architects but no firms?
A: 20.72% (126) of DAQA projects between 1940-1980 have associated architects but no firms.

###################### 1940-1980 FIRMS ######################

Q: How many firms are recorded in DAQA between 1940-1980?
A: There are 101 firms between 1940-1980.

Q: what % of firms between 1940-1980 have ‘operating years’ recorded (just start)?
A: 81.19% (82) of DAQA firms between 1940-1980 have operating years recorded (just start).

Q: what % of firms between 1940-1980 have ‘operating years’ recorded (start and end)?
A: 67.33% (68) of DAQA firms between 1940-1980 have operating years recorded (start and end).
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="education">
<h2>Education<a class="headerlink" href="#education" title="Permalink to this headline">¶</a></h2>
<p>Below are some education qualification characteristics of people records in the DAQA dataset. Proportions are calculated as a percentage of the total number of people in the dataset.</p>
<p>We focus on the data of four universities: <code class="docutils literal notranslate"><span class="pre">UQ</span></code>, <code class="docutils literal notranslate"><span class="pre">BCTC</span></code>, <code class="docutils literal notranslate"><span class="pre">QIT</span></code>, and <code class="docutils literal notranslate"><span class="pre">QUT</span></code>. The latter three also grouped together, and represented as <code class="docutils literal notranslate"><span class="pre">BCTC/QIT/QUT</span></code>. We compute statistics for each university separately and then visualise the data for <code class="docutils literal notranslate"><span class="pre">UQ</span></code> and <code class="docutils literal notranslate"><span class="pre">BCTC/QIT/QUT</span></code>.</p>
<ul class="simple">
<li><p>We define a person with a education data as one that has a populated <code class="docutils literal notranslate"><span class="pre">education_trainings</span></code> field</p></li>
<li><p>We define a person with a education year data as one that has a populated <code class="docutils literal notranslate"><span class="pre">date_end</span></code> field in the <code class="docutils literal notranslate"><span class="pre">education_trainings</span></code> field</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load data</span>
<span class="n">daqa_persons</span> <span class="o">=</span> <span class="n">df_daqa_dict</span><span class="p">[</span><span class="s1">&#39;person&#39;</span><span class="p">]</span>
<span class="n">daqa_persons_with_education_data</span> <span class="o">=</span> <span class="n">daqa_persons</span><span class="p">[</span><span class="n">daqa_persons</span><span class="p">[</span><span class="s1">&#39;education_trainings&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: How many persons are recorded in DAQA?&#39;</span><span class="p">)</span>
<span class="n">count_persons</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">daqa_persons</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: There are </span><span class="si">{</span><span class="n">count_persons</span><span class="si">}</span><span class="s1"> people in DAQA.&#39;</span><span class="p">)</span>

<span class="c1"># we define a person with a education data as one that has a populated &quot;education_trainings&quot; field</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: what </span><span class="si">% o</span><span class="s1">f people have education data?&#39;</span><span class="p">)</span>
<span class="n">count_persons_with_education_data</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">daqa_persons_with_education_data</span><span class="p">)</span>
<span class="n">prop_persons_with_education_data</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">count_persons_with_education_data</span> <span class="o">/</span> <span class="n">count_persons</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: </span><span class="si">{</span><span class="n">prop_persons_with_education_data</span><span class="si">}</span><span class="s1">% (</span><span class="si">{</span><span class="n">count_persons_with_education_data</span><span class="si">}</span><span class="s1">) of people with education data.&#39;</span><span class="p">)</span>

<span class="c1"># we define a person with a education year data as one that has a populated &quot;date_end&quot; field in the &quot;education_trainings&quot; field</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: what </span><span class="si">% o</span><span class="s1">f people have education data (with years)?&#39;</span><span class="p">)</span>
<span class="n">daqa_persons_with_education_year_data</span> <span class="o">=</span> <span class="n">daqa_persons_with_education_data</span><span class="p">[</span><span class="n">daqa_persons_with_education_data</span>\
                                                                         <span class="o">.</span><span class="n">education_trainings</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;date_end&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)]</span>
<span class="n">count_persons_with_education_year_data</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">daqa_persons_with_education_year_data</span><span class="p">)</span>
<span class="n">prop_persons_with_education_year_data</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">count_persons_with_education_year_data</span> <span class="o">/</span> <span class="n">count_persons</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: </span><span class="si">{</span><span class="n">prop_persons_with_education_year_data</span><span class="si">}</span><span class="s1">% (</span><span class="si">{</span><span class="n">count_persons_with_education_year_data</span><span class="si">}</span><span class="s1">) of people with education year data.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Q: How many persons are recorded in DAQA?
A: There are 1103 people in DAQA.

Q: what % of people have education data?
A: 20.58% (227) of people with education data.

Q: what % of people have education data (with years)?
A: 17.86% (197) of people with education year data.
</pre></div>
</div>
</div>
</div>
<div class="section" id="queensland-universities">
<h3>Queensland universities<a class="headerlink" href="#queensland-universities" title="Permalink to this headline">¶</a></h3>
<div class="section" id="uq">
<h4>UQ<a class="headerlink" href="#uq" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">education_training_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">daqa_persons_with_education_data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">person_id</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ori_id&#39;</span><span class="p">]</span>
    <span class="n">education_training_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;education_trainings&#39;</span><span class="p">]))</span>
    <span class="n">education_training_data</span><span class="p">[</span><span class="s1">&#39;ori_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">person_id</span>
    <span class="n">education_training_df</span> <span class="o">=</span> <span class="n">education_training_df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">education_training_data</span><span class="p">)</span>

<span class="c1"># remove erroneous row</span>
<span class="n">education_training_df</span> <span class="o">=</span> <span class="n">education_training_df</span><span class="p">[</span><span class="o">~</span><span class="n">education_training_df</span><span class="p">[</span><span class="s1">&#39;organization.name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;note: interview UQ&#39;</span><span class="p">,</span><span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>

<span class="k">def</span> <span class="nf">print_filtered_data</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="nb">filter</span><span class="p">,</span> <span class="n">display_output</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;organization.name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">filter</span><span class="p">),</span><span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">display_output</span><span class="p">:</span>
        <span class="n">display</span><span class="p">(</span><span class="n">filtered_df</span><span class="p">[</span><span class="s1">&#39;organization.name&#39;</span><span class="p">]</span>\
                <span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>\
                <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
                <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;organization&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;organization.name&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">}))</span>
    <span class="k">return</span> <span class="n">filtered_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: How many education records from UQ exist in DAQA?&#39;</span><span class="p">)</span>
<span class="n">filterd_count_uq</span> <span class="o">=</span> <span class="n">print_filtered_data</span><span class="p">(</span><span class="n">education_training_df</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;UQ&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;A: There are </span><span class="si">{}</span><span class="s1"> education records with from UQ.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filterd_count_uq</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Q: How many education records from UQ exist in DAQA?
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>organization</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>UQ</td>
      <td>99</td>
    </tr>
    <tr>
      <th>1</th>
      <td>BCTC/UQ</td>
      <td>11</td>
    </tr>
    <tr>
      <th>2</th>
      <td>QUT, UQ</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>BCTC?UQ</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A: There are 112 education records with from UQ.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="bctc">
<h4>BCTC<a class="headerlink" href="#bctc" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Q: How many people have education data from BCTC?&#39;</span><span class="p">)</span>
<span class="n">filterd_count_bctc</span> <span class="o">=</span> <span class="n">print_filtered_data</span><span class="p">(</span><span class="n">education_training_df</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;BCTC&#39;</span><span class="p">,</span><span class="s1">&#39;BRISBANE&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;A: There are </span><span class="si">{}</span><span class="s1"> people with education data from BCTC.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filterd_count_bctc</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Q: How many people have education data from BCTC?
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>organization</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>BCTC</td>
      <td>42</td>
    </tr>
    <tr>
      <th>1</th>
      <td>BCTC/UQ</td>
      <td>11</td>
    </tr>
    <tr>
      <th>2</th>
      <td>BRISBANE CENTRAL TECHNICAL COLLEGE</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>BCTC?UQ</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A: There are 57 people with education data from BCTC.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="qit">
<h4>QIT<a class="headerlink" href="#qit" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Q: How many people have education data from QIT?&#39;</span><span class="p">)</span>
<span class="n">filterd_count_qit</span> <span class="o">=</span> <span class="n">print_filtered_data</span><span class="p">(</span><span class="n">education_training_df</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;QIT&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;A: There are </span><span class="si">{}</span><span class="s1"> people with education data from QIT.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filterd_count_qit</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Q: How many people have education data from QIT?
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>organization</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>QIT</td>
      <td>21</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A: There are 21 people with education data from QIT.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="qut">
<h4>QUT<a class="headerlink" href="#qut" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Q: How many people have education data from QUT?&#39;</span><span class="p">)</span>
<span class="n">filterd_count_qut</span> <span class="o">=</span> <span class="n">print_filtered_data</span><span class="p">(</span><span class="n">education_training_df</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;QUT&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;A: There are </span><span class="si">{}</span><span class="s1"> people with education data from QUT.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filterd_count_qut</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Q: How many people have education data from QUT?
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>organization</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>QUT</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>QUT, UQ</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>OHIO_STATE_UNIandQUT</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A: There are 12 people with education data from QUT.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="visual-comparison">
<h4>Visual comparison<a class="headerlink" href="#visual-comparison" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a bar chart with all the filterd_count values</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="s1">&#39;UQ&#39;</span><span class="p">,</span> <span class="s1">&#39;BCTC&#39;</span><span class="p">,</span> <span class="s1">&#39;QIT&#39;</span><span class="p">,</span> <span class="s1">&#39;QUT&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">filterd_count_uq</span><span class="p">,</span> <span class="n">filterd_count_bctc</span><span class="p">,</span> <span class="n">filterd_count_qit</span><span class="p">,</span> <span class="n">filterd_count_qut</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Count of education records from each institution&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.125</span><span class="p">,</span> <span class="s1">&#39;Note: there are some non-disjoint cases in the data.&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">patches</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_height</span><span class="p">()),</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span><span class="o">+</span><span class="mf">.32</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span> <span class="o">+</span> <span class="mi">3</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># create a bar chart with all the filterd_count values</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="s1">&#39;UQ&#39;</span><span class="p">,</span> <span class="s1">&#39;BCTC/QIT/QUT&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">filterd_count_uq</span><span class="p">,</span> <span class="n">filterd_count_bctc</span> <span class="o">+</span> <span class="n">filterd_count_qit</span> <span class="o">+</span> <span class="n">filterd_count_qut</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Count of education records from each institution (combined)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.125</span><span class="p">,</span> <span class="s1">&#39;Note: there are some non-disjoint cases in the data.&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">patches</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_height</span><span class="p">()),</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span><span class="o">+</span><span class="mf">.32</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span> <span class="o">+</span> <span class="mi">3</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Analysis_DAQA_Part2_32_0.png" src="_images/Analysis_DAQA_Part2_32_0.png" />
<img alt="_images/Analysis_DAQA_Part2_32_1.png" src="_images/Analysis_DAQA_Part2_32_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="education-by-period">
<h3>Education by period<a class="headerlink" href="#education-by-period" title="Permalink to this headline">¶</a></h3>
<p>Below are some temporal statistics of education qualification data of people records in the DAQA dataset - but before computing summary statistics the data requires some cleaning. Under the heading <code class="docutils literal notranslate"><span class="pre">DATA</span> <span class="pre">QUALITY</span> <span class="pre">OF</span> <span class="pre">EDUCATION</span> <span class="pre">RECORDS</span></code>, we walk through the applied cleaning steps.</p>
<p>Summary statistics are presented for two periods: before 1940 and between 1940-1980. These outputs can be found under their respective subheadings. Proportions under the <code class="docutils literal notranslate"><span class="pre">1940-1980</span> <span class="pre">EDUCATION</span></code> subheading are calculated as a percentage of the total number of people with education records in the dataset during this period. Proportions under the <code class="docutils literal notranslate"><span class="pre">1940-Present</span> <span class="pre">EDUCATION</span></code> subheading are calculated as a percentage of the total number of people with education records in the dataset during this period.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">###################### DATA QUALITY OF EDUCATION RECORDS ######################&#39;</span><span class="p">)</span>

<span class="n">education_training_df_with_dates</span> <span class="o">=</span> <span class="n">education_training_df</span><span class="p">[</span><span class="n">education_training_df</span><span class="p">[</span><span class="s1">&#39;coverage_range.date_range.date_end.year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">clean_columns_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;organization.name&#39;</span><span class="p">:</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;organization.type&#39;</span><span class="p">:</span> <span class="s1">&#39;type&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;organization.qualification&#39;</span><span class="p">:</span> <span class="s1">&#39;qual&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;coverage_range.place&#39;</span><span class="p">:</span> <span class="s1">&#39;place&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;coverage_range.date_range.date_end.year&#39;</span><span class="p">:</span> <span class="s1">&#39;end_year&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;ori_id&#39;</span><span class="p">:</span> <span class="s1">&#39;ori_id&#39;</span><span class="p">}</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">For some records, the data is messy in terms of the end year for a corresponding education record.&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Below we provide all the eductional records with unconventional values in the end year field&#39;</span><span class="p">)</span>

<span class="n">check_string_len_cond</span> <span class="o">=</span> <span class="p">(</span><span class="n">education_training_df_with_dates</span><span class="p">[</span><span class="s1">&#39;coverage_range.date_range.date_end.year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">education_training_df_with_dates</span><span class="p">[</span><span class="n">check_string_len_cond</span><span class="p">]</span>\
        <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;organization.name&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>\
        <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">clean_columns_dict</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">1. Remove incomplete records. These records do not hold any temporal information.&#39;</span><span class="p">)</span>
<span class="n">disregard_incomplete_records</span> <span class="o">=</span> <span class="p">(</span><span class="n">education_training_df_with_dates</span><span class="p">[</span><span class="s1">&#39;coverage_range.date_range.date_end.year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;incom&#39;</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="n">display</span><span class="p">(</span><span class="n">education_training_df_with_dates</span><span class="p">[</span><span class="n">check_string_len_cond</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">disregard_incomplete_records</span><span class="p">]</span>\
        <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;organization.name&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>\
        <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">clean_columns_dict</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">2. Remove non-numeric suffixal characters such as &quot;?&quot; and &quot;s&quot;. As we are interested in a certain period, granularity is not important.&#39;</span><span class="p">)</span>

<span class="c1"># remove non-numeric characters such as &quot;?&quot; and &quot;s&quot; for the end year field</span>
<span class="n">education_training_df_with_dates</span><span class="p">[</span><span class="s1">&#39;coverage_range.date_range.date_end.year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">education_training_df_with_dates</span><span class="p">[</span><span class="s1">&#39;coverage_range.date_range.date_end.year&#39;</span><span class="p">]</span>\
    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">education_training_df_with_dates</span><span class="p">[</span><span class="n">check_string_len_cond</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">disregard_incomplete_records</span><span class="p">]</span>\
        <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;organization.name&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>\
        <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">clean_columns_dict</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">3. Fix the row with two years separated by a comma. Again as we are interested in a certain period, we can temporarily replace this with the most recent year.&#39;</span><span class="p">)</span>

<span class="c1"># remove non-numeric characters such as &quot;?&quot; and &quot;s&quot; for the end year field</span>
<span class="n">education_training_df_with_dates</span><span class="p">[</span><span class="s1">&#39;coverage_range.date_range.date_end.year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">education_training_df_with_dates</span><span class="p">[</span><span class="s1">&#39;coverage_range.date_range.date_end.year&#39;</span><span class="p">]</span>\
    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;2003, 2008&#39;</span><span class="p">,</span> <span class="s1">&#39;2008&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">education_training_df_with_dates</span><span class="p">[</span><span class="n">check_string_len_cond</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">disregard_incomplete_records</span><span class="p">]</span>\
        <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;organization.name&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>\
        <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">clean_columns_dict</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>###################### DATA QUALITY OF EDUCATION RECORDS ######################

For some records, the data is messy in terms of the end year for a corresponding education record.

Below we provide all the eductional records with unconventional values in the end year field
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>qual</th>
      <th>place</th>
      <th>end_year</th>
      <th>ori_id</th>
      <th>type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>UQ</td>
      <td>BArch</td>
      <td>QLD</td>
      <td>1969?</td>
      <td>117</td>
      <td>UNI</td>
    </tr>
    <tr>
      <th>0</th>
      <td>UQ</td>
      <td>NaN</td>
      <td>QLD</td>
      <td>incomplete</td>
      <td>736</td>
      <td>UNI</td>
    </tr>
    <tr>
      <th>0</th>
      <td>UQ</td>
      <td>DipArch</td>
      <td>QLD</td>
      <td>1945?</td>
      <td>376</td>
      <td>UNI</td>
    </tr>
    <tr>
      <th>1</th>
      <td>UQ</td>
      <td>DipArch</td>
      <td>QLD</td>
      <td>incomplete</td>
      <td>384</td>
      <td>UNI</td>
    </tr>
    <tr>
      <th>0</th>
      <td>UQ</td>
      <td>NaN</td>
      <td>QLD</td>
      <td>incomplete</td>
      <td>254</td>
      <td>UNI</td>
    </tr>
    <tr>
      <th>0</th>
      <td>UQ</td>
      <td>BArch</td>
      <td>Qld</td>
      <td>incomplete</td>
      <td>267</td>
      <td>UNI</td>
    </tr>
    <tr>
      <th>3</th>
      <td>UNSW</td>
      <td>Archives</td>
      <td>NSW</td>
      <td>incomplete</td>
      <td>384</td>
      <td>UNI</td>
    </tr>
    <tr>
      <th>0</th>
      <td>STC</td>
      <td>NaN</td>
      <td>Colle</td>
      <td>incom</td>
      <td>538</td>
      <td>NSW</td>
    </tr>
    <tr>
      <th>2</th>
      <td>QUT, UQ</td>
      <td>PhD (hon)</td>
      <td>QLD</td>
      <td>2003, 2008</td>
      <td>174</td>
      <td>UNI</td>
    </tr>
    <tr>
      <th>0</th>
      <td>QIT</td>
      <td>CERT</td>
      <td>QLD</td>
      <td>1968?</td>
      <td>13</td>
      <td>INSTITUTE</td>
    </tr>
    <tr>
      <th>0</th>
      <td>QIT</td>
      <td>CERT</td>
      <td>QLD</td>
      <td>1968?</td>
      <td>10</td>
      <td>INSTITUTE</td>
    </tr>
    <tr>
      <th>0</th>
      <td>QIT</td>
      <td>CERT</td>
      <td>QLD</td>
      <td>1968?</td>
      <td>14</td>
      <td>INSTITUTE</td>
    </tr>
    <tr>
      <th>0</th>
      <td>QIT</td>
      <td>DipArch</td>
      <td>QLD</td>
      <td>1979?</td>
      <td>380</td>
      <td>COLLEGE</td>
    </tr>
    <tr>
      <th>0</th>
      <td>NANGLE IoT</td>
      <td>DipArch</td>
      <td>SYDNEY</td>
      <td>1960s</td>
      <td>355</td>
      <td>DISTANCE EDUCATION</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Melbourne</td>
      <td>BArch</td>
      <td>VIC</td>
      <td>1939?</td>
      <td>349</td>
      <td>UNI</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Durhan</td>
      <td>Landscape</td>
      <td>UK</td>
      <td>1965?</td>
      <td>713</td>
      <td>UNI</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Budapest</td>
      <td>NaN</td>
      <td>Hungary</td>
      <td>incomplete</td>
      <td>584</td>
      <td>UNI</td>
    </tr>
    <tr>
      <th>0</th>
      <td>BCTC</td>
      <td>CertArch</td>
      <td>QLD</td>
      <td>1961?</td>
      <td>627</td>
      <td>COLLEGE</td>
    </tr>
    <tr>
      <th>0</th>
      <td>BCTC</td>
      <td>BArch</td>
      <td>QLD</td>
      <td>incomplete</td>
      <td>273</td>
      <td>COLLEGE</td>
    </tr>
    <tr>
      <th>0</th>
      <td>AA</td>
      <td>DipArch</td>
      <td>UK</td>
      <td>1890?</td>
      <td>636</td>
      <td>INDEPENDENT</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>BACHELOR OF ARCHITECTURE</td>
      <td>NaN</td>
      <td>1968?</td>
      <td>4</td>
      <td>UNI</td>
    </tr>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vienna</td>
      <td>1940s</td>
      <td>166</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1. Remove incomplete records. These records do not hold any temporal information.
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>qual</th>
      <th>place</th>
      <th>end_year</th>
      <th>ori_id</th>
      <th>type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>UQ</td>
      <td>BArch</td>
      <td>QLD</td>
      <td>1969?</td>
      <td>117</td>
      <td>UNI</td>
    </tr>
    <tr>
      <th>0</th>
      <td>UQ</td>
      <td>DipArch</td>
      <td>QLD</td>
      <td>1945?</td>
      <td>376</td>
      <td>UNI</td>
    </tr>
    <tr>
      <th>2</th>
      <td>QUT, UQ</td>
      <td>PhD (hon)</td>
      <td>QLD</td>
      <td>2003, 2008</td>
      <td>174</td>
      <td>UNI</td>
    </tr>
    <tr>
      <th>0</th>
      <td>QIT</td>
      <td>DipArch</td>
      <td>QLD</td>
      <td>1979?</td>
      <td>380</td>
      <td>COLLEGE</td>
    </tr>
    <tr>
      <th>0</th>
      <td>QIT</td>
      <td>CERT</td>
      <td>QLD</td>
      <td>1968?</td>
      <td>13</td>
      <td>INSTITUTE</td>
    </tr>
    <tr>
      <th>0</th>
      <td>QIT</td>
      <td>CERT</td>
      <td>QLD</td>
      <td>1968?</td>
      <td>14</td>
      <td>INSTITUTE</td>
    </tr>
    <tr>
      <th>0</th>
      <td>QIT</td>
      <td>CERT</td>
      <td>QLD</td>
      <td>1968?</td>
      <td>10</td>
      <td>INSTITUTE</td>
    </tr>
    <tr>
      <th>0</th>
      <td>NANGLE IoT</td>
      <td>DipArch</td>
      <td>SYDNEY</td>
      <td>1960s</td>
      <td>355</td>
      <td>DISTANCE EDUCATION</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Melbourne</td>
      <td>BArch</td>
      <td>VIC</td>
      <td>1939?</td>
      <td>349</td>
      <td>UNI</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Durhan</td>
      <td>Landscape</td>
      <td>UK</td>
      <td>1965?</td>
      <td>713</td>
      <td>UNI</td>
    </tr>
    <tr>
      <th>0</th>
      <td>BCTC</td>
      <td>CertArch</td>
      <td>QLD</td>
      <td>1961?</td>
      <td>627</td>
      <td>COLLEGE</td>
    </tr>
    <tr>
      <th>0</th>
      <td>AA</td>
      <td>DipArch</td>
      <td>UK</td>
      <td>1890?</td>
      <td>636</td>
      <td>INDEPENDENT</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>BACHELOR OF ARCHITECTURE</td>
      <td>NaN</td>
      <td>1968?</td>
      <td>4</td>
      <td>UNI</td>
    </tr>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vienna</td>
      <td>1940s</td>
      <td>166</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2. Remove non-numeric suffixal characters such as &quot;?&quot; and &quot;s&quot;. As we are interested in a certain period, granularity is not important.
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>qual</th>
      <th>place</th>
      <th>end_year</th>
      <th>ori_id</th>
      <th>type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>UQ</td>
      <td>BArch</td>
      <td>QLD</td>
      <td>1969</td>
      <td>117</td>
      <td>UNI</td>
    </tr>
    <tr>
      <th>0</th>
      <td>UQ</td>
      <td>DipArch</td>
      <td>QLD</td>
      <td>1945</td>
      <td>376</td>
      <td>UNI</td>
    </tr>
    <tr>
      <th>2</th>
      <td>QUT, UQ</td>
      <td>PhD (hon)</td>
      <td>QLD</td>
      <td>2003, 2008</td>
      <td>174</td>
      <td>UNI</td>
    </tr>
    <tr>
      <th>0</th>
      <td>QIT</td>
      <td>DipArch</td>
      <td>QLD</td>
      <td>1979</td>
      <td>380</td>
      <td>COLLEGE</td>
    </tr>
    <tr>
      <th>0</th>
      <td>QIT</td>
      <td>CERT</td>
      <td>QLD</td>
      <td>1968</td>
      <td>13</td>
      <td>INSTITUTE</td>
    </tr>
    <tr>
      <th>0</th>
      <td>QIT</td>
      <td>CERT</td>
      <td>QLD</td>
      <td>1968</td>
      <td>14</td>
      <td>INSTITUTE</td>
    </tr>
    <tr>
      <th>0</th>
      <td>QIT</td>
      <td>CERT</td>
      <td>QLD</td>
      <td>1968</td>
      <td>10</td>
      <td>INSTITUTE</td>
    </tr>
    <tr>
      <th>0</th>
      <td>NANGLE IoT</td>
      <td>DipArch</td>
      <td>SYDNEY</td>
      <td>1960</td>
      <td>355</td>
      <td>DISTANCE EDUCATION</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Melbourne</td>
      <td>BArch</td>
      <td>VIC</td>
      <td>1939</td>
      <td>349</td>
      <td>UNI</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Durhan</td>
      <td>Landscape</td>
      <td>UK</td>
      <td>1965</td>
      <td>713</td>
      <td>UNI</td>
    </tr>
    <tr>
      <th>0</th>
      <td>BCTC</td>
      <td>CertArch</td>
      <td>QLD</td>
      <td>1961</td>
      <td>627</td>
      <td>COLLEGE</td>
    </tr>
    <tr>
      <th>0</th>
      <td>AA</td>
      <td>DipArch</td>
      <td>UK</td>
      <td>1890</td>
      <td>636</td>
      <td>INDEPENDENT</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>BACHELOR OF ARCHITECTURE</td>
      <td>NaN</td>
      <td>1968</td>
      <td>4</td>
      <td>UNI</td>
    </tr>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vienna</td>
      <td>1940</td>
      <td>166</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3. Fix the row with two years separated by a comma. Again as we are interested in a certain period, we can temporarily replace this with the most recent year.
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>qual</th>
      <th>place</th>
      <th>end_year</th>
      <th>ori_id</th>
      <th>type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>UQ</td>
      <td>BArch</td>
      <td>QLD</td>
      <td>1969</td>
      <td>117</td>
      <td>UNI</td>
    </tr>
    <tr>
      <th>0</th>
      <td>UQ</td>
      <td>DipArch</td>
      <td>QLD</td>
      <td>1945</td>
      <td>376</td>
      <td>UNI</td>
    </tr>
    <tr>
      <th>2</th>
      <td>QUT, UQ</td>
      <td>PhD (hon)</td>
      <td>QLD</td>
      <td>2008</td>
      <td>174</td>
      <td>UNI</td>
    </tr>
    <tr>
      <th>0</th>
      <td>QIT</td>
      <td>DipArch</td>
      <td>QLD</td>
      <td>1979</td>
      <td>380</td>
      <td>COLLEGE</td>
    </tr>
    <tr>
      <th>0</th>
      <td>QIT</td>
      <td>CERT</td>
      <td>QLD</td>
      <td>1968</td>
      <td>13</td>
      <td>INSTITUTE</td>
    </tr>
    <tr>
      <th>0</th>
      <td>QIT</td>
      <td>CERT</td>
      <td>QLD</td>
      <td>1968</td>
      <td>14</td>
      <td>INSTITUTE</td>
    </tr>
    <tr>
      <th>0</th>
      <td>QIT</td>
      <td>CERT</td>
      <td>QLD</td>
      <td>1968</td>
      <td>10</td>
      <td>INSTITUTE</td>
    </tr>
    <tr>
      <th>0</th>
      <td>NANGLE IoT</td>
      <td>DipArch</td>
      <td>SYDNEY</td>
      <td>1960</td>
      <td>355</td>
      <td>DISTANCE EDUCATION</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Melbourne</td>
      <td>BArch</td>
      <td>VIC</td>
      <td>1939</td>
      <td>349</td>
      <td>UNI</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Durhan</td>
      <td>Landscape</td>
      <td>UK</td>
      <td>1965</td>
      <td>713</td>
      <td>UNI</td>
    </tr>
    <tr>
      <th>0</th>
      <td>BCTC</td>
      <td>CertArch</td>
      <td>QLD</td>
      <td>1961</td>
      <td>627</td>
      <td>COLLEGE</td>
    </tr>
    <tr>
      <th>0</th>
      <td>AA</td>
      <td>DipArch</td>
      <td>UK</td>
      <td>1890</td>
      <td>636</td>
      <td>INDEPENDENT</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>BACHELOR OF ARCHITECTURE</td>
      <td>NaN</td>
      <td>1968</td>
      <td>4</td>
      <td>UNI</td>
    </tr>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Vienna</td>
      <td>1940</td>
      <td>166</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">###################### 1940-1980 EDUCATION ######################&#39;</span><span class="p">)</span>

<span class="c1"># clean year data for temporal analysis</span>
<span class="n">education_training_df_with_clean_dates</span> <span class="o">=</span> <span class="n">education_training_df_with_dates</span><span class="p">[</span><span class="o">~</span><span class="n">check_string_len_cond</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">education_training_df_with_clean_dates</span> <span class="o">=</span> <span class="n">education_training_df_with_clean_dates</span>\
    <span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">education_training_df_with_dates</span><span class="p">[</span><span class="n">check_string_len_cond</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">disregard_incomplete_records</span><span class="p">])</span>

<span class="n">education_training_df_with_clean_dates</span><span class="p">[</span><span class="s1">&#39;coverage_range.date_range.date_end.year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">education_training_df_with_clean_dates</span><span class="p">[</span><span class="s1">&#39;coverage_range.date_range.date_end.year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="n">education_training_df_1940_1980</span> <span class="o">=</span> <span class="n">education_training_df_with_clean_dates</span><span class="p">[(</span><span class="n">education_training_df_with_clean_dates</span><span class="p">[</span><span class="s1">&#39;coverage_range.date_range.date_end.year&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">1940</span><span class="p">)</span> <span class="o">&amp;</span> \
                                                                   <span class="p">(</span><span class="n">education_training_df_with_clean_dates</span><span class="p">[</span><span class="s1">&#39;coverage_range.date_range.date_end.year&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">1980</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: How many education records exist in DAQA between 1940-1980?&#39;</span><span class="p">)</span>
<span class="n">count_ed_records_1940_1980</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">education_training_df_1940_1980</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: There are </span><span class="si">{</span><span class="n">count_ed_records_1940_1980</span><span class="si">}</span><span class="s1"> education records between 1940-1980.&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: How many education records exist from UQ between 1940-1980?&#39;</span><span class="p">)</span>
<span class="n">count_ed_records_1940_1980_uq</span> <span class="o">=</span> <span class="n">print_filtered_data</span><span class="p">(</span><span class="n">education_training_df_1940_1980</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;UQ&#39;</span><span class="p">],</span> <span class="n">display_output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">prop_ed_records_1940_1980_uq</span> <span class="o">=</span> <span class="n">count_ed_records_1940_1980_uq</span> <span class="o">/</span> <span class="n">count_ed_records_1940_1980</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: There are </span><span class="si">{</span><span class="n">count_ed_records_1940_1980_uq</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">prop_ed_records_1940_1980_uq</span><span class="si">:</span><span class="s1">.2%</span><span class="si">}</span><span class="s1">) education records from UQ between 1940-1980.&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: How many education records exist from BCTC/QIT/QIT between 1940-1980?&#39;</span><span class="p">)</span>
<span class="n">count_ed_records_1940_1980_rest</span> <span class="o">=</span> <span class="n">print_filtered_data</span><span class="p">(</span><span class="n">education_training_df_1940_1980</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;BCTC&#39;</span><span class="p">,</span> <span class="s1">&#39;QIT&#39;</span><span class="p">,</span> <span class="s1">&#39;QUT&#39;</span><span class="p">,</span><span class="s1">&#39;BRISBANE&#39;</span><span class="p">],</span> <span class="n">display_output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">prop_ed_records_1940_1980_rest</span> <span class="o">=</span> <span class="n">count_ed_records_1940_1980_rest</span> <span class="o">/</span> <span class="n">count_ed_records_1940_1980</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: There are </span><span class="si">{</span><span class="n">count_ed_records_1940_1980_rest</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">prop_ed_records_1940_1980_rest</span><span class="si">:</span><span class="s1">.2%</span><span class="si">}</span><span class="s1">) education records from BCTC/QIT/QUT between 1940-1980.&#39;</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">###################### 1940-Present EDUCATION ######################&#39;</span><span class="p">)</span>

<span class="c1"># remove rows with more than 4 characters in string</span>
<span class="n">education_training_df_1940_present</span> <span class="o">=</span> <span class="n">education_training_df_with_clean_dates</span><span class="p">[(</span><span class="n">education_training_df_with_clean_dates</span><span class="p">[</span><span class="s1">&#39;coverage_range.date_range.date_end.year&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">1940</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: How many education records exist in DAQA between 1940-Present?&#39;</span><span class="p">)</span>
<span class="n">count_ed_records_1940_present</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">education_training_df_1940_present</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: There are </span><span class="si">{</span><span class="n">count_ed_records_1940_present</span><span class="si">}</span><span class="s1"> education records between 1940-Present.&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: How many education records exist from UQ between 1940-Present?&#39;</span><span class="p">)</span>
<span class="n">count_ed_records_1940_present_uq</span> <span class="o">=</span> <span class="n">print_filtered_data</span><span class="p">(</span><span class="n">education_training_df_1940_present</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;UQ&#39;</span><span class="p">],</span> <span class="n">display_output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">prop_ed_records_1940_present_uq</span> <span class="o">=</span> <span class="n">count_ed_records_1940_present_uq</span> <span class="o">/</span> <span class="n">count_ed_records_1940_present</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: There are </span><span class="si">{</span><span class="n">count_ed_records_1940_present_uq</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">prop_ed_records_1940_present_uq</span><span class="si">:</span><span class="s1">.2%</span><span class="si">}</span><span class="s1">) education records from UQ between 1940-Present.&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: How many education records exist from BCTC/QIT/QIT between 1940-Present?&#39;</span><span class="p">)</span>
<span class="n">count_ed_records_1940_present_rest</span> <span class="o">=</span> <span class="n">print_filtered_data</span><span class="p">(</span><span class="n">education_training_df_1940_present</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;BCTC&#39;</span><span class="p">,</span> <span class="s1">&#39;QIT&#39;</span><span class="p">,</span> <span class="s1">&#39;QUT&#39;</span><span class="p">,</span><span class="s1">&#39;BRISBANE&#39;</span><span class="p">],</span> <span class="n">display_output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">prop_ed_records_1940_present_rest</span> <span class="o">=</span> <span class="n">count_ed_records_1940_present_rest</span> <span class="o">/</span> <span class="n">count_ed_records_1940_present</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: There are </span><span class="si">{</span><span class="n">count_ed_records_1940_present_rest</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">prop_ed_records_1940_present_rest</span><span class="si">:</span><span class="s1">.2%</span><span class="si">}</span><span class="s1">) education records from BCTC/QIT/QUT between 1940-Present.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>###################### 1940-1980 EDUCATION ######################

Q: How many education records exist in DAQA between 1940-1980?
A: There are 158 education records between 1940-1980.

Q: How many education records exist from UQ between 1940-1980?
A: There are 83 (52.53%) education records from UQ between 1940-1980.

Q: How many education records exist from BCTC/QIT/QIT between 1940-1980?
A: There are 42 (26.58%) education records from BCTC/QIT/QUT between 1940-1980.

###################### 1940-Present EDUCATION ######################

Q: How many education records exist in DAQA between 1940-Present?
A: There are 193 education records between 1940-Present.

Q: How many education records exist from UQ between 1940-Present?
A: There are 98 (50.78%) education records from UQ between 1940-Present.

Q: How many education records exist from BCTC/QIT/QIT between 1940-Present?
A: There are 57 (29.53%) education records from BCTC/QIT/QUT between 1940-Present.
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="persons-with-related-works">
<h2>Persons with related works<a class="headerlink" href="#persons-with-related-works" title="Permalink to this headline">¶</a></h2>
<p>In this section, we explore project activity of people in DAQA. We start by first categorising people into five groups: People with one related work, 2-3 works, 4-10 works, 11-50 works, and +50 works. We then visualise the distribution of these categories. We are particulatly interested in architects with more than 50 related works.</p>
<p>Given the distribution, we also explore the presence of the Pareto principle - in other words, are a majority of completed projects related to only a small number of architects? We plot the cumulative distribution of architects and their related works.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load data</span>
<span class="n">daqa_persons_with_related_works</span> <span class="o">=</span> <span class="n">daqa_persons</span><span class="p">[</span><span class="n">daqa_persons</span><span class="p">[</span><span class="s1">&#39;related_works&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">related_works_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">daqa_persons_with_related_works</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">related_works_raw</span> <span class="o">=</span> <span class="n">related_works_raw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;related_works&#39;</span><span class="p">])))</span>

<span class="c1"># get all person ids with related works</span>
<span class="n">related_works_raw</span> <span class="o">=</span> <span class="n">related_works_raw</span><span class="p">[[</span><span class="s1">&#39;relation_class&#39;</span><span class="p">,</span><span class="s1">&#39;subject.ori_id&#39;</span><span class="p">,</span><span class="s1">&#39;object.ori_id&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>

<span class="n">Person_RelatedWork_cond</span> <span class="o">=</span> <span class="p">(</span><span class="n">related_works_raw</span><span class="p">[</span><span class="s1">&#39;relation_class&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Person_RelatedWork&#39;</span><span class="p">)</span>
<span class="n">Work_RelatedPerson_cond</span> <span class="o">=</span> <span class="p">(</span><span class="n">related_works_raw</span><span class="p">[</span><span class="s1">&#39;relation_class&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Work_RelatedPerson&#39;</span><span class="p">)</span>

<span class="n">person_ids_related_works</span> <span class="o">=</span> <span class="n">related_works_raw</span><span class="p">[</span><span class="n">Person_RelatedWork_cond</span><span class="p">][</span><span class="s1">&#39;subject.ori_id&#39;</span><span class="p">]</span>\
    <span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;subject.ori_id&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span>\
    <span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">related_works_raw</span><span class="p">[</span><span class="n">Work_RelatedPerson_cond</span><span class="p">][</span><span class="s1">&#39;object.ori_id&#39;</span><span class="p">]</span>\
            <span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;object.ori_id&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">}))</span>

<span class="n">person_ids_related_works</span> <span class="o">=</span> <span class="n">person_ids_related_works</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="n">person_ids_related_works</span><span class="p">[</span><span class="s1">&#39;count_cat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">person_ids_related_works</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">),</span> <span class="n">person_ids_related_works</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">],</span>
                                <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">person_ids_related_works</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">),</span><span class="s1">&#39;2-3&#39;</span><span class="p">,</span>
                                <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">person_ids_related_works</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">),</span><span class="s1">&#39;4-10&#39;</span><span class="p">,</span>
                                <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">person_ids_related_works</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">50</span><span class="p">),</span><span class="s1">&#39;11-50&#39;</span><span class="p">,</span><span class="s1">&#39;+50&#39;</span><span class="p">))))</span>


<span class="c1"># plot horizontal bar chart</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">person_ids_related_works</span><span class="p">[</span><span class="s1">&#39;count_cat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;2-3&#39;</span><span class="p">,</span><span class="s1">&#39;4-10&#39;</span><span class="p">,</span><span class="s1">&#39;11-50&#39;</span><span class="p">,</span><span class="s1">&#39;+50&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>\
    <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;barh&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Number of (unique) Related Works per Person&#39;</span><span class="p">)</span>

<span class="c1"># add bar labels with proportions</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">patches</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">p</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">p</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">person_ids_related_works</span><span class="p">)</span><span class="si">:</span><span class="s1">.2%</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span><span class="o">+</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">get_y</span><span class="p">()</span><span class="o">+</span><span class="mf">0.15</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># increase x-axis</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">110</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: Who has 50 or more related works?&#39;</span><span class="p">)</span>
<span class="n">person_ids_with_over50works</span> <span class="o">=</span> <span class="n">person_ids_related_works</span><span class="p">[</span><span class="n">person_ids_related_works</span><span class="p">[</span><span class="s1">&#39;count_cat&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;+50&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">top_six</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">daqa_persons</span><span class="p">[</span><span class="n">daqa_persons</span><span class="p">[</span><span class="s1">&#39;ori_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">person_ids_with_over50works</span><span class="p">)][[</span><span class="s1">&#39;ori_id&#39;</span><span class="p">,</span><span class="s1">&#39;display_name&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ori_id&#39;</span><span class="p">:</span> <span class="s1">&#39;id&#39;</span><span class="p">}),</span>
         <span class="n">person_ids_related_works</span><span class="p">[</span><span class="n">person_ids_related_works</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">person_ids_with_over50works</span><span class="p">)],</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>

<span class="c1"># get person records with 50 or more related works</span>
<span class="n">display</span><span class="p">(</span><span class="n">top_six</span><span class="p">[[</span><span class="s1">&#39;display_name&#39;</span><span class="p">,</span><span class="s1">&#39;count&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">###################### PARETO PRINCIPLE ######################&#39;</span><span class="p">)</span>

<span class="c1">#check for pareto principle</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Number of projects&quot;</span><span class="p">:</span> <span class="n">person_ids_related_works</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">})</span>

<span class="c1"># Add cumulative percentage column</span>
<span class="n">samples</span><span class="p">[</span><span class="s2">&quot;cum_percentage&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="s2">&quot;Number of projects&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span><span class="o">/</span><span class="n">samples</span><span class="p">[</span><span class="s2">&quot;Number of projects&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Set figure and axis</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="c1"># Plot bars (i.e. frequencies)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">samples</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">samples</span><span class="p">[</span><span class="s2">&quot;Number of projects&quot;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Pareto-like distribution&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Architects (ordered by related work frequency)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Frequency&quot;</span><span class="p">)</span>

<span class="c1"># Second y axis (i.e. cumulative percentage)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">samples</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">samples</span><span class="p">[</span><span class="s2">&quot;cum_percentage&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">77</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">PercentFormatter</span><span class="p">())</span>

<span class="c1"># add more ticks to y axis</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">75</span><span class="p">,</span><span class="mi">100</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Cumulative Percentage&quot;</span><span class="p">)</span>

<span class="c1"># color regions on the x-axis</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>

<span class="c1"># add an annotation for the 80% line</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;25</span><span class="si">% o</span><span class="s1">f architects (70)&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;77</span><span class="si">% o</span><span class="s1">f completed projects (1628)&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">195</span><span class="p">,</span> <span class="mi">79</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Analysis_DAQA_Part2_37_0.png" src="_images/Analysis_DAQA_Part2_37_0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Q: Who has 50 or more related works?
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>display_name</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>###################### PARETO PRINCIPLE ######################
</pre></div>
</div>
<img alt="_images/Analysis_DAQA_Part2_37_4.png" src="_images/Analysis_DAQA_Part2_37_4.png" />
</div>
</div>
<blockquote class="epigraph">
<div><p>25% of architects are related to 77% of the completed projects.</p>
</div></blockquote>
<div class="section" id="persons-with-related-works-1940-1980">
<h3>Persons with related works (1940-1980)<a class="headerlink" href="#persons-with-related-works-1940-1980" title="Permalink to this headline">¶</a></h3>
<p>We now explore the frequency of completed projects over time specifically between 1940 and 1980. We also visualise the frequency of completed projects by architects with more than 50 related works with the rest of the architects.</p>
<p>Out of the top six architects, we can see that <code class="docutils literal notranslate"><span class="pre">Lange</span> <span class="pre">Powell</span></code> and <code class="docutils literal notranslate"><span class="pre">Rex</span> <span class="pre">Addison</span></code> are not very active during this period with 0 and 20 projects respectively. We provide a breakdown for these two architects to understand which period they were most active in.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###################### PERSONS WITH RELATED WORK (1940-1980) ######################</span>
<span class="n">all_completion_dates</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">all_completion_with_name</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span><span class="n">row</span> <span class="ow">in</span> <span class="n">daqawork_1940_80</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">comp_date</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;coverage_range&#39;</span><span class="p">]))[</span><span class="s1">&#39;date_range.date_end.year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">all_completion_dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comp_date</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span> <span class="n">this_work</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;related_people&#39;</span><span class="p">]))[[</span><span class="s1">&#39;subject.label&#39;</span><span class="p">,</span><span class="s1">&#39;object.ori_id&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span> <span class="n">this_work</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;subject.label&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;object.ori_id&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ori_id&#39;</span><span class="p">]},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">this_work</span><span class="p">[</span><span class="s1">&#39;comp_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp_date</span>
    <span class="n">all_completion_with_name</span> <span class="o">=</span> <span class="n">all_completion_with_name</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_work</span><span class="p">)</span>


<span class="n">total_completions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">all_completion_dates</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>\
<span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>\
<span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
<span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;index&#39;</span><span class="p">:</span><span class="s1">&#39;Completion Date&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="s1">&#39;Frequency&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>\
<span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Completion Date&#39;</span><span class="p">)</span>

<span class="c1"># make interactive line plot, set figure size to 1000x500</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">total_completions</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Completion Date&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Total number of completed works by year, 1940-1980&#39;</span><span class="p">,</span> 
<span class="n">width</span><span class="o">=</span><span class="mi">900</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">color_discrete_sequence</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;steelblue&#39;</span><span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">55</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">###################### 1940-1980 - TOP 6 vs REST ######################&#39;</span><span class="p">)</span>
<span class="n">top_six_ls</span> <span class="o">=</span> <span class="n">top_six</span><span class="p">[</span><span class="s1">&#39;display_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>

<span class="n">rest_completions</span> <span class="o">=</span> <span class="n">all_completion_with_name</span><span class="p">[</span><span class="o">~</span><span class="n">all_completion_with_name</span><span class="p">[</span><span class="s1">&#39;subject.label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">top_six_ls</span><span class="p">)][</span><span class="s1">&#39;comp_date&#39;</span><span class="p">]</span>\
<span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>\
<span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
<span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;index&#39;</span><span class="p">:</span><span class="s1">&#39;Completion Date&#39;</span><span class="p">,</span><span class="s1">&#39;comp_date&#39;</span><span class="p">:</span><span class="s1">&#39;Frequency&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>\
<span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Completion Date&#39;</span><span class="p">)</span>
<span class="n">rest_completions</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Rest&#39;</span>

<span class="n">lp_completions</span> <span class="o">=</span> <span class="n">all_completion_with_name</span><span class="p">[</span><span class="n">all_completion_with_name</span><span class="p">[</span><span class="s1">&#39;subject.label&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Lange Powell&#39;</span><span class="p">][</span><span class="s1">&#39;comp_date&#39;</span><span class="p">]</span>\
<span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>\
<span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
<span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;index&#39;</span><span class="p">:</span><span class="s1">&#39;Completion Date&#39;</span><span class="p">,</span><span class="s1">&#39;comp_date&#39;</span><span class="p">:</span><span class="s1">&#39;Frequency&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>\
<span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Completion Date&#39;</span><span class="p">)</span>
<span class="n">lp_completions</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Lange Powell&#39;</span>

<span class="n">rg_completions</span> <span class="o">=</span> <span class="n">all_completion_with_name</span><span class="p">[</span><span class="n">all_completion_with_name</span><span class="p">[</span><span class="s1">&#39;subject.label&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Robin Gibson&#39;</span><span class="p">][</span><span class="s1">&#39;comp_date&#39;</span><span class="p">]</span>\
<span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>\
<span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
<span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;index&#39;</span><span class="p">:</span><span class="s1">&#39;Completion Date&#39;</span><span class="p">,</span><span class="s1">&#39;comp_date&#39;</span><span class="p">:</span><span class="s1">&#39;Frequency&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>\
<span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Completion Date&#39;</span><span class="p">)</span>
<span class="n">rg_completions</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Robin Gibson&#39;</span>

<span class="n">jd_completions</span> <span class="o">=</span> <span class="n">all_completion_with_name</span><span class="p">[</span><span class="n">all_completion_with_name</span><span class="p">[</span><span class="s1">&#39;subject.label&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;John Dalton&#39;</span><span class="p">][</span><span class="s1">&#39;comp_date&#39;</span><span class="p">]</span>\
<span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>\
<span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
<span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;index&#39;</span><span class="p">:</span><span class="s1">&#39;Completion Date&#39;</span><span class="p">,</span><span class="s1">&#39;comp_date&#39;</span><span class="p">:</span><span class="s1">&#39;Frequency&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>\
<span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Completion Date&#39;</span><span class="p">)</span>
<span class="n">jd_completions</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;John Dalton&#39;</span>

<span class="n">gb_completions</span> <span class="o">=</span> <span class="n">all_completion_with_name</span><span class="p">[</span><span class="n">all_completion_with_name</span><span class="p">[</span><span class="s1">&#39;subject.label&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Graham W. Bligh&#39;</span><span class="p">][</span><span class="s1">&#39;comp_date&#39;</span><span class="p">]</span>\
<span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>\
<span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
<span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;index&#39;</span><span class="p">:</span><span class="s1">&#39;Completion Date&#39;</span><span class="p">,</span><span class="s1">&#39;comp_date&#39;</span><span class="p">:</span><span class="s1">&#39;Frequency&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>\
<span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Completion Date&#39;</span><span class="p">)</span>
<span class="n">gb_completions</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Graham Bligh&#39;</span>

<span class="n">kl_completions</span> <span class="o">=</span> <span class="n">all_completion_with_name</span><span class="p">[</span><span class="n">all_completion_with_name</span><span class="p">[</span><span class="s1">&#39;subject.label&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Karl Langer&#39;</span><span class="p">][</span><span class="s1">&#39;comp_date&#39;</span><span class="p">]</span>\
<span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>\
<span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
<span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;index&#39;</span><span class="p">:</span><span class="s1">&#39;Completion Date&#39;</span><span class="p">,</span><span class="s1">&#39;comp_date&#39;</span><span class="p">:</span><span class="s1">&#39;Frequency&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>\
<span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Completion Date&#39;</span><span class="p">)</span>
<span class="n">kl_completions</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Karl Langer&#39;</span>

<span class="n">ra_completions</span> <span class="o">=</span> <span class="n">all_completion_with_name</span><span class="p">[</span><span class="n">all_completion_with_name</span><span class="p">[</span><span class="s1">&#39;subject.label&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Rex Addison&#39;</span><span class="p">][</span><span class="s1">&#39;comp_date&#39;</span><span class="p">]</span>\
<span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>\
<span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
<span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;index&#39;</span><span class="p">:</span><span class="s1">&#39;Completion Date&#39;</span><span class="p">,</span><span class="s1">&#39;comp_date&#39;</span><span class="p">:</span><span class="s1">&#39;Frequency&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>\
<span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Completion Date&#39;</span><span class="p">)</span>
<span class="n">ra_completions</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Rex Addison&#39;</span>

<span class="n">allcompletions</span> <span class="o">=</span> <span class="n">rest_completions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lp_completions</span><span class="p">)</span>
<span class="n">allcompletions</span> <span class="o">=</span> <span class="n">allcompletions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rg_completions</span><span class="p">)</span>
<span class="n">allcompletions</span> <span class="o">=</span> <span class="n">allcompletions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">jd_completions</span><span class="p">)</span>
<span class="n">allcompletions</span> <span class="o">=</span> <span class="n">allcompletions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gb_completions</span><span class="p">)</span>
<span class="n">allcompletions</span> <span class="o">=</span> <span class="n">allcompletions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kl_completions</span><span class="p">)</span>
<span class="n">allcompletions</span> <span class="o">=</span> <span class="n">allcompletions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ra_completions</span><span class="p">)</span>

<span class="c1"># get a table of the sum of the frequency column for each architect</span>
<span class="n">allcompletions</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;&#39;</span><span class="p">:</span><span class="s1">&#39;Architect&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">allcompletions</span>\
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Architect&#39;</span><span class="p">)[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">]</span>\
    <span class="o">.</span><span class="n">sum</span><span class="p">()</span>\
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
    <span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;Architect&#39;</span><span class="p">:</span><span class="s1">&#39;Lange Powell&#39;</span><span class="p">,</span> <span class="s1">&#39;Frequency&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">},</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Architect&#39;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">T</span><span class="p">)</span>

<span class="c1"># plot interactive time series for each architect</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">allcompletions</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Completion Date&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span> 
<span class="n">title</span><span class="o">=</span><span class="s1">&#39;Total number of (completed) works by year, most active architects vs. rest, 1940-1980</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="n">width</span><span class="o">=</span><span class="mi">900</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;Architect&#39;</span><span class="p">)</span>

<span class="c1"># move legend to top</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
    <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">,</span>
    <span class="n">yanchor</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">,</span>
    <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="kc">None</span>
<span class="p">))</span>

<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>###################### 1940-1980 - TOP 6 vs REST ######################
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Architect</th>
      <th>Rest</th>
      <th>John Dalton</th>
      <th>Robin Gibson</th>
      <th>Graham Bligh</th>
      <th>Karl Langer</th>
      <th>Rex Addison</th>
      <th>Lange Powell</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Frequency</th>
      <td>730</td>
      <td>63</td>
      <td>44</td>
      <td>40</td>
      <td>39</td>
      <td>20</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">###################### WHERE IS LANGE POWELL? ######################&#39;</span><span class="p">)</span>

<span class="n">langepowell_relatedworks</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">daqa_persons</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">daqa_persons</span><span class="p">[</span><span class="s1">&#39;display_name&#39;</span><span class="p">]</span>\
    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Powell&#39;</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">)][</span><span class="s1">&#39;related_works&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]))[</span><span class="s1">&#39;object.ori_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">langepowell_relatedworks_years</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="n">daqa_work</span><span class="p">[</span><span class="n">daqa_work</span><span class="p">[</span><span class="s1">&#39;ori_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">langepowell_relatedworks</span><span class="p">)]</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span> 
        <span class="n">this_yr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;coverage_range&#39;</span><span class="p">]))[</span><span class="s1">&#39;date_range.date_end.year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">langepowell_relatedworks_years</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">this_yr</span><span class="p">)[:</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;0&#39;</span><span class="p">))</span>
    <span class="k">except</span><span class="p">:</span> <span class="k">pass</span>

<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">langepowell_relatedworks_years</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>\
    <span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>\
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;index&#39;</span><span class="p">:</span><span class="s1">&#39;decade&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="s1">&#39;count&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;decade&#39;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>###################### WHERE IS LANGE POWELL? ######################
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>decade</th>
      <th>1820</th>
      <th>1910</th>
      <th>1920</th>
      <th>1930</th>
      <th>2010</th>
      <th>2020</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1</td>
      <td>29</td>
      <td>76</td>
      <td>32</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">###################### WHERE IS REX ADDISON? ######################&#39;</span><span class="p">)</span>

<span class="n">rex_addison_relatedworks</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">daqa_persons</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">daqa_persons</span><span class="p">[</span><span class="s1">&#39;display_name&#39;</span><span class="p">]</span>\
    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Rex Addison&#39;</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">)][</span><span class="s1">&#39;related_works&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]))[</span><span class="s1">&#39;object.ori_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">rex_addison_relatedworks_years</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="n">daqa_work</span><span class="p">[</span><span class="n">daqa_work</span><span class="p">[</span><span class="s1">&#39;ori_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">rex_addison_relatedworks</span><span class="p">)]</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span> 
        <span class="n">this_yr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;coverage_range&#39;</span><span class="p">]))[</span><span class="s1">&#39;date_range.date_end.year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">rex_addison_relatedworks_years</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">this_yr</span><span class="p">)[:</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;0&#39;</span><span class="p">))</span>
    <span class="k">except</span><span class="p">:</span> <span class="k">pass</span>

<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rex_addison_relatedworks_years</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>\
    <span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>\
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;index&#39;</span><span class="p">:</span><span class="s1">&#39;decade&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="s1">&#39;count&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;decade&#39;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>###################### WHERE IS REX ADDISON? ######################
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>decade</th>
      <th>1960</th>
      <th>1970</th>
      <th>1980</th>
      <th>1990</th>
      <th>2000</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>4</td>
      <td>14</td>
      <td>25</td>
      <td>4</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<br>
<p>We continue our analysis during this period by identiyfing the most active architects and most active firms. We list below the top 20 for each respective entity.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;###################### ARCHITECTS WITH THE HIGHEST NUMBER OF ASSOCIATED PROJECTS (1940-1980) ######################&#39;</span><span class="p">)</span>

<span class="c1"># names of Architects associated with the highest number of projects 1940-1980</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">There are </span><span class="si">{</span><span class="n">all_completion_with_name</span><span class="p">[</span><span class="s2">&quot;subject.label&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s1"> unique architects with associated projects between 1940-1980.&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Below is a list of the top 20 architects with the highest number of associated projects within this period.&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">all_completion_with_name</span><span class="p">[</span><span class="s1">&#39;subject.label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;index&#39;</span><span class="p">:</span><span class="s1">&#39;Architect&#39;</span><span class="p">,</span><span class="s1">&#39;subject.label&#39;</span><span class="p">:</span><span class="s1">&#39;Count&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">###################### FIRMS WITH THE HIGHEST NUMBER OF ASSOCIATED PROJECTS (1940-1980) ######################&#39;</span><span class="p">)</span>
<span class="c1"># dataframe of value counts of items in firms_with_projects_1940_80 list</span>
<span class="n">firms_with_projects_1940_80_count</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">firms_with_projects_1940_80</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;firm&#39;</span><span class="p">])[</span><span class="s1">&#39;firm&#39;</span><span class="p">]</span>\
    <span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>\
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
    <span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;index&#39;</span><span class="p">:</span><span class="s1">&#39;ori_id&#39;</span><span class="p">,</span><span class="s1">&#39;firm&#39;</span><span class="p">:</span><span class="s1">&#39;count&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># names of firms associated with the highest number of projects 1940-1980</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">There </span><span class="si">{</span><span class="n">firms_with_projects_1940_80_count</span><span class="p">[</span><span class="s2">&quot;ori_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s1"> unique firms with associated projects between 1940-1980.&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Below is a list of the top 20 firms with the highest number of associated projects within this period.&#39;</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">daqa_orgs</span><span class="p">[[</span><span class="s1">&#39;ori_id&#39;</span><span class="p">,</span> <span class="s1">&#39;primary_name&#39;</span><span class="p">]],</span> <span class="n">firms_with_projects_1940_80_count</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;ori_id&#39;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;primary_name&#39;</span><span class="p">:</span><span class="s1">&#39;Firm&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">:</span><span class="s1">&#39;Count&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">)[[</span><span class="s1">&#39;Firm&#39;</span><span class="p">,</span><span class="s1">&#39;Count&#39;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>###################### ARCHITECTS WITH THE HIGHEST NUMBER OF ASSOCIATED PROJECTS (1940-1980) ######################

There are 148 unique architects with associated projects between 1940-1980.
Below is a list of the top 20 architects with the highest number of associated projects within this period.
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Architect</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>John Dalton</td>
      <td>63</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Robin Gibson</td>
      <td>44</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Graham W. Bligh</td>
      <td>40</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Karl Langer</td>
      <td>39</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Rex Addison</td>
      <td>20</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Jon Voller</td>
      <td>19</td>
    </tr>
    <tr>
      <th>6</th>
      <td>James Birrell</td>
      <td>17</td>
    </tr>
    <tr>
      <th>7</th>
      <td>James Gibson</td>
      <td>14</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Stephen Trotter</td>
      <td>14</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Vitaly Gzell</td>
      <td>13</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Edwin Oribin</td>
      <td>12</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Peter Heathwood</td>
      <td>10</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Donald Spencer</td>
      <td>10</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Sidney Barnes</td>
      <td>9</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Don Winsen</td>
      <td>9</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Christina Metcalfe</td>
      <td>8</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Martin Louis Conrad</td>
      <td>8</td>
    </tr>
    <tr>
      <th>17</th>
      <td>John M. Railton</td>
      <td>7</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Lindy Wissler</td>
      <td>6</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Robert Froud</td>
      <td>6</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Gabriel Poole</td>
      <td>6</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Alexander Ian Ferrier</td>
      <td>6</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Geoffrey Pie</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>###################### FIRMS WITH THE HIGHEST NUMBER OF ASSOCIATED PROJECTS (1940-1980) ######################

There 115 unique firms with associated projects between 1940-1980.
Below is a list of the top 20 firms with the highest number of associated projects within this period.
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Firm</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>59</th>
      <td>"John Dalton Architect &amp; Associates"</td>
      <td>55</td>
    </tr>
    <tr>
      <th>36</th>
      <td>"Karl Langer Architect"</td>
      <td>37</td>
    </tr>
    <tr>
      <th>62</th>
      <td>"Bligh Jessup Bretnall &amp; Partners"</td>
      <td>29</td>
    </tr>
    <tr>
      <th>30</th>
      <td>"Robin Gibson &amp; Partners"</td>
      <td>21</td>
    </tr>
    <tr>
      <th>56</th>
      <td>"Aubrey H.  Job &amp; R. P.  Froud (Job &amp; Froud)"</td>
      <td>19</td>
    </tr>
    <tr>
      <th>86</th>
      <td>"R F Gibson Architect"</td>
      <td>18</td>
    </tr>
    <tr>
      <th>27</th>
      <td>"Fulton Trotter Architects"</td>
      <td>16</td>
    </tr>
    <tr>
      <th>67</th>
      <td>"Hayes &amp; Scott"</td>
      <td>15</td>
    </tr>
    <tr>
      <th>48</th>
      <td>"THA Cross &amp; D Bain"</td>
      <td>14</td>
    </tr>
    <tr>
      <th>82</th>
      <td>"S.G. Barnes &amp; Oribin"</td>
      <td>11</td>
    </tr>
    <tr>
      <th>24</th>
      <td>"W L Douglas &amp; B Barnes"</td>
      <td>10</td>
    </tr>
    <tr>
      <th>64</th>
      <td>"A.H Conrad &amp; T.B.F Gargett"</td>
      <td>10</td>
    </tr>
    <tr>
      <th>75</th>
      <td>"Theo Thynne &amp; Associates"</td>
      <td>9</td>
    </tr>
    <tr>
      <th>38</th>
      <td>"Cullen Hargraves Mooney"</td>
      <td>8</td>
    </tr>
    <tr>
      <th>81</th>
      <td>"Lund, Hutton, Newell, Black &amp; Paulsen"</td>
      <td>8</td>
    </tr>
    <tr>
      <th>83</th>
      <td>"John Railton Architect"</td>
      <td>7</td>
    </tr>
    <tr>
      <th>89</th>
      <td>"Brisbane City Council, City Design"</td>
      <td>7</td>
    </tr>
    <tr>
      <th>61</th>
      <td>"Prangley &amp; Crofts"</td>
      <td>6</td>
    </tr>
    <tr>
      <th>66</th>
      <td>"Conrad Gargett &amp; Partners (1965-1972)"</td>
      <td>6</td>
    </tr>
    <tr>
      <th>68</th>
      <td>"James Birrell &amp; Partners"</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="women-with-related-works">
<h3>Women with related works<a class="headerlink" href="#women-with-related-works" title="Permalink to this headline">¶</a></h3>
<p>We compare the frequency of completed projects by males and females between two periods 1940-1975, and 1975-Present.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">###################### FEMAlE ARCHITECTS (1940-1975) ######################&#39;</span><span class="p">)</span>
<span class="n">projects_1940_75</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">projects_1975_present</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span><span class="n">row</span> <span class="ow">in</span> <span class="n">daqa_work</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;coverage_range&#39;</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span> 
        <span class="k">if</span> <span class="s2">&quot;date_end&quot;</span> <span class="ow">in</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;coverage_range&#39;</span><span class="p">]:</span>
            <span class="n">comp_yr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;coverage_range&#39;</span><span class="p">])[</span><span class="s1">&#39;date_range&#39;</span><span class="p">])[</span><span class="s1">&#39;date_end.year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1"># add counter for comp_yr to dict</span>
            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">comp_yr</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1940</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">comp_yr</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1975</span><span class="p">:</span> 
                <span class="n">projects_1940_75</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;_id&#39;</span><span class="p">])</span> 

            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">comp_yr</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1975</span><span class="p">:</span> 
                <span class="n">projects_1975_present</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;_id&#39;</span><span class="p">])</span>

<span class="n">daqawork_1940_75</span> <span class="o">=</span> <span class="n">daqa_work</span><span class="p">[</span><span class="n">daqa_work</span><span class="p">[</span><span class="s1">&#39;_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">projects_1940_75</span><span class="p">)]</span>
<span class="n">daqawork_1975_present</span> <span class="o">=</span> <span class="n">daqa_work</span><span class="p">[</span><span class="n">daqa_work</span><span class="p">[</span><span class="s1">&#39;_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">projects_1975_present</span><span class="p">)]</span>

<span class="c1"># store all rows with date_start in coverage_range</span>
<span class="n">all_completion_with_name_1940_75</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span><span class="n">row</span> <span class="ow">in</span> <span class="n">daqawork_1940_75</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">comp_date</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;coverage_range&#39;</span><span class="p">]))[</span><span class="s1">&#39;date_range.date_end.year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span> <span class="n">this_work</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;related_people&#39;</span><span class="p">]))[[</span><span class="s1">&#39;subject.label&#39;</span><span class="p">,</span><span class="s1">&#39;object.ori_id&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span> <span class="n">this_work</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;subject.label&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;object.ori_id&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ori_id&#39;</span><span class="p">]},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">this_work</span><span class="p">[</span><span class="s1">&#39;comp_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp_date</span>
    <span class="n">all_completion_with_name_1940_75</span> <span class="o">=</span> <span class="n">all_completion_with_name_1940_75</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_work</span><span class="p">)</span>

<span class="c1"># store all rows with date_start in coverage_range</span>
<span class="n">all_completion_with_name_1975_present</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span><span class="n">row</span> <span class="ow">in</span> <span class="n">daqawork_1975_present</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">comp_date</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;coverage_range&#39;</span><span class="p">]))[</span><span class="s1">&#39;date_range.date_end.year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span> <span class="n">this_work</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">row</span> <span class="p">[</span><span class="s1">&#39;related_people&#39;</span><span class="p">]))[[</span><span class="s1">&#39;subject.label&#39;</span><span class="p">,</span><span class="s1">&#39;object.ori_id&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span> <span class="n">this_work</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;subject.label&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;object.ori_id&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ori_id&#39;</span><span class="p">]},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">this_work</span><span class="p">[</span><span class="s1">&#39;comp_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp_date</span>
    <span class="n">all_completion_with_name_1975_present</span> <span class="o">=</span> <span class="n">all_completion_with_name_1975_present</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_work</span><span class="p">)</span>

<span class="n">persons_gender</span> <span class="o">=</span> <span class="n">daqa_persons</span><span class="p">[[</span><span class="s1">&#39;display_name&#39;</span><span class="p">,</span><span class="s1">&#39;gender&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">persons_gender</span><span class="p">[</span><span class="s1">&#39;display_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">persons_gender</span><span class="p">[</span><span class="s1">&#39;display_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="n">persons_gender_1940_1975</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">all_completion_with_name_1940_75</span><span class="p">,</span> <span class="n">persons_gender</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;display_name&#39;</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;subject.label&#39;</span><span class="p">)</span>
<span class="n">persons_gender_1940_1975</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;Missing&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">persons_gender_1940_1975</span> <span class="o">=</span> <span class="n">persons_gender_1940_1975</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;index&#39;</span><span class="p">:</span><span class="s1">&#39;Gender&#39;</span><span class="p">,</span> <span class="s1">&#39;gender&#39;</span><span class="p">:</span><span class="s1">&#39;Count&#39;</span><span class="p">},</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: what </span><span class="si">% o</span><span class="s1">f projects completed in 1940-1975 were associated with a male architect?&#39;</span><span class="p">)</span>
<span class="n">count_projects_all</span> <span class="o">=</span> <span class="n">persons_gender_1940_1975</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">male_count</span> <span class="o">=</span> <span class="n">persons_gender_1940_1975</span><span class="p">[</span><span class="n">persons_gender_1940_1975</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;&quot;male&quot;&#39;&#39;&#39;</span><span class="p">)][</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">prop_projects_male</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">male_count</span> <span class="o">/</span> <span class="n">count_projects_all</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: </span><span class="si">{</span><span class="n">prop_projects_male</span><span class="si">}</span><span class="s1">% (</span><span class="si">{</span><span class="n">male_count</span><span class="si">}</span><span class="s1">) of architects associated with projects completed in 1940-1975 were male.&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: what </span><span class="si">% o</span><span class="s1">f projects completed in 1940-1975 were associated with a female architect?&#39;</span><span class="p">)</span>
<span class="n">female_count</span> <span class="o">=</span> <span class="n">persons_gender_1940_1975</span><span class="p">[</span><span class="n">persons_gender_1940_1975</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;&quot;female&quot;&#39;&#39;&#39;</span><span class="p">)][</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">prop_projects_female</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">female_count</span> <span class="o">/</span> <span class="n">count_projects_all</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: </span><span class="si">{</span><span class="n">prop_projects_female</span><span class="si">}</span><span class="s1">% (</span><span class="si">{</span><span class="n">female_count</span><span class="si">}</span><span class="s1">) of architects associated with projects completed in 1940-1975 were female.&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">*It should be noted that there are 6 DAQA projects between 1940-1975 with missing gender information.&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">###################### FEMAlE ARCHITECTS (1975-Present) ######################&#39;</span><span class="p">)</span>

<span class="n">persons_gender_1975_present</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">all_completion_with_name_1975_present</span><span class="p">,</span> <span class="n">persons_gender</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;display_name&#39;</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;subject.label&#39;</span><span class="p">)</span>
<span class="n">persons_gender_1975_present</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;Missing&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">persons_gender_1975_present</span> <span class="o">=</span> <span class="n">persons_gender_1975_present</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;index&#39;</span><span class="p">:</span><span class="s1">&#39;Gender&#39;</span><span class="p">,</span> <span class="s1">&#39;gender&#39;</span><span class="p">:</span><span class="s1">&#39;Count&#39;</span><span class="p">},</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: what </span><span class="si">% o</span><span class="s1">f projects completed after 1975 were associated with a male architect?&#39;</span><span class="p">)</span>
<span class="n">count_projects_all</span> <span class="o">=</span> <span class="n">persons_gender_1975_present</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">male_count</span> <span class="o">=</span> <span class="n">persons_gender_1975_present</span><span class="p">[</span><span class="n">persons_gender_1975_present</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;&quot;male&quot;&#39;&#39;&#39;</span><span class="p">)][</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">prop_projects_male</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">male_count</span> <span class="o">/</span> <span class="n">count_projects_all</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: </span><span class="si">{</span><span class="n">prop_projects_male</span><span class="si">}</span><span class="s1">% (</span><span class="si">{</span><span class="n">male_count</span><span class="si">}</span><span class="s1">) of architects associated with projects completed affter 1975 were male.&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Q: what </span><span class="si">% o</span><span class="s1">f projects completed after 1975 were associated with a female architect?&#39;</span><span class="p">)</span>
<span class="n">female_count</span> <span class="o">=</span> <span class="n">persons_gender_1975_present</span><span class="p">[</span><span class="n">persons_gender_1975_present</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;&quot;female&quot;&#39;&#39;&#39;</span><span class="p">)][</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">prop_projects_female</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">female_count</span> <span class="o">/</span> <span class="n">count_projects_all</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A: </span><span class="si">{</span><span class="n">prop_projects_female</span><span class="si">}</span><span class="s1">% (</span><span class="si">{</span><span class="n">female_count</span><span class="si">}</span><span class="s1">) of architects associated with projects completed after 1975 were female.&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">*It should be noted that there are 8 DAQA projects after 1975 with missing gender information.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>###################### FEMAlE ARCHITECTS (1940-1975) ######################

Q: what % of projects completed in 1940-1975 were associated with a male architect?
A: 93.15% (530) of architects associated with projects completed in 1940-1975 were male.

Q: what % of projects completed in 1940-1975 were associated with a female architect?
A: 5.8% (33) of architects associated with projects completed in 1940-1975 were female.

*It should be noted that there are 6 DAQA projects between 1940-1975 with missing gender information.

###################### FEMAlE ARCHITECTS (1975-Present) ######################

Q: what % of projects completed after 1975 were associated with a male architect?
A: 67.37% (225) of architects associated with projects completed affter 1975 were male.

Q: what % of projects completed after 1975 were associated with a female architect?
A: 30.24% (101) of architects associated with projects completed after 1975 were female.

*It should be noted that there are 8 DAQA projects after 1975 with missing gender information.
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="typologies">
<h2>Typologies<a class="headerlink" href="#typologies" title="Permalink to this headline">¶</a></h2>
<p>Below we visualise the frequency of typologies in the DAQA dataset. We continue our analysis by focusing on the period of 1940 to 1980, as well as idenyifing the arcihtects and firms with the most related projects for each typology within this period.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">daqa_work_years</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">daqa_work_ori_ids</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span><span class="n">row</span> <span class="ow">in</span> <span class="n">daqa_work</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span> <span class="n">comp_yr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;coverage_range&#39;</span><span class="p">])[</span><span class="s1">&#39;date_range&#39;</span><span class="p">])[</span><span class="s1">&#39;date_end.year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">except</span><span class="p">:</span> <span class="n">comp_yr</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">daqa_work_years</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comp_yr</span><span class="p">)</span>
    <span class="n">daqa_work_ori_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ori_id&#39;</span><span class="p">])</span>

<span class="c1"># create a dummy variable for each typology</span>
<span class="n">typology_dummies_daqa_work</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">daqa_work</span><span class="p">[</span><span class="s1">&#39;typologies&#39;</span><span class="p">]</span><span class="o">.</span>\
    <span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;Missing&#39;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[^a-zA-Z, ]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">())</span>\
    <span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">typology_dummies_daqa_work</span><span class="p">[</span><span class="s1">&#39;extracted_compyear&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">daqa_work_years</span>

<span class="c1"># create a dataframe with value counts for each typology and year</span>
<span class="n">typology_dummies_counts</span> <span class="o">=</span> <span class="n">typology_dummies_daqa_work</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;extracted_compyear&#39;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">sum</span><span class="p">()</span>\
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="n">typology_dummies_counts</span><span class="p">[</span><span class="s1">&#39;extracted_compyear&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">typology_dummies_counts</span><span class="p">[</span><span class="s1">&#39;extracted_compyear&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># remove erronoous year 1220 and 2029</span>
<span class="n">typology_dummies_counts</span> <span class="o">=</span> <span class="n">typology_dummies_counts</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:,]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># add row for missing years between 1820 and 2022</span>
<span class="n">typology_dummies_counts</span> <span class="o">=</span> <span class="n">typology_dummies_counts</span>\
    <span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;extracted_compyear&#39;</span><span class="p">:</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1820</span><span class="p">,</span><span class="mi">2022</span><span class="p">))}),</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="s1">&#39;extracted_compyear&#39;</span><span class="p">,</span><span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;extracted_compyear&#39;</span><span class="p">)</span>

<span class="c1"># plot interactve time series for each typology</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">typology_dummies_counts</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;extracted_compyear&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">typology_dummies_counts</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
<span class="n">title</span><span class="o">=</span><span class="s1">&#39;Number of works by typology and year, 1820-2021&#39;</span><span class="p">,</span>
<span class="n">width</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">color_discrete_sequence</span><span class="o">=</span><span class="n">px</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">qualitative</span><span class="o">.</span><span class="n">Pastel</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Year of completion&#39;</span><span class="p">)</span>

<span class="c1"># add subtitle</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_annotation</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.07</span><span class="p">,</span> <span class="n">xref</span><span class="o">=</span><span class="s1">&#39;paper&#39;</span><span class="p">,</span> <span class="n">yref</span><span class="o">=</span><span class="s1">&#39;paper&#39;</span><span class="p">,</span>
<span class="n">text</span><span class="o">=</span><span class="s1">&#39;Note: there are some non-disjoint cases in the data.&#39;</span><span class="p">,</span> <span class="n">showarrow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">))</span>

<span class="c1"># change legend title from &quot;variable&quot; to &quot;typology&quot;</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">legend_title_text</span><span class="o">=</span><span class="s1">&#39;Typology&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="section" id="typologies-1940-1980">
<h3>Typologies (1940-1980)<a class="headerlink" href="#typologies-1940-1980" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a dummy variable for each typology</span>
<span class="n">typology_dummies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">daqawork_1940_80</span><span class="p">[</span><span class="s1">&#39;typologies&#39;</span><span class="p">]</span><span class="o">.</span>\
    <span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;Missing&#39;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[^a-zA-Z, ]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">())</span>\
    <span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># create a dataframe with value counts for each typology and their proportion of the total</span>
<span class="n">typology_dummies_counts</span> <span class="o">=</span> <span class="n">typology_dummies</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>\
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
    <span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;index&#39;</span><span class="p">:</span><span class="s1">&#39;typology&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="s1">&#39;count&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># matplotlib plot the freuqencies of typologies with bar labels and switch order of y axis</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">typology_dummies_counts</span><span class="p">[</span><span class="s1">&#39;typology&#39;</span><span class="p">],</span> <span class="n">typology_dummies_counts</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;steelblue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">typology_dummies_counts</span><span class="p">[</span><span class="s1">&#39;typology&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Number of works&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Typologies of works, 1940-1980</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>

<span class="c1"># add bar labels with proportions in brackets</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">patches</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">p</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">get_y</span><span class="p">()</span><span class="o">+</span><span class="mf">0.55</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">,</span> <span class="s1">&#39;Note: there are some non-disjoint cases in the data.&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Analysis_DAQA_Part2_50_0.png" src="_images/Analysis_DAQA_Part2_50_0.png" />
</div>
</div>
<div class="section" id="top-5-architects">
<h4>Top 5 architects<a class="headerlink" href="#top-5-architects" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">typology_dummies_daqa_work</span><span class="p">[</span><span class="s1">&#39;ori_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">daqa_work_ori_ids</span>
<span class="n">typology_architects</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">typology_dummies_daqa_work</span><span class="p">,</span> 
                               <span class="n">all_completion_with_name</span><span class="p">[[</span><span class="s1">&#39;subject.label&#39;</span><span class="p">,</span><span class="s1">&#39;object.ori_id&#39;</span><span class="p">]],</span> 
                               <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;ori_id&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;object.ori_id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;extracted_compyear&#39;</span><span class="p">,</span><span class="s1">&#39;ori_id&#39;</span><span class="p">,</span><span class="s1">&#39;object.ori_id&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># get the sum of each typology for each firm</span>
<span class="n">typology_architects</span> <span class="o">=</span> <span class="n">typology_architects</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;subject.label&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="k">for</span> <span class="n">typology</span> <span class="ow">in</span> <span class="n">typology_architects</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="si">{</span><span class="n">typology</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="n">typology_architects_top5</span> <span class="o">=</span> <span class="n">typology_architects</span><span class="p">[[</span><span class="s1">&#39;subject.label&#39;</span><span class="p">,</span> <span class="n">typology</span><span class="p">]]</span>\
        <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">typology</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>\
        <span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="n">typology</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">typology</span><span class="si">}</span><span class="s1"> count&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">typology_architects_top5</span> <span class="o">=</span> <span class="n">typology_architects_top5</span><span class="p">[</span><span class="n">typology_architects_top5</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">typology</span><span class="si">}</span><span class="s1"> count&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

    <span class="n">display</span><span class="p">(</span><span class="n">typology_architects_top5</span>\
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">typology</span><span class="si">}</span><span class="s1"> count&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;subject.label&#39;</span><span class="p">:</span><span class="s1">&#39;Architect&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[[</span><span class="s1">&#39;Architect&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">typology</span><span class="si">}</span><span class="s1"> count&#39;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Commercial buildings
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Architect</th>
      <th>Commercial buildings count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>60</th>
      <td>Graham W. Bligh</td>
      <td>22</td>
    </tr>
    <tr>
      <th>125</th>
      <td>Robin Gibson</td>
      <td>16</td>
    </tr>
    <tr>
      <th>92</th>
      <td>Karl Langer</td>
      <td>9</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Geoffrey Pie</td>
      <td>4</td>
    </tr>
    <tr>
      <th>132</th>
      <td>Stephen Trotter</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dwellings
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Architect</th>
      <th>Dwellings count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>82</th>
      <td>John Dalton</td>
      <td>62</td>
    </tr>
    <tr>
      <th>92</th>
      <td>Karl Langer</td>
      <td>15</td>
    </tr>
    <tr>
      <th>125</th>
      <td>Robin Gibson</td>
      <td>10</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Donald Spencer</td>
      <td>9</td>
    </tr>
    <tr>
      <th>137</th>
      <td>Vitaly Gzell</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Educational facilities
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Architect</th>
      <th>Educational facilities count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>125</th>
      <td>Robin Gibson</td>
      <td>6</td>
    </tr>
    <tr>
      <th>60</th>
      <td>Graham W. Bligh</td>
      <td>6</td>
    </tr>
    <tr>
      <th>118</th>
      <td>Rex Addison</td>
      <td>6</td>
    </tr>
    <tr>
      <th>132</th>
      <td>Stephen Trotter</td>
      <td>5</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Jon Voller</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Government buildings
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Architect</th>
      <th>Government buildings count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>92</th>
      <td>Karl Langer</td>
      <td>5</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Jon Voller</td>
      <td>3</td>
    </tr>
    <tr>
      <th>125</th>
      <td>Robin Gibson</td>
      <td>3</td>
    </tr>
    <tr>
      <th>60</th>
      <td>Graham W. Bligh</td>
      <td>3</td>
    </tr>
    <tr>
      <th>127</th>
      <td>Roman Pavylshyn</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Health care facilities
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Architect</th>
      <th>Health care facilities count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>131</th>
      <td>Sidney Barnes</td>
      <td>5</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Charles W. T. Fulton</td>
      <td>2</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Bruce Paulsen</td>
      <td>1</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Elmars A. Kraams</td>
      <td>1</td>
    </tr>
    <tr>
      <th>101</th>
      <td>Margaret Ward</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HighRise
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Architect</th>
      <th>HighRise count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>68</th>
      <td>Ian D. Charlton</td>
      <td>1</td>
    </tr>
    <tr>
      <th>125</th>
      <td>Robin Gibson</td>
      <td>1</td>
    </tr>
    <tr>
      <th>134</th>
      <td>Ted Crofts</td>
      <td>1</td>
    </tr>
    <tr>
      <th>77</th>
      <td>Jan van den Broek</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Industrial buildings
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Architect</th>
      <th>Industrial buildings count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>125</th>
      <td>Robin Gibson</td>
      <td>6</td>
    </tr>
    <tr>
      <th>131</th>
      <td>Sidney Barnes</td>
      <td>1</td>
    </tr>
    <tr>
      <th>137</th>
      <td>Vitaly Gzell</td>
      <td>1</td>
    </tr>
    <tr>
      <th>92</th>
      <td>Karl Langer</td>
      <td>1</td>
    </tr>
    <tr>
      <th>48</th>
      <td>Frank Costello</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Missing
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Architect</th>
      <th>Missing count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>104</th>
      <td>Martin Louis Conrad</td>
      <td>1</td>
    </tr>
    <tr>
      <th>115</th>
      <td>Peter Newell</td>
      <td>1</td>
    </tr>
    <tr>
      <th>108</th>
      <td>Neville H. Lund</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Recreation and sports facilities
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Architect</th>
      <th>Recreation and sports facilities count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>63</th>
      <td>Guy Crick</td>
      <td>4</td>
    </tr>
    <tr>
      <th>75</th>
      <td>James Birrell</td>
      <td>3</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Edwin Oribin</td>
      <td>3</td>
    </tr>
    <tr>
      <th>118</th>
      <td>Rex Addison</td>
      <td>3</td>
    </tr>
    <tr>
      <th>74</th>
      <td>Jack McElroy</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Religious buildings
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Architect</th>
      <th>Religious buildings count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>76</th>
      <td>James Gibson</td>
      <td>14</td>
    </tr>
    <tr>
      <th>92</th>
      <td>Karl Langer</td>
      <td>5</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Edwin Oribin</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Alexander Ian Ferrier</td>
      <td>3</td>
    </tr>
    <tr>
      <th>81</th>
      <td>John Buckeridge</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Transport infrastructure
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Architect</th>
      <th>Transport infrastructure count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>Balwant Saini</td>
      <td>1</td>
    </tr>
    <tr>
      <th>92</th>
      <td>Karl Langer</td>
      <td>1</td>
    </tr>
    <tr>
      <th>60</th>
      <td>Graham W. Bligh</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="top-5-firms">
<h4>Top 5 firms<a class="headerlink" href="#top-5-firms" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert projects_1940_80_firms_dict to dataframe</span>
<span class="n">typology_dummies</span><span class="p">[</span><span class="s1">&#39;_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">daqawork_1940_80</span><span class="p">[[</span><span class="s1">&#39;_id&#39;</span><span class="p">]]</span>
<span class="n">typology_firms</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">typology_dummies</span><span class="p">,</span>
                    <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">projects_1940_80_firms_dict</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>\
                        <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
                        <span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;index&#39;</span><span class="p">:</span><span class="s1">&#39;_id&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="s1">&#39;ori_id&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<span class="c1"># get the sum of each typology for each firm</span>
<span class="n">typology_firms</span> <span class="o">=</span> <span class="n">typology_firms</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;ori_id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="k">for</span> <span class="n">typology</span> <span class="ow">in</span> <span class="n">typology_dummies_counts</span><span class="p">[</span><span class="s1">&#39;typology&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="si">{</span><span class="n">typology</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="n">typology_firms_top5</span> <span class="o">=</span> <span class="n">typology_firms</span><span class="p">[[</span><span class="s1">&#39;ori_id&#39;</span><span class="p">,</span> <span class="n">typology</span><span class="p">]]</span>\
        <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">typology</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>\
        <span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="n">typology</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">typology</span><span class="si">}</span><span class="s1"> count&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">typology_firms_top5</span> <span class="o">=</span> <span class="n">typology_firms_top5</span><span class="p">[</span><span class="n">typology_firms_top5</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">typology</span><span class="si">}</span><span class="s1"> count&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    
    <span class="n">display</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">daqa_orgs</span><span class="p">[[</span><span class="s1">&#39;ori_id&#39;</span><span class="p">,</span> <span class="s1">&#39;primary_name&#39;</span><span class="p">]],</span> <span class="n">typology_firms_top5</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;ori_id&#39;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">typology</span><span class="si">}</span><span class="s1"> count&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;primary_name&#39;</span><span class="p">:</span><span class="s1">&#39;Firm&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[[</span><span class="s1">&#39;Firm&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">typology</span><span class="si">}</span><span class="s1"> count&#39;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dwellings
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Firm</th>
      <th>Dwellings count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>"John Dalton Architect &amp; Associates"</td>
      <td>54</td>
    </tr>
    <tr>
      <th>1</th>
      <td>"Aubrey H.  Job &amp; R. P.  Froud (Job &amp; Froud)"</td>
      <td>18</td>
    </tr>
    <tr>
      <th>3</th>
      <td>"Hayes &amp; Scott"</td>
      <td>14</td>
    </tr>
    <tr>
      <th>0</th>
      <td>"Karl Langer Architect"</td>
      <td>13</td>
    </tr>
    <tr>
      <th>4</th>
      <td>"John Railton Architect"</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Commercial buildings
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Firm</th>
      <th>Commercial buildings count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>"Bligh Jessup Bretnall &amp; Partners"</td>
      <td>17</td>
    </tr>
    <tr>
      <th>1</th>
      <td>"Karl Langer Architect"</td>
      <td>8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>"R F Gibson Architect"</td>
      <td>8</td>
    </tr>
    <tr>
      <th>0</th>
      <td>"Robin Gibson &amp; Partners"</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>"Prangley &amp; Crofts"</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Educational facilities
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Firm</th>
      <th>Educational facilities count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>"Cullen Hargraves Mooney"</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>"Bligh Jessup Bretnall &amp; Partners"</td>
      <td>6</td>
    </tr>
    <tr>
      <th>0</th>
      <td>"Fulton Trotter Architects"</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>"Robin Gibson &amp; Partners"</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>"Karl Langer Architect"</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Religious buildings
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Firm</th>
      <th>Religious buildings count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>"THA Cross &amp; D Bain"</td>
      <td>14</td>
    </tr>
    <tr>
      <th>2</th>
      <td>"Karl Langer Architect"</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>"S.G. Barnes &amp; Oribin"</td>
      <td>5</td>
    </tr>
    <tr>
      <th>0</th>
      <td>"Ian A Ferrier"</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>"W L Douglas &amp; B Barnes"</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Government buildings
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Firm</th>
      <th>Government buildings count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>"Karl Langer Architect"</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>"Bligh Jessup Bretnall &amp; Partners"</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>"Conrad Gargett &amp; Partners (1965-1972)"</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>"Commonwealth Department of Works"</td>
      <td>3</td>
    </tr>
    <tr>
      <th>0</th>
      <td>"Robin Gibson &amp; Partners"</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Recreation and sports facilities
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Firm</th>
      <th>Recreation and sports facilities count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>"A.H Conrad &amp; T.B.F Gargett"</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>"Brisbane City Council, City Design"</td>
      <td>3</td>
    </tr>
    <tr>
      <th>0</th>
      <td>"Karl Langer Architect"</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>"S.G. Barnes &amp; Oribin"</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>"Ford, Hutton &amp; Newell"</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Health care facilities
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Firm</th>
      <th>Health care facilities count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>"S.G. Barnes"</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>"J M Collin &amp; C W T Fulton"</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>"A.H Conrad &amp; T.B.F Gargett"</td>
      <td>2</td>
    </tr>
    <tr>
      <th>0</th>
      <td>"Donald W Spencer"</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>"Sydney Hospital Projects Office"</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Industrial buildings
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Firm</th>
      <th>Industrial buildings count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>"Robin Gibson &amp; Partners"</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>"R F Gibson Architect"</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>"Karl Langer Architect"</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>"S.G. Barnes"</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>"Theo Thynne &amp; Associates"</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HighRise
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Firm</th>
      <th>HighRise count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>"Prangley &amp; Crofts"</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>"Theo Thynne, Denham &amp; Associates"</td>
      <td>2</td>
    </tr>
    <tr>
      <th>0</th>
      <td>"Curro Nutter &amp; Charlton"</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>"Robin Gibson &amp; Partners"</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>"Peddle Thorp &amp; Walker"</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Missing
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Firm</th>
      <th>Missing count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>"Martin L Conrad Architects"</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>"Hennessy, Hennessy &amp; Co"</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>"Lund, Hutton &amp; Newell"</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>"Ford, Hutton &amp; Newell"</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Transport infrastructure
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Firm</th>
      <th>Transport infrastructure count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>"Karl Langer Architect"</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
</div>
<div class="section" id="interviews">
<h2>Interviews<a class="headerlink" href="#interviews" title="Permalink to this headline">¶</a></h2>
<p>Below we explore the frequency of interviews by interviewers. We focus only on intereviews with architect interviewees.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load data</span>
<span class="n">daqa_resources</span> <span class="o">=</span> <span class="n">df_daqa_dict</span><span class="p">[</span><span class="s1">&#39;resource&#39;</span><span class="p">]</span>
<span class="n">daqa_interviews</span> <span class="o">=</span> <span class="n">daqa_resources</span><span class="p">[</span><span class="n">daqa_resources</span><span class="p">[</span><span class="s1">&#39;_class_ori&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;interview&#39;</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>

<span class="n">interviewers</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span><span class="n">row</span> <span class="ow">in</span> <span class="n">daqa_interviews</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span> 
        <span class="n">interviewees_isarchitect</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;interviewee&#39;</span><span class="p">]))[</span><span class="s1">&#39;architect&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">if</span> <span class="kc">True</span> <span class="ow">in</span> <span class="n">interviewees_isarchitect</span><span class="p">:</span>
            <span class="n">interviewers</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;interviewer&#39;</span><span class="p">]))[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
    <span class="k">except</span><span class="p">:</span> <span class="k">pass</span>


<span class="c1"># plot bar plot of interviewers</span>
<span class="n">interviewers</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">interviewers</span><span class="p">)</span>
<span class="n">interviewers</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;barh&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Number of interviews by interviewers (only architect interviewees)&#39;</span><span class="p">)</span>

<span class="c1"># inverse y-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>

<span class="c1"># add bar labels and propotions</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">interviewers</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">v</span> <span class="o">+</span> <span class="mf">.4</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mf">.15</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">56.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mf">13.25</span><span class="p">,</span> <span class="s1">&#39;Note: there are some non-disjoint cases in the data.&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Analysis_DAQA_Part2_56_0.png" src="_images/Analysis_DAQA_Part2_56_0.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="Analysis_DAQA_Part1.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">DAQA: Preliminary analysis</p>
        </div>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Australian Cultural Data Engine<br/>
    
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>